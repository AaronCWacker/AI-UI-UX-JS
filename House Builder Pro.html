<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Detailed Architectural Model</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #87CEEB; }
        #info {
            position: absolute;
            top: 10px;
            width: 100%;
            text-align: center;
            color: white;
            font-family: sans-serif;
            font-weight: bold;
            text-shadow: 1px 1px 2px black;
            pointer-events: none;
        }
    </style>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>
    <div id="info">Modern House: Moving Elevator & Detail<br>Left Click: Rotate | Right Click: Pan | Scroll: Zoom</div>
    
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import * as BufferGeometryUtils from 'three/addons/utils/BufferGeometryUtils.js';

        let scene, camera, renderer, controls, liftPlatform;
        const clock = new THREE.Clock();

        // Dimensions
        const level1Height = 5;
        const level2Height = 4.5;
        const towerCenter = new THREE.Vector3(8, 0, 8);
        const towerRadius = 3.5;

        // Materials
        const matSidingL1 = new THREE.MeshStandardMaterial({ color: 0x5d4037 }); 
        const matSidingL2 = new THREE.MeshStandardMaterial({ color: 0x8d6e63 });
        const matRoof = new THREE.MeshStandardMaterial({ color: 0x263238 });
        const matGlass = new THREE.MeshStandardMaterial({ color: 0x81d4fa, transparent: true, opacity: 0.5, metalness: 0.9, roughness: 0.1 });
        const matDeck = new THREE.MeshStandardMaterial({ color: 0x795548 });
        const matConcrete = new THREE.MeshStandardMaterial({ color: 0x9e9e9e });
        const matMetal = new THREE.MeshStandardMaterial({ color: 0x455a64, metalness: 0.8 });
        const matGrass = new THREE.MeshStandardMaterial({ color: 0x4caf50 });

        init();
        animate();

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);
            scene.fog = new THREE.Fog(0x87CEEB, 40, 150);

            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 500);
            camera.position.set(40, 30, 50);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            document.body.appendChild(renderer.domElement);

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);

            const sun = new THREE.DirectionalLight(0xffffff, 1.2);
            sun.position.set(50, 80, 50);
            sun.castShadow = true;
            sun.shadow.mapSize.width = 2048;
            sun.shadow.camera.left = -50;
            sun.shadow.camera.right = 50;
            scene.add(sun);

            buildEnvironment();
            buildDetailedHouse();

            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            window.addEventListener('resize', onWindowResize);
        }

        function buildEnvironment() {
            const ground = new THREE.Mesh(new THREE.PlaneGeometry(1000, 1000), matGrass);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);
        }

        function buildDetailedHouse() {
            const house = new THREE.Group();

            // --- Level 1 ---
            const l1Main = new THREE.Mesh(new THREE.BoxGeometry(20, level1Height, 12), matSidingL1);
            l1Main.position.y = level1Height / 2;
            l1Main.castShadow = true;
            l1Main.receiveShadow = true;
            house.add(l1Main);

            // Garage Door
            const garageDoor = new THREE.Mesh(new THREE.BoxGeometry(8, 3.5, 0.2), matMetal);
            garageDoor.position.set(5, 1.75, 6.05);
            house.add(garageDoor);

            // --- Level 2 ---
            const l2Main = new THREE.Mesh(new THREE.BoxGeometry(18, level2Height, 10), matSidingL2);
            l2Main.position.set(-1, level1Height + (level2Height / 2), 0);
            l2Main.castShadow = true;
            house.add(l2Main);

            // --- Windows ---
            const winGeo = new THREE.PlaneGeometry(2, 3);
            for(let i = -6; i <= 6; i+=4) {
                const win = new THREE.Mesh(winGeo, matGlass);
                win.position.set(i, level1Height + 2.5, 5.05);
                house.add(win);
            }

            // --- Decks ---
            const deck1 = new THREE.Mesh(new THREE.BoxGeometry(28, 0.4, 8), matDeck);
            deck1.position.set(2, 4, 10);
            deck1.receiveShadow = true;
            house.add(deck1);

            // --- Glass Tower ---
            const towerHeight = level1Height + level2Height + 1;
            const towerGeo = new THREE.CylinderGeometry(towerRadius, towerRadius, towerHeight, 12, 1, true);
            const tower = new THREE.Mesh(towerGeo, matGlass);
            tower.position.set(towerCenter.x, towerHeight / 2, towerCenter.z);
            house.add(tower);

            // Tower Roof
            const tRoofGeo = new THREE.ConeGeometry(towerRadius + 0.5, 3, 12);
            const tRoof = new THREE.Mesh(tRoofGeo, matRoof);
            tRoof.position.set(towerCenter.x, towerHeight + 1.5, towerCenter.z);
            house.add(tRoof);

            // --- The Lift ---
            const liftGeo = new THREE.CylinderGeometry(towerRadius - 0.5, towerRadius - 0.5, 0.2, 12);
            liftPlatform = new THREE.Mesh(liftGeo, matMetal);
            liftPlatform.position.set(towerCenter.x, 0.2, towerCenter.z);
            scene.add(liftPlatform);

            // Lift Rails/Cage
            const cage = new THREE.Mesh(new THREE.CylinderGeometry(towerRadius - 0.5, towerRadius - 0.5, 3, 12, 1, true), matMetal);
            cage.material.wireframe = true;
            cage.position.y = 1.5;
            liftPlatform.add(cage);

            scene.add(house);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            
            // Animate Elevator
            const time = clock.getElapsedTime();
            if (liftPlatform) {
                // Moves between floor 1 (y=0.2) and floor 2 (y=9)
                liftPlatform.position.y = 4.6 + Math.sin(time * 0.7) * 4.4;
            }

            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
