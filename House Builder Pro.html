<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lakefront Mansion with Indoor Pool</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #87CEEB; }
        #info {
            position: absolute; top: 10px; width: 100%; text-align: center;
            color: #222; font-family: sans-serif; font-weight: bold;
            background: rgba(255,255,255,0.7); padding: 8px; pointer-events: none;
        }
    </style>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>
<body>
    <div id="info">
        Mansion Scale: Indoor Pool Wing, Living/Kitchen Wing, Multi-Deck Lift<br>
        <span style="font-size: 0.8em">Left Click: Rotate | Right Click: Pan | Scroll: Zoom</span>
    </div>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        let scene, camera, renderer, controls;
        let liftPlatform;
        const clock = new THREE.Clock();

        // --- MANSION SCALE CONFIGURATION ---
        const CEILING_HEIGHT = 4.0; // High ceilings (approx 13ft)
        const DOOR_HEIGHT = 2.8;    // 9ft doors
        const DOOR_WIDTH = 1.0;     // Wide French leaves
        
        // Wing Dimensions
        const POOL_WING_WIDTH = 20; 
        const POOL_WING_DEPTH = 14;
        const LIVING_WING_WIDTH = 22;
        const LIVING_WING_DEPTH = 12;

        // Materials
        const matSiding = new THREE.MeshStandardMaterial({ color: 0xE8E0D5, roughness: 0.9 }); // Limestone/Stucco
        const matFloor = new THREE.MeshStandardMaterial({ color: 0x5C4033 }); // Hardwood/Dark Tile
        const matGlass = new THREE.MeshPhysicalMaterial({ 
            color: 0xffffff, metalness: 0.1, roughness: 0.0, transmission: 0.95, transparent: true 
        });
        const matFrame = new THREE.MeshStandardMaterial({ color: 0x222222, roughness: 0.4 }); // Black Iron/Dark Wood
        const matDeck = new THREE.MeshStandardMaterial({ color: 0x8B5A2B });
        const matRoof = new THREE.MeshStandardMaterial({ color: 0x202020 });
        const matPoolWater = new THREE.MeshStandardMaterial({ color: 0x00FFFF, transparent: true, opacity: 0.8 });
        const matPoolTile = new THREE.MeshStandardMaterial({ color: 0xEEEEEE });

        init();
        animate();

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87CEEB);
            scene.fog = new THREE.Fog(0x87CEEB, 40, 200);

            // Camera Setup
            camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 500);
            camera.position.set(40, 30, 60); // Wide angle view

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.body.appendChild(renderer.domElement);

            // Lighting
            const ambient = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambient);
            const sun = new THREE.DirectionalLight(0xffffff, 1.2);
            sun.position.set(50, 80, 40);
            sun.castShadow = true;
            sun.shadow.mapSize.set(4096, 4096); // High res shadows for details
            const d = 60;
            sun.shadow.camera.left = -d; sun.shadow.camera.right = d;
            sun.shadow.camera.top = d; sun.shadow.camera.bottom = -d;
            scene.add(sun);

            // Build House
            buildEnvironment();
            buildMansion();

            // Controls
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.maxPolarAngle = Math.PI/2 - 0.05;

            window.addEventListener('resize', onWindowResize);
        }

        // --- COMPONENT BUILDERS (The "Code" Compliance) ---

        // 1. Double French Door (One set)
        function createDoubleFrenchDoor() {
            const group = new THREE.Group();
            const w = DOOR_WIDTH * 2;
            const h = DOOR_HEIGHT;
            
            // Frame
            const frame = new THREE.Mesh(new THREE.BoxGeometry(w+0.2, h+0.1, 0.2), matFrame);
            frame.position.y = h/2;
            group.add(frame);
            
            // Glass Leaves
            const glassGeo = new THREE.PlaneGeometry(DOOR_WIDTH-0.15, h-0.2);
            const g1 = new THREE.Mesh(glassGeo, matGlass); g1.position.set(-DOOR_WIDTH/2, h/2, 0.05);
            const g2 = new THREE.Mesh(glassGeo, matGlass); g2.position.set(DOOR_WIDTH/2, h/2, 0.05);
            group.add(g1); group.add(g2);

            // Handles/Muntins (Simplified)
            const div = new THREE.Mesh(new THREE.BoxGeometry(0.05, h, 0.22), matFrame);
            div.position.y = h/2;
            group.add(div);
            
            return group;
        }

        // 2. Set of Two Windows Side-by-Side (Floor to Ceiling)
        function createTwoWindowSet() {
            const group = new THREE.Group();
            const winW = 1.5; // Each window width
            const gap = 0.2;
            const h = DOOR_HEIGHT;

            // Frame Container
            const totalW = (winW * 2) + gap;
            
            // Left Window
            const f1 = new THREE.Mesh(new THREE.BoxGeometry(winW, h+0.1, 0.15), matFrame);
            f1.position.set(-(winW+gap)/2, h/2, 0);
            const g1 = new THREE.Mesh(new THREE.PlaneGeometry(winW-0.2, h-0.2), matGlass);
            g1.position.set(-(winW+gap)/2, h/2, 0.02);
            group.add(f1); group.add(g1);

            // Right Window
            const f2 = new THREE.Mesh(new THREE.BoxGeometry(winW, h+0.1, 0.15), matFrame);
            f2.position.set((winW+gap)/2, h/2, 0);
            const g2 = new THREE.Mesh(new THREE.PlaneGeometry(winW-0.2, h-0.2), matGlass);
            g2.position.set((winW+gap)/2, h/2, 0.02);
            group.add(f2); group.add(g2);

            return group;
        }

        function buildMansion() {
            const mansion = new THREE.Group();
            
            // ==========================================
            // WING A: THE INDOOR POOL (Left Side)
            // ==========================================
            const poolWing = new THREE.Group();
            poolWing.position.set(-10, 0, 0);

            // 1. Structure (Shell)
            // We build walls manually to leave holes for glass
            // Rear Wall (Solid)
            const pwRear = new THREE.Mesh(new THREE.BoxGeometry(POOL_WING_WIDTH, CEILING_HEIGHT, 1), matSiding);
            pwRear.position.set(0, CEILING_HEIGHT/2, -POOL_WING_DEPTH/2);
            pwRear.castShadow = true; poolWing.add(pwRear);
            
            // Roof (Pool Wing)
            const pwRoof = new THREE.Mesh(new THREE.ConeGeometry(12, 4, 4), matRoof);
            pwRoof.scale.set(1.4, 1, 1);
            pwRoof.rotation.y = Math.PI/4;
            pwRoof.position.set(0, CEILING_HEIGHT + 2, 0);
            poolWing.add(pwRoof);

            // 2. The Interior Pool Water
            const water = new THREE.Mesh(new THREE.BoxGeometry(POOL_WING_WIDTH-4, 0.5, POOL_WING_DEPTH-4), matPoolWater);
            water.position.set(0, 0.2, 0);
            poolWing.add(water);
            const poolDecking = new THREE.Mesh(new THREE.BoxGeometry(POOL_WING_WIDTH, 0.1, POOL_WING_DEPTH), matPoolTile);
            poolDecking.position.y = 0.05;
            poolWing.add(poolDecking);

            // 3. Glazing: "Twin French Double Doors" (Front)
            const doors1 = createDoubleFrenchDoor(); doors1.position.set(-2.5, 0, POOL_WING_DEPTH/2);
            const doors2 = createDoubleFrenchDoor(); doors2.position.set(2.5, 0, POOL_WING_DEPTH/2);
            poolWing.add(doors1); poolWing.add(doors2);
            
            // 4. Glazing: "Sets of two windows side by side" (Front corners)
            const wFrontL = createTwoWindowSet(); wFrontL.position.set(-7, 0, POOL_WING_DEPTH/2);
            const wFrontR = createTwoWindowSet(); wFrontR.position.set(7, 0, POOL_WING_DEPTH/2);
            poolWing.add(wFrontL); poolWing.add(wFrontR);

            // 5. Glazing: Side Walls (Left and Right)
            const wSideL = createTwoWindowSet(); 
            wSideL.rotation.y = Math.PI/2; 
            wSideL.position.set(-POOL_WING_WIDTH/2, 0, 0);
            poolWing.add(wSideL);

            const wSideR = createTwoWindowSet(); 
            wSideR.rotation.y = -Math.PI/2; 
            wSideR.position.set(POOL_WING_WIDTH/2, 0, 0); // Internal wall might cover this, but added for "3 sides" request
            poolWing.add(wSideR);

            // Add Columns to support roof visually where glass is
            [ -9.5, -5, 0, 5, 9.5].forEach(x => {
                const col = new THREE.Mesh(new THREE.BoxGeometry(0.5, CEILING_HEIGHT, 0.5), matSiding);
                col.position.set(x, CEILING_HEIGHT/2, POOL_WING_DEPTH/2);
                poolWing.add(col);
            });

            mansion.add(poolWing);


            // ==========================================
            // WING B: LIVING / KITCHEN / OFFICE (Right Side)
            // ==========================================
            const livingWing = new THREE.Group();
            livingWing.position.set(12, 0, -2); // Offset slightly back and to right

            // 1. Structure (Two Story Block)
            const lwGeo = new THREE.BoxGeometry(LIVING_WING_WIDTH, CEILING_HEIGHT * 2.1, LIVING_WING_DEPTH);
            const lwMesh = new THREE.Mesh(lwGeo, matSiding);
            lwMesh.position.set(0, CEILING_HEIGHT * 1.05, 0);
            lwMesh.castShadow = true;
            livingWing.add(lwMesh);

            // Roof (Living Wing)
            const lwRoof = new THREE.Mesh(new THREE.ConeGeometry(14, 5, 4), matRoof);
            lwRoof.scale.set(1.3, 1, 1);
            lwRoof.rotation.y = Math.PI/4;
            lwRoof.position.set(0, (CEILING_HEIGHT*2.1) + 2.5, 0);
            livingWing.add(lwRoof);

            // 2. Double Doors (3rd Set requested) - Opening to Deck
            const doors3 = createDoubleFrenchDoor();
            doors3.position.set(-5, 0, LIVING_WING_DEPTH/2 + 0.1); // Front facing
            livingWing.add(doors3);
            
            // 3. Windows for Living Area
            const wLiving = createTwoWindowSet();
            wLiving.position.set(5, 0, LIVING_WING_DEPTH/2 + 0.1);
            livingWing.add(wLiving);
            
            // 4. Upper Floor Windows (Bedroom/Office)
            const wUpper1 = createTwoWindowSet(); wUpper1.position.set(-5, CEILING_HEIGHT, LIVING_WING_DEPTH/2 + 0.1);
            const wUpper2 = createTwoWindowSet(); wUpper2.position.set(5, CEILING_HEIGHT, LIVING_WING_DEPTH/2 + 0.1);
            livingWing.add(wUpper1); livingWing.add(wUpper2);

            mansion.add(livingWing);


            // ==========================================
            // DECKING SYSTEM
            // ==========================================
            // Main Lower Deck (Wraps Pool and Living)
            const deckGeo = new THREE.BoxGeometry(45, 0.5, 10);
            const mainDeck = new THREE.Mesh(deckGeo, matDeck);
            mainDeck.position.set(0, -0.25, 10);
            mainDeck.receiveShadow = true;
            mansion.add(mainDeck);

            // Deck Railings (Posts and Rails)
            for(let x=-22; x<=22; x+=2) {
                const post = new THREE.Mesh(new THREE.BoxGeometry(0.2, 1.2, 0.2), matFrame);
                post.position.set(x, 0.6, 14.8);
                mansion.add(post);
            }
            const topRail = new THREE.Mesh(new THREE.BoxGeometry(45, 0.1, 0.2), matFrame);
            topRail.position.set(0, 1.2, 14.8);
            mansion.add(topRail);

            // Upper Deck (Off Living Wing)
            const upperDeck = new THREE.Mesh(new THREE.BoxGeometry(LIVING_WING_WIDTH, 0.3, 6), matDeck);
            upperDeck.position.set(12, CEILING_HEIGHT, 6);
            mansion.add(upperDeck);
            // Upper Railing
            const uRail = new THREE.Mesh(new THREE.BoxGeometry(LIVING_WING_WIDTH, 0.1, 0.1), matFrame);
            uRail.position.set(12, CEILING_HEIGHT + 1.2, 8.8);
            mansion.add(uRail);


            // ==========================================
            // THE TOWER & LIFT (Connecting Center)
            // ==========================================
            const towerPos = new THREE.Vector3(20, 0, 10); // Corner of deck
            
            // Tower Columns
            const towerHeight = CEILING_HEIGHT * 2.5;
            for(let i=0; i<8; i++) {
                const angle = (i/8) * Math.PI*2;
                const r = 3.5;
                const col = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.2, towerHeight, 8), matFrame);
                col.position.set(towerPos.x + Math.cos(angle)*r, towerHeight/2, towerPos.z + Math.sin(angle)*r);
                mansion.add(col);
            }

            // Tower Roof
            const tRoof = new THREE.Mesh(new THREE.ConeGeometry(4, 2.5, 8), matRoof);
            tRoof.position.set(towerPos.x, towerHeight + 1.25, towerPos.z);
            mansion.add(tRoof);

            // Lift Platform
            liftPlatform = new THREE.Mesh(new THREE.CylinderGeometry(3, 3, 0.2, 8), matFrame);
            const liftFloor = new THREE.Mesh(new THREE.CylinderGeometry(2.9, 2.9, 0.25, 8), matDeck);
            liftPlatform.add(liftFloor);
            liftPlatform.position.set(towerPos.x, 0, towerPos.z);
            scene.add(liftPlatform); // Add to scene for independent movement

            scene.add(mansion);
        }

        function buildEnvironment() {
            const ground = new THREE.Mesh(new THREE.PlaneGeometry(300, 300), new THREE.MeshStandardMaterial({ color: 0x4A6B4A }));
            ground.rotation.x = -Math.PI/2;
            ground.position.y = -0.5;
            ground.receiveShadow = true;
            scene.add(ground);

            const lake = new THREE.Mesh(new THREE.PlaneGeometry(300, 100), matPoolWater);
            lake.rotation.x = -Math.PI/2;
            lake.position.set(0, -1, 70);
            scene.add(lake);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();

            const t = clock.getElapsedTime();
            // Animate Lift: goes from Deck 1 (y=0) to Deck 2 (y=4)
            const liftY = 2 + Math.sin(t * 0.5) * 2; 
            if(liftPlatform) liftPlatform.position.y = Math.max(0, liftY);

            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
