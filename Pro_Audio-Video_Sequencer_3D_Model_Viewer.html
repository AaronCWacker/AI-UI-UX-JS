<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>3D .glb Viewer with Starfield + Orbit + Auto-Pan</title>
  <style>
    :root {
      --bg-color: #121212;
      --surface-color: #1e1e1e;
      --primary: #bb86fc;
      --secondary: #03dac6;
      --error: #cf6679;
      --border: #333;
    }
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--bg-color);
      color: #e0e0e0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }
    h1 { margin-bottom: 10px; color: var(--primary); text-shadow: 0 0 10px rgba(187, 134, 252, 0.3); }
    h2 { font-size: 1rem; color: #aaa; margin-bottom: 25px; font-weight: normal; }
   
    .container {
      background-color: var(--surface-color);
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      width: 100%;
      max-width: 1000px;
    }
    .preview-area {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      background: #000;
      margin-bottom: 20px;
      border-radius: 8px;
      overflow: hidden;
      border: 2px solid var(--border);
    }
    canvas { width: 100%; height: 100%; display: block; }
   
    .controls {
      display: grid;
      grid-template-columns: 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }
    .panel {
      background: #2c2c2c;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      color: var(--primary);
      font-weight: bold;
      border-bottom: 1px solid #444;
      padding-bottom: 8px;
    }
   
    .btn {
      padding: 10px 16px;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-primary { background-color: var(--secondary); color: #000; font-size: 16px; width: 100%; }
    .btn-primary:hover { background-color: #018786; }
   
    #status { margin-top: 15px; font-size: 14px; color: #aaa; white-space: pre-wrap; font-family: monospace; }
  </style>
</head>
<body>
  <h1>ðŸŒŒ 3D .glb Model Viewer</h1>
  <h2>Upload .glb â†’ mouse orbit + zoom + slow auto-rotate + starfield background</h2>

  <div class="container">
    <div class="preview-area">
      <canvas id="renderCanvas"></canvas>
      <div id="overlay-text" style="position:absolute; inset:0; pointer-events:none; color:white; background:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; font-size:1.2rem; z-index:10; text-align:center; padding:20px;">
        Select a .glb file to view in 3D
      </div>
    </div>

    <div id="status">Ready. Click the button below to load a model.</div>

    <div class="controls">
      <div class="panel">
        <div class="panel-header">
          <span>ðŸŒŸ Load 3D Model (.glb / .gltf)</span>
        </div>
        <label for="modelInput" class="btn btn-primary" style="margin:8px 0; display:block; text-align:center; cursor:pointer;">
          Choose .glb File
        </label>
        <input type="file" id="modelInput" accept=".glb,.gltf" style="display:none;" />
        <div style="font-size:13px; color:#aaa; text-align:center; margin-top:8px;">
          Mouse drag = rotate â€¢ Scroll = zoom â€¢ Auto-rotate is enabled
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.168.0/build/three.module.js';
    import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.168.0/examples/jsm/controls/OrbitControls.js';
    import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.168.0/examples/jsm/loaders/GLTFLoader.js';
    import { DRACOLoader } from 'https://cdn.jsdelivr.net/npm/three@0.168.0/examples/jsm/loaders/DRACOLoader.js';

    const previewArea = document.querySelector('.preview-area');
    const overlay = document.getElementById('overlay-text');
    const statusDiv = document.getElementById('status');
    const canvas = document.getElementById('renderCanvas');

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Scene + Renderer + Camera
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x000011);

    const camera = new THREE.PerspectiveCamera(
      60,
      previewArea.clientWidth / previewArea.clientHeight,
      0.1,
      3000
    );
    camera.position.set(0, 2, 8);

    const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(previewArea.clientWidth, previewArea.clientHeight);
    renderer.outputColorSpace = THREE.SRGBColorSpace;

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Controls (orbit + auto-rotate)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.08;
    controls.autoRotate = true;
    controls.autoRotateSpeed = 0.7;
    controls.minDistance = 0.5;
    controls.maxDistance = 150;

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Lights
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    scene.add(new THREE.AmbientLight(0xffffff, 0.7));
    const dirLight = new THREE.DirectionalLight(0xffffff, 1.5);
    dirLight.position.set(8, 12, 10);
    scene.add(dirLight);

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Starfield
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const starCount = 18000;
    const positions = new Float32Array(starCount * 3);
    for (let i = 0; i < starCount * 3; i += 3) {
      positions[i]     = (Math.random() - 0.5) * 2400;
      positions[i + 1] = (Math.random() - 0.5) * 2400;
      positions[i + 2] = (Math.random() - 0.5) * 2400;
    }
    const starGeo = new THREE.BufferGeometry();
    starGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
    const starMat = new THREE.PointsMaterial({ color: 0xaaaaaa, size: 0.8, sizeAttenuation: true });
    scene.add(new THREE.Points(starGeo, starMat));

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Loaders with Draco support
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const dracoLoader = new DRACOLoader();
    dracoLoader.setDecoderPath('https://cdn.jsdelivr.net/npm/three@0.168.0/examples/jsm/libs/draco/');

    const loader = new GLTFLoader();
    loader.setDRACOLoader(dracoLoader);

    let currentModel = null;

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // File upload handler
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('modelInput').addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      overlay.innerText = `Loading ${file.name} â€¦`;
      statusDiv.innerText = `Loading model (${(file.size / 1024 / 1024).toFixed(1)} MB)`;

      const url = URL.createObjectURL(file);

      try {
        const gltf = await loader.loadAsync(url, (progress) => {
          const pct = Math.round((progress.loaded / progress.total) * 100);
          overlay.innerText = `Loadingâ€¦ ${pct}%`;
        });

        // Remove previous model if any
        if (currentModel) {
          scene.remove(currentModel);
        }

        currentModel = gltf.scene;
        scene.add(currentModel);

        // Center + fit
        const box = new THREE.Box3().setFromObject(currentModel);
        const center = box.getCenter(new THREE.Vector3());
        const size = box.getSize(new THREE.Vector3());
        const maxDim = Math.max(size.x, size.y, size.z) || 1;
        const f = 6 / maxDim;   // â† change this number to make model bigger/smaller

        currentModel.scale.set(f, f, f);
        currentModel.position.sub(center.multiplyScalar(f));

        // Good starting view
        camera.position.set(0, size.y * f * 0.4, size.z * f * 2.2);
        controls.target.set(0, size.y * f * 0.25, 0);
        controls.update();

        overlay.innerText = `Loaded: ${file.name}   â€¢   drag to orbit â€¢ scroll to zoom`;
        statusDiv.innerText = 'Model ready';

      } catch (err) {
        console.error('Model load failed:', err);
        overlay.innerText = 'Error loading model.\nCheck console (F12) for details.';
        statusDiv.innerText = 'Failed to load model';
      } finally {
        setTimeout(() => URL.revokeObjectURL(url), 400);
        e.target.value = ''; // allow re-selecting same file
      }
    });

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Animation loop
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function animate() {
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Resize
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    new ResizeObserver(() => {
      const w = previewArea.clientWidth;
      const h = previewArea.clientHeight;
      camera.aspect = w / h;
      camera.updateProjectionMatrix();
      renderer.setSize(w, h);
    }).observe(previewArea);
  </script>
</body>
</html>
