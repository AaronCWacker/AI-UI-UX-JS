<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Saints Tarot - 3D Gesture Edition</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', serif;
            background: #0a0015;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            touch-action: none;
        }
        #container { width: 100%; height: 100vh; position: relative; }
        #ui-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 100;
        }
        #controls {
            position: absolute; top: 16px; left: 16px;
            background: rgba(0, 0, 0, 0.88);
            padding: 16px; border-radius: 14px;
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 215, 0, 0.3);
            pointer-events: auto; max-width: 300px;
        }
        h1 {
            font-size: 1.5em; margin-bottom: 6px; text-align: center;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .subtitle { text-align: center; font-size: 0.75em; opacity: 0.6; margin-bottom: 12px; }
        .btn {
            width: 100%; padding: 10px; margin: 5px 0;
            background: linear-gradient(135deg, #4a0080, #7000cc);
            border: 2px solid #ffd700; color: #fff; font-size: 0.9em;
            cursor: pointer; border-radius: 8px; transition: all 0.3s;
            font-weight: bold; pointer-events: auto; font-family: Georgia, serif;
        }
        .btn:hover { background: linear-gradient(135deg, #6000a0, #9000ff); box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); transform: scale(1.04); }
        .btn:active { transform: scale(0.96); }
        .btn-row { display: flex; gap: 5px; }
        .btn-row .btn { font-size: 0.8em; padding: 8px 4px; }
        #mode-indicator {
            text-align: center; padding: 8px;
            background: rgba(255, 215, 0, 0.15); border-radius: 8px;
            margin-bottom: 8px; font-size: 0.85em;
        }
        #gesture-hud {
            position: absolute; bottom: 16px; left: 50%; transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.75); padding: 10px 20px;
            border-radius: 12px; backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 215, 0, 0.2);
            font-size: 0.8em; pointer-events: none;
            display: flex; gap: 20px; align-items: center;
            transition: opacity 0.4s;
        }
        #gesture-hud .metric { text-align: center; }
        #gesture-hud .metric-label { color: #ffd700; font-size: 0.7em; text-transform: uppercase; letter-spacing: 1px; }
        #gesture-hud .metric-value { font-size: 1.1em; font-weight: bold; font-variant-numeric: tabular-nums; }
        #countdown-timer {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 6em; font-weight: bold; color: rgba(255, 215, 0, 0.9);
            text-shadow: 0 0 40px rgba(255, 215, 0, 0.8);
            opacity: 0; transition: opacity 0.3s; pointer-events: none;
        }
        #countdown-timer.active { opacity: 1; }
        #gesture-feedback {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 2.5em; font-weight: bold; color: #ffd700;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.8);
            opacity: 0; pointer-events: none; transition: opacity 0.2s;
        }
        #help-overlay {
            position: absolute; top: 16px; right: 16px;
            background: rgba(0, 0, 0, 0.85); padding: 14px;
            border-radius: 10px; font-size: 0.8em; max-width: 240px;
            pointer-events: auto; border: 2px solid rgba(255, 215, 0, 0.2);
        }
        .help-section { margin-bottom: 8px; }
        .help-section strong { color: #ffd700; }
        @media (max-width: 768px) {
            #controls { top: 8px; left: 8px; padding: 12px; max-width: calc(100% - 16px); }
            h1 { font-size: 1.3em; }
            #help-overlay { display: none; }
            #gesture-hud { font-size: 0.7em; gap: 12px; padding: 8px 14px; }
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <div id="ui-overlay">
        <div id="controls">
            <h1>‚≠ê Saints Tarot ‚≠ê</h1>
            <div class="subtitle">80 Saints ‚Ä¢ Gesture 3D Edition</div>
            <div id="mode-indicator">üé¥ 3-Card Reading</div>
            <button class="btn" id="btn-draw">üé¥ Draw Cards</button>
            <button class="btn" id="btn-view">üìö Switch to Gallery</button>
            <button class="btn" id="btn-auto">‚è±Ô∏è Auto-Play: OFF</button>
            <button class="btn" id="btn-reset">üîÑ Reset</button>
            <div style="margin-top: 10px; padding-top: 10px; border-top: 2px solid rgba(255,215,0,0.3);">
                <div style="text-align:center;color:#ffd700;font-size:0.85em;margin-bottom:6px;">üì∑ Camera Views</div>
                <div class="btn-row">
                    <button class="btn" id="btn-front">üéØ Front</button>
                    <button class="btn" id="btn-iso">üìê Iso</button>
                </div>
                <div class="btn-row">
                    <button class="btn" id="btn-top">üîù Top</button>
                    <button class="btn" id="btn-back">‚Ü©Ô∏è Back</button>
                </div>
            </div>
            <div style="margin-top: 10px; padding-top: 10px; border-top: 2px solid rgba(255,215,0,0.3);">
                <div style="text-align:center;color:#ffd700;font-size:0.85em;margin-bottom:6px;">‚úã Gestures</div>
                <button class="btn" id="btn-cursor-toggle" style="font-size:0.85em;padding:8px;">üëÅÔ∏è Cursor Orb: ON</button>
                <button class="btn" id="btn-trails-toggle" style="font-size:0.85em;padding:8px;">‚ú® Trails: ON</button>
            </div>
        </div>
        <div id="countdown-timer">30</div>
        <div id="gesture-feedback"></div>
        <div id="gesture-hud">
            <div class="metric">
                <div class="metric-label">Velocity</div>
                <div class="metric-value" id="hud-velocity">0</div>
            </div>
            <div class="metric">
                <div class="metric-label">Scroll</div>
                <div class="metric-value" id="hud-scroll">0</div>
            </div>
            <div class="metric">
                <div class="metric-label">Direction</div>
                <div class="metric-value" id="hud-direction">‚Äî</div>
            </div>
            <div class="metric">
                <div class="metric-label">Gesture</div>
                <div class="metric-value" id="hud-gesture">idle</div>
            </div>
        </div>
        <div id="help-overlay">
            <div class="help-section">
                <strong>üñ±Ô∏è Mouse/Touch:</strong><br>
                Click card = Fullscreen zoom<br>
                Drag = Rotate scene<br>
                Scroll = Zoom / Flick cards<br>
                Fast flick = Shuffle!
            </div>
            <div class="help-section">
                <strong>üëÜ Touch:</strong><br>
                Tap = Select card<br>
                Swipe = Rotate scene<br>
                Pinch = Zoom<br>
                2-finger swipe = Shuffle
            </div>
            <div class="help-section">
                <strong>‚å®Ô∏è Keys:</strong><br>
                WASD: Move | QE: Tilt<br>
                ZXC: Quick Views<br>
                Space: Draw | ESC: Exit
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // SAINTS DATA
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    const saints_data = [
        {"id":1,"name":"Adalbert of Prague","card":"Five of Wands","classifier":"Wands - Fire - Creativity","emojis":"üõ∂, üôè","continent":"Europe","story":"A Bishop of Prague who struggled with conflict and resistance while trying to reform his diocese. He was ultimately martyred trying to bring his faith to a hostile land, embodying a narrative of struggle and striving for a higher cause against opposition.","virtues":"Missionary Zeal, Perseverance, Courage, Faith","gender":"Male","location":"Prague, Bohemia (Czech Rep.)","canon":"Vita Sancti Adalberti"},
        {"id":2,"name":"Agnes of Rome","card":"The Star (XVII)","classifier":"Major Arcana","emojis":"üêë, ‚ú®","continent":"Europe","story":"A young girl who became a beacon of pure faith and hope in a time of dark persecution. Her story, filled with miracles protecting her, represents divine inspiration and serenity in the face of mortal danger.","virtues":"Purity, Courage, Faithfulness, Steadfastness","gender":"Female","location":"Rome, Italy","canon":"The Golden Legend"},
        {"id":3,"name":"Ambrose of Milan","card":"The Hierophant (V)","classifier":"Major Arcana","emojis":"üèõÔ∏è, üêù","continent":"Europe","story":"A governor who became a bishop, a master of tradition, and a teacher of orthodox doctrine. He was a pillar of the Church, mentoring St. Augustine and establishing the authority of spiritual institutions.","virtues":"Leadership, Justice, Wisdom, Fortitude","gender":"Male","location":"Milan, Italy","canon":"On the Duties of the Clergy"},
        {"id":4,"name":"Andrew of Crete","card":"Eight of Cups","classifier":"Cups - Water - Emotional","emojis":"üéº, üôè","continent":"Asia","story":"A bishop and hymnographer most famous for his Great Canon, a masterpiece of penitential reflection representing a deep spiritual journey inward.","virtues":"Penance, Liturgy, Eloquence, Poetry","gender":"Male","location":"Crete, Greece","canon":"The Great Canon of St. Andrew of Crete"},
        {"id":5,"name":"Anselm of Canterbury","card":"King of Swords","classifier":"Swords - Air - Reason","emojis":"üß†, ‚öñÔ∏è","continent":"Europe","story":"A brilliant theologian and philosopher who became Archbishop of Canterbury. His use of logic and his defense of the Church's intellectual and legal rights mark him as a master of reason.","virtues":"Intellect, Faith, Reason, Fortitude","gender":"Male","location":"Canterbury, England","canon":"Proslogion, Cur Deus Homo"},
        {"id":6,"name":"Anthony of Egypt","card":"The Hermit (IX)","classifier":"Major Arcana","emojis":"üèúÔ∏è, üèÆ","continent":"Africa","story":"The quintessential hermit who withdrew from society into the desert to seek spiritual truth. He battled his inner demons and found profound wisdom in solitude.","virtues":"Asceticism, Perseverance, Spiritual Warfare, Solitude","gender":"Male","location":"Egyptian Desert","canon":"Life of Antony by Athanasius"},
        {"id":7,"name":"Anthony of Padua","card":"Ace of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"ü•ñ, üìñ","continent":"Europe","story":"A beloved saint associated with tangible results: finding lost items, providing bread for the poor. The Ace of Pentacles represents a seed of opportunity in the material world.","virtues":"Eloquence, Charity, Knowledge, Humility","gender":"Male","location":"Padua, Italy","canon":"Legenda Assidua"},
        {"id":8,"name":"Athanasius of Alexandria","card":"Five of Swords","classifier":"Swords - Air - Reason","emojis":"üõ°Ô∏è, ‚úùÔ∏è","continent":"Africa","story":"A champion of orthodoxy who was exiled five times for his unwavering theological stance against Arianism. His life was one of constant conflict and intellectual battle.","virtues":"Orthodoxy, Fortitude, Perseverance, Conviction","gender":"Male","location":"Alexandria, Egypt","canon":"On the Incarnation"},
        {"id":9,"name":"Augustine of Hippo","card":"The Devil (XV)","classifier":"Major Arcana","emojis":"üìö, ‚õìÔ∏è","continent":"Africa","story":"A man who famously struggled with and wrote about his bondage to worldly pleasures and intellectual pride before his conversion. The ultimate archetype of confronting chains.","virtues":"Perseverance, Faith, Intellect, Repentance","gender":"Male","location":"Hippo Regius, Algeria","canon":"Confessions, City of God"},
        {"id":10,"name":"Basil of Caesarea","card":"Ten of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üïäÔ∏è, üè•","continent":"Asia","story":"A bishop who established the Basiliad, a massive complex serving the poor and sick. He created a lasting structure of communal wealth and charity.","virtues":"Charity, Leadership, Orthodoxy, Governance","gender":"Male","location":"Caesarea, Turkey","canon":"On the Holy Spirit"},
        {"id":11,"name":"Bede the Venerable","card":"Four of Swords","classifier":"Swords - Air - Reason","emojis":"üìú, ‚õ™","continent":"Europe","story":"A monk who spent his life in the quiet contemplation of the monastery, producing great historical work from scholarly retreat and study.","virtues":"Scholarship, Humility, Diligence, Piety","gender":"Male","location":"Jarrow, England","canon":"Ecclesiastical History of the English People"},
        {"id":12,"name":"Benedict of Nursia","card":"Temperance (XIV)","classifier":"Major Arcana","emojis":"‚öñÔ∏è, üôè","continent":"Europe","story":"Author of the Rule, a masterful guide synthesizing prayer, work, and study into balanced life. The archetype of Temperance, blending spiritual and practical.","virtues":"Order, Stability, Prayerfulness, Moderation","gender":"Male","location":"Monte Cassino, Italy","canon":"The Rule of Saint Benedict"},
        {"id":13,"name":"Bernadette of Lourdes","card":"Page of Cups","classifier":"Cups - Water - Emotional","emojis":"üíß, üåπ","continent":"Europe","story":"A simple girl open enough to receive a divine message. Innocence, emotional purity, and being a messenger from the spiritual realms.","virtues":"Humility, Simplicity, Faith, Obedience","gender":"Female","location":"Lourdes, France","canon":"Church investigation records"},
        {"id":14,"name":"Bernard of Clairvaux","card":"Knight of Wands","classifier":"Wands - Fire - Creativity","emojis":"üêù, üî•","continent":"Europe","story":"An abbot of immense energy and passion who revitalized his order and preached the Second Crusade with fiery zeal that inspired thousands.","virtues":"Zeal, Devotion, Persuasion, Mysticism","gender":"Male","location":"Clairvaux, France","canon":"On Loving God"},
        {"id":15,"name":"Bonaventure","card":"Two of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"ü¶â, ‚öñÔ∏è","continent":"Europe","story":"As Minister General of the Franciscans, he expertly balanced spiritual ideals with practical administrative needs of a large order.","virtues":"Intellect, Devotion, Governance, Wisdom","gender":"Male","location":"Bagnoregio, Italy","canon":"The Journey of the Mind into God"},
        {"id":16,"name":"Brendan of Clonfert","card":"The Moon (XVIII)","classifier":"Major Arcana","emojis":"‚õµÔ∏è, üêã","continent":"Europe","story":"A navigator who sailed into the unknown, guided by faith rather than maps. His voyage into mystery reflects journeying through the unconscious.","virtues":"Faith, Courage, Adventure, Perseverance","gender":"Male","location":"Clonfert, Ireland","canon":"Navigatio Sancti Brendani"},
        {"id":17,"name":"Bridget of Sweden","card":"Three of Swords","classifier":"Swords - Air - Reason","emojis":"‚úçÔ∏è, üíî","continent":"Europe","story":"A widowed mystic whose divine revelations often contained painful truths and sorrowful critiques of the Church and its leaders.","virtues":"Mysticism, Piety, Reform, Prophecy","gender":"Female","location":"Sweden / Rome","canon":"Revelations of St. Bridget"},
        {"id":18,"name":"Catherine of Alexandria","card":"Queen of Swords","classifier":"Swords - Air - Reason","emojis":"‚öôÔ∏è, üëë","continent":"Africa","story":"A princess and scholar who used sharp intellect and clear logic to debate and defeat fifty pagan philosophers. Intelligent, articulate, unafraid.","virtues":"Wisdom, Eloquence, Faithfulness, Courage","gender":"Female","location":"Alexandria, Egypt","canon":"The Golden Legend"},
        {"id":19,"name":"Catherine of Genoa","card":"Six of Cups","classifier":"Cups - Water - Emotional","emojis":"üè•, ‚ù§Ô∏è‚Äçü©π","continent":"Europe","story":"A mystic who gave herself to the simple, innocent charity of caring for the sick with selfless, compassionate connection.","virtues":"Charity, Self-Denial, Service, Mysticism","gender":"Female","location":"Genoa, Italy","canon":"Treatise on Purgatory"},
        {"id":20,"name":"Catherine of Siena","card":"Justice (XI)","classifier":"Major Arcana","emojis":"‚öúÔ∏è, ‚öñÔ∏è","continent":"Europe","story":"A mystic who wielded immense influence to correct a great imbalance, persuading the Pope to return to Rome from Avignon.","virtues":"Wisdom, Fortitude, Persuasion, Mysticism","gender":"Female","location":"Siena, Italy","canon":"The Dialogue of Divine Providence"},
        {"id":21,"name":"Clare of Assisi","card":"The Sun (XIX)","classifier":"Major Arcana","emojis":"‚ú®, ‚òÄÔ∏è","continent":"Europe","story":"Her name means 'light,' and as founder of the Poor Clares, she radiated joy, clarity, and unwavering faith.","virtues":"Poverty, Faith, Courage, Devotion","gender":"Female","location":"Assisi, Italy","canon":"The Rule of St. Clare"},
        {"id":22,"name":"Columba of Iona","card":"Six of Wands","classifier":"Wands - Fire - Creativity","emojis":"üáÆüá™, üïäÔ∏è","continent":"Europe","story":"A successful missionary who established a thriving monastery at Iona, a beacon of faith and learning. Victory and recognition.","virtues":"Evangelism, Leadership, Scholarship, Diplomacy","gender":"Male","location":"Iona, Scotland","canon":"Vita Columbae by Adomn√°n"},
        {"id":23,"name":"Cuthbert of Lindisfarne","card":"Four of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üôè, üèùÔ∏è","continent":"Europe","story":"A hermit who sought stability and control over his spiritual life by retreating to a remote island, conserving spiritual energy.","virtues":"Piety, Humility, Solitude, Gentleness","gender":"Male","location":"Lindisfarne, England","canon":"Life of St. Cuthbert by Bede"},
        {"id":24,"name":"Cyril of Alexandria","card":"Seven of Swords","classifier":"Swords - Air - Reason","emojis":"üìú, üõ°Ô∏è","continent":"Africa","story":"A brilliant but controversial theologian who used sharp political and rhetorical strategies to defeat opponents. Strategy and maneuvering.","virtues":"Orthodoxy, Tenacity, Polemics, Wisdom","gender":"Male","location":"Alexandria, Egypt","canon":"Against Nestorius"},
        {"id":25,"name":"Cyril of Jerusalem","card":"Page of Swords","classifier":"Swords - Air - Reason","emojis":"üìö, üìñ","continent":"Asia","story":"His fame rests on Catechetical Lectures for new students of the faith. A messenger and student of truth with curiosity.","virtues":"Teaching, Orthodoxy, Patience, Fortitude","gender":"Male","location":"Jerusalem","canon":"Catechetical Lectures"},
        {"id":26,"name":"Dominic of Guzm√°n","card":"Ace of Wands","classifier":"Wands - Fire - Creativity","emojis":"üê∂, üî•","continent":"Europe","story":"He founded the Order of Preachers, sparking a new energetic movement of missionary and intellectual activity. A burst of inspiration.","virtues":"Truth, Preaching, Study, Zeal","gender":"Male","location":"Caleruega, Spain","canon":"Libellus by Jordan of Saxony"},
        {"id":27,"name":"Elizabeth of Hungary","card":"The Empress (III)","classifier":"Major Arcana","emojis":"üëë, ü•ñ","continent":"Europe","story":"A princess who embodied maternal care and earthly abundance through radical charity, baking bread for the poor.","virtues":"Charity, Humility, Compassion, Service","gender":"Female","location":"Kingdom of Hungary","canon":"Life by Dietrich of Apolda"},
        {"id":28,"name":"Elizabeth of Portugal","card":"Two of Cups","classifier":"Cups - Water - Emotional","emojis":"üïäÔ∏è, ü§ù","continent":"Europe","story":"A queen known as 'The Peacemaker' for her ability to forge partnerships and reconcile warring family members.","virtues":"Peacemaking, Charity, Diplomacy, Piety","gender":"Female","location":"Kingdom of Portugal","canon":"Papal Bull by Urban VIII"},
        {"id":29,"name":"Ferdinand III of Castile","card":"The Emperor (IV)","classifier":"Major Arcana","emojis":"‚öîÔ∏è, üè∞","continent":"Europe","story":"A just king who unified kingdoms, established laws, and built stable society. A figure of worldly authority and structure.","virtues":"Justice, Leadership, Piety, Fortitude","gender":"Male","location":"Castile, Spain","canon":"Chronica latina regum Castellae"},
        {"id":30,"name":"Frances of Rome","card":"Nine of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üòá, üè°","continent":"Europe","story":"A noblewoman who found spiritual discipline and independence within her domestic life. Grace and self-reliance.","virtues":"Charity, Service, Piety, Patience","gender":"Female","location":"Rome, Italy","canon":"Papal Bull by Paul V"},
        {"id":31,"name":"Francis of Assisi","card":"The Fool (0)","classifier":"Major Arcana","emojis":"üêæ, ‚òÄÔ∏è","continent":"Europe","story":"He abandoned wealth for a radical leap of faith into the unknown, embracing poverty and trusting divine providence. The Fool's journey.","virtues":"Humility, Poverty, Charity, Love for Creation","gender":"Male","location":"Assisi, Italy","canon":"Canticle of the Sun"},
        {"id":32,"name":"Francis de Sales","card":"Strength (VIII)","classifier":"Major Arcana","emojis":"üíå, ‚ù§Ô∏è‚Äçüî•","continent":"Europe","story":"A bishop known for his gentle spirit. True strength lies in compassion and taming wild passions with a gentle hand.","virtues":"Gentleness, Patience, Spiritual Direction, Charity","gender":"Male","location":"Thorens-Gli√®res, France","canon":"Introduction to the Devout Life"},
        {"id":33,"name":"George of Lydda","card":"Seven of Wands","classifier":"Wands - Fire - Creativity","emojis":"üêâ, üõ°Ô∏è","continent":"Asia","story":"The legendary dragon-slayer who stands alone defending the innocent. Courage and maintaining position against all odds.","virtues":"Courage, Chivalry, Faith, Protection","gender":"Male","location":"Lydda, Palestine","canon":"The Golden Legend"},
        {"id":34,"name":"Gertrude of Nivelles","card":"Three of Cups","classifier":"Cups - Water - Emotional","emojis":"üêà, üè°","continent":"Europe","story":"An abbess renowned for warm hospitality, creating a joyful community for pilgrims. Camaraderie and friendship.","virtues":"Hospitality, Piety, Prudence, Charity","gender":"Female","location":"Nivelles, Belgium","canon":"Vita Sanctae Geretrudis"},
        {"id":35,"name":"Gregory of Nazianzus","card":"Ten of Swords","classifier":"Swords - Air - Reason","emojis":"üó£Ô∏è, üò•","continent":"Asia","story":"A brilliant but reluctant bishop who felt the crushing weight of ecclesiastical politics. A painful ending forcing new beginnings.","virtues":"Eloquence, Theology, Humility, Contemplation","gender":"Male","location":"Nazianzus, Turkey","canon":"Five Theological Orations"},
        {"id":36,"name":"Gregory of Nyssa","card":"Page of Wands","classifier":"Wands - Fire - Creativity","emojis":"ü§î, üî•","continent":"Asia","story":"A philosophical theologian who explored new frontiers of thought on the spiritual life with passion and inspiration.","virtues":"Intellect, Mysticism, Philosophy, Orthodoxy","gender":"Male","location":"Nyssa, Turkey","canon":"The Life of Moses"},
        {"id":37,"name":"Gregory the Great","card":"King of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üé∂, üëë","continent":"Europe","story":"A Pope who was a master administrator, managing papal estates, organizing liturgies, and creating stability for the Church.","virtues":"Leadership, Reform, Evangelism, Humility","gender":"Male","location":"Rome, Italy","canon":"Pastoral Rule"},
        {"id":38,"name":"Hedwig of Silesia","card":"Queen of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üë£, üëë","continent":"Europe","story":"A duchess who used her wealth to nurture the poor, founding monasteries and hospitals. Practical, charitable, motherly.","virtues":"Charity, Piety, Austerity, Humility","gender":"Female","location":"Silesia, Poland","canon":"Vita beatae Hedwigis"},
        {"id":39,"name":"Helena of Constantinople","card":"Three of Wands","classifier":"Wands - Fire - Creativity","emojis":"‚ò¶Ô∏è, üó∫Ô∏è","continent":"Asia","story":"She embarked on a great expedition to the Holy Land, looking out to a new horizon. Foresight and exploration.","virtues":"Faith, Piety, Discovery, Perseverance","gender":"Female","location":"Constantinople, Turkey","canon":"Hagiographies by Eusebius"},
        {"id":40,"name":"Hildegard of Bingen","card":"The High Priestess (II)","classifier":"Major Arcana","emojis":"üé∂, üåø","continent":"Europe","story":"A powerful abbess, mystic, and visionary who was a conduit for divine knowledge. Keeper of sacred secrets.","virtues":"Wisdom, Creativity, Prophecy, Knowledge","gender":"Female","location":"Bingen am Rhein, Germany","canon":"Scivias, Ordo Virtutum"},
        {"id":41,"name":"Hugh of Lincoln","card":"Six of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"ü¶¢, ü™ô","continent":"Europe","story":"A bishop renowned for immense charity and justice, especially defense of the poor. Generous giving and balance.","virtues":"Justice, Courage, Piety, Tenderness","gender":"Male","location":"Lincoln, England","canon":"Magna Vita Sancti Hugonis"},
        {"id":42,"name":"Ignatius of Loyola","card":"Wheel of Fortune (X)","classifier":"Major Arcana","emojis":"‚úùÔ∏è, üéØ","continent":"Europe","story":"A cannonball injury changed his trajectory completely, turning a vain soldier into the founder of the Jesuits. A turn of fate.","virtues":"Discernment, Obedience, Zeal, Self-Discipline","gender":"Male","location":"Loyola, Spain","canon":"Spiritual Exercises"},
        {"id":43,"name":"Irenaeus of Lyons","card":"Two of Swords","classifier":"Swords - Air - Reason","emojis":"üó£Ô∏è, ‚öîÔ∏è","continent":"Europe","story":"A bishop who created a clear line between orthodoxy and Gnosticism. Blocking confusion to establish truth.","virtues":"Orthodoxy, Teaching, Apologetics, Faithfulness","gender":"Male","location":"Lyons, France","canon":"Against Heresies"},
        {"id":44,"name":"Isidore of Seville","card":"The Magician (I)","classifier":"Major Arcana","emojis":"üíæ, üìö","continent":"Europe","story":"An encyclopedist who gathered all knowledge of his era into the Etymologiae. The Magician who manifests divine resources on Earth.","virtues":"Knowledge, Scholarship, Order, Wisdom","gender":"Male","location":"Seville, Spain","canon":"Etymologiae"},
        {"id":45,"name":"James of the Marches","card":"Eight of Wands","classifier":"Wands - Fire - Creativity","emojis":"‚≠êÔ∏è, ‚úàÔ∏è","continent":"Europe","story":"A tireless preacher who traveled with great speed and energy across Central and Eastern Europe. Swift action and rapid delivery.","virtues":"Zeal, Preaching, Austerity, Reform","gender":"Male","location":"Ancona, Italy","canon":"Hagiographies by Venantius"},
        {"id":46,"name":"Joan of Arc","card":"The Chariot (VII)","classifier":"Major Arcana","emojis":"üá´üá∑, ‚öîÔ∏è","continent":"Europe","story":"A peasant girl who through sheer willpower harnessed the French army and led them to victory. Unstoppable inner will.","virtues":"Courage, Faith, Patriotism, Fortitude","gender":"Female","location":"Domr√©my, France","canon":"Trial transcripts"},
        {"id":47,"name":"John of Damascus","card":"Knight of Swords","classifier":"Swords - Air - Reason","emojis":"üñºÔ∏è, ‚úçÔ∏è","continent":"Asia","story":"A brilliant defender of the faith who charged into theological debate with sharp logic. Focused intellectual power.","virtues":"Orthodoxy, Courage, Eloquence, Wisdom","gender":"Male","location":"Damascus, Syria","canon":"Fountain of Knowledge"},
        {"id":48,"name":"John of God","card":"Knight of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"‚ù§Ô∏è‚Äçü©π, üè•","continent":"Europe","story":"After conversion, he worked tirelessly to build institutions to care for the sick. Hardworking and dedicated to practical service.","virtues":"Compassion, Charity, Hospitality, Humility","gender":"Male","location":"Portugal","canon":"Life by Francisco de Castro"},
        {"id":49,"name":"John of the Cross","card":"Knight of Cups","classifier":"Cups - Water - Emotional","emojis":"üåå, ‚ù§Ô∏è‚Äçüî•","continent":"Europe","story":"A mystic poet whose life was a romantic spiritual quest for union with God through the dark night. Driven by emotional calling.","virtues":"Mysticism, Perseverance, Poeticism, Fortitude","gender":"Male","location":"Fontiveros, Spain","canon":"Dark Night of the Soul"},
        {"id":50,"name":"Joseph of Arimathea","card":"Seven of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üè∫, ‚ö∞Ô∏è","continent":"Asia","story":"A man who invested in a long-term project and patiently waited for the right moment. Patience and assessing one's labor.","virtues":"Courage, Faith, Charity, Discipleship","gender":"Male","location":"Arimathea, Judea","canon":"The New Testament"},
        {"id":51,"name":"Joseph of Cupertino","card":"Ace of Cups","classifier":"Cups - Water - Emotional","emojis":"üïäÔ∏è, ‚òÅÔ∏è","continent":"Europe","story":"A simple friar whose prayer was so profound he would overflow with divine love and levitate. Pure outpouring of spiritual energy.","virtues":"Humility, Piety, Ecstasy, Simplicity","gender":"Male","location":"Cupertino, Italy","canon":"Life by Robert Nuti"},
        {"id":52,"name":"Juan Diego","card":"Seven of Cups","classifier":"Cups - Water - Emotional","emojis":"üá≤üáΩ, üåπ","continent":"North America","story":"A humble man presented with a powerful divine vision and a choice. Dreams made manifest, reflecting visionary choices.","virtues":"Humility, Faith, Simplicity, Obedience","gender":"Male","location":"Cuautitl√°n, Mexico","canon":"Nican Mopohua"},
        {"id":53,"name":"Juliana of Norwich","card":"Nine of Cups","classifier":"Cups - Water - Emotional","emojis":"ü•ú, üòä","continent":"Europe","story":"An anchoress who arrived at profound spiritual contentment: 'All shall be well.' Emotional and spiritual fulfillment.","virtues":"Hope, Contemplation, Trust, Mysticism","gender":"Female","location":"Norwich, England","canon":"Revelations of Divine Love"},
        {"id":54,"name":"Kateri Tekakwitha","card":"Eight of Swords","classifier":"Swords - Air - Reason","emojis":"‚öúÔ∏è, üôè","continent":"North America","story":"A young woman who felt isolated and trapped for her beliefs. She overcame powerlessness to live her faith freely.","virtues":"Purity, Faith, Perseverance, Courage","gender":"Female","location":"Auriesville, NY","canon":"Jesuit Relations"},
        {"id":55,"name":"Lawrence of Brindisi","card":"Ace of Swords","classifier":"Swords - Air - Reason","emojis":"üó£Ô∏è, üí°","continent":"Europe","story":"A brilliant linguist whose intellect cut through confusion. A breakthrough of clarity and intellectual triumph.","virtues":"Knowledge, Eloquence, Diplomacy, Zeal","gender":"Male","location":"Brindisi, Italy","canon":"Sermons"},
        {"id":56,"name":"Lawrence of Rome","card":"Nine of Wands","classifier":"Wands - Fire - Creativity","emojis":"üî•, ü™ô","continent":"Europe","story":"A deacon who made a last stand of defiance, presenting the poor as the Church's treasure. Resilience and holding ground.","virtues":"Courage, Charity, Humor, Fortitude","gender":"Male","location":"Rome, Italy","canon":"Hagiographies by Ambrose"},
        {"id":57,"name":"Leo the Great","card":"Four of Wands","classifier":"Wands - Fire - Creativity","emojis":"üìú, ü§ù","continent":"Europe","story":"A Pope who brought peace by persuading Attila the Hun to spare Rome. Celebration, harmony, and community safety.","virtues":"Leadership, Diplomacy, Courage, Orthodoxy","gender":"Male","location":"Rome, Italy","canon":"Tome of Leo"},
        {"id":58,"name":"Louis IX of France","card":"King of Cups","classifier":"Cups - Water - Emotional","emojis":"‚öúÔ∏è, ‚ù§Ô∏è‚Äç‚öñÔ∏è","continent":"Europe","story":"A king whose rule was defined by compassion and emotional balance. A master of the emotional realm through paternal love.","virtues":"Justice, Piety, Charity, Humility","gender":"Male","location":"Poissy, France","canon":"Life by Jean de Joinville"},
        {"id":59,"name":"Margaret of Antioch","card":"The World (XXI)","classifier":"Major Arcana","emojis":"üêâ, ‚öõÔ∏è","continent":"Asia","story":"A legendary saint who defeated a dragon from within, representing total victory over evil and completion of a great cycle.","virtues":"Faithfulness, Purity, Perseverance, Fortitude","gender":"Female","location":"Antioch, Turkey","canon":"The Golden Legend"},
        {"id":60,"name":"Margaret of Scotland","card":"Page of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üè¥, üìö","continent":"Europe","story":"A queen who brought new learning, reform, and practical charity to her kingdom. Dedicated to manifesting new opportunities.","virtues":"Piety, Reform, Charity, Gentleness","gender":"Female","location":"Kingdom of Scotland","canon":"Life by Turgot of Durham"},
        {"id":61,"name":"Martin de Porres","card":"Page of Cups","classifier":"Cups - Water - Emotional","emojis":"üßπ, üê≠","continent":"South America","story":"A saint of profound humility and gentle compassion, especially to the lowly and animals. Open-hearted innocence.","virtues":"Humility, Charity, Justice, Compassion","gender":"Male","location":"Lima, Peru","canon":"Papal Bull by John XXIII"},
        {"id":62,"name":"Martin of Tours","card":"Two of Wands","classifier":"Wands - Fire - Creativity","emojis":"‚öîÔ∏è, üß•","continent":"Europe","story":"His defining moment was a choice between two worlds: the Roman military and Christ. Planning a new future path.","virtues":"Charity, Humility, Evangelism, Generosity","gender":"Male","location":"Tours, France","canon":"Vita Martini by Sulpicius Severus"},
        {"id":63,"name":"Mary of Magdala","card":"Judgment (XX)","classifier":"Major Arcana","emojis":"üíß, üåÖ","continent":"Asia","story":"First witness to the Resurrection, called to a higher purpose. Absolution, rebirth, and answering a divine calling.","virtues":"Faithfulness, Devotion, Repentance, Evangelism","gender":"Female","location":"Magdala, Galilee","canon":"The New Testament"},
        {"id":64,"name":"Nicholas of Myra","card":"Six of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üéÅ, ü§´","continent":"Asia","story":"The original secret Santa whose stories revolve around anonymous generous charity to those in need.","virtues":"Generosity, Charity, Protection, Kindness","gender":"Male","location":"Myra, Turkey","canon":"The Golden Legend"},
        {"id":65,"name":"Patrick of Ireland","card":"Ace of Wands","classifier":"Wands - Fire - Creativity","emojis":"‚òòÔ∏è, üî•","continent":"Europe","story":"A missionary who brought a spark of immense creative and spiritual energy to Ireland, transforming the nation.","virtues":"Faith, Evangelism, Forgiveness, Courage","gender":"Male","location":"Ireland","canon":"Confessio of Saint Patrick"},
        {"id":66,"name":"Paul of Thebes","card":"Nine of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üå¥, üê¶","continent":"Africa","story":"The first hermit who lived in complete self-sufficiency in the desert, fed by a raven. Solitary abundance through discipline.","virtues":"Solitude, Asceticism, Prayerfulness, Simplicity","gender":"Male","location":"Theban Desert, Egypt","canon":"Vita Pauli by St. Jerome"},
        {"id":67,"name":"Peter of Verona","card":"Ten of Swords","classifier":"Swords - Air - Reason","emojis":"ü©∏, ‚úçÔ∏è","continent":"Europe","story":"An inquisitor martyred for his faith. A definitive painful ending that cannot extinguish the spirit.","virtues":"Courage, Faith, Forgiveness, Martyrdom","gender":"Male","location":"Verona, Italy","canon":"Papal Bull of Canonization"},
        {"id":68,"name":"Raymond of Penyafort","card":"Justice (XI)","classifier":"Major Arcana","emojis":"‚öñÔ∏è, üìö","continent":"Europe","story":"A master of canon law who compiled the Decretals, bringing clarity and fairness to Church law.","virtues":"Prudence, Justice, Diligence, Humility","gender":"Male","location":"Catalonia, Spain","canon":"Papal Bull by Clement VIII"},
        {"id":69,"name":"Rita of Cascia","card":"Five of Cups","classifier":"Cups - Water - Emotional","emojis":"üôè, ü•Ä","continent":"Europe","story":"A saint who endured immense personal loss yet found a way to turn from grief toward God. Sorrow and remaining hope.","virtues":"Patience, Forgiveness, Perseverance, Prayerfulness","gender":"Female","location":"Cascia, Italy","canon":"Papal Bull by Leo XIII"},
        {"id":70,"name":"Roch of Montpellier","card":"Eight of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üêï, ‚ù§Ô∏è‚Äçü©π","continent":"Europe","story":"A saint who dedicated himself to the diligent work of caring for plague victims. Mastery through dedication.","virtues":"Charity, Healing, Perseverance, Compassion","gender":"Male","location":"Montpellier, France","canon":"The Golden Legend"},
        {"id":71,"name":"Rose of Lima","card":"Four of Cups","classifier":"Cups - Water - Emotional","emojis":"üåπ, ü§î","continent":"South America","story":"A mystic who deliberately withdrew from worldly society to focus on contemplation. Turning inward, seeking something more.","virtues":"Piety, Purity, Mortification, Devotion","gender":"Female","location":"Lima, Peru","canon":"Papal Bull by Clement X"},
        {"id":72,"name":"Stephen of Hungary","card":"The Emperor (IV)","classifier":"Major Arcana","emojis":"üá≠üá∫, üëë","continent":"Europe","story":"The first King of Hungary who established the structure of a Christian nation. A worldly ruler and father figure.","virtues":"Leadership, Faith, Justice, Nation-building","gender":"Male","location":"Kingdom of Hungary","canon":"Hartvic's Life"},
        {"id":73,"name":"Teresa of √Åvila","card":"Queen of Cups","classifier":"Cups - Water - Emotional","emojis":"üè∞, ‚ù§Ô∏è","continent":"Europe","story":"A master of mystical theology who mapped the Interior Castle of the soul. Emotionally and spiritually intuitive.","virtues":"Prayerfulness, Determination, Reform, Mysticism","gender":"Female","location":"√Åvila, Spain","canon":"The Interior Castle"},
        {"id":74,"name":"Teresa of Calcutta","card":"Ten of Cups","classifier":"Cups - Water - Emotional","emojis":"üíô, üòä","continent":"Asia","story":"Her goal was to restore divine love and harmony to the poorest of the poor. Radiant emotional fulfillment.","virtues":"Compassion, Service, Charity, Humility","gender":"Female","location":"Calcutta, India","canon":"Letters, Constitutions"},
        {"id":75,"name":"Th√©r√®se of Lisieux","card":"The Lovers (VI)","classifier":"Major Arcana","emojis":"ü•Ä, ‚ù§Ô∏è","continent":"Europe","story":"Her 'Little Way' is about making a conscious choice to align with divine love in every action. Union through a profound choice.","virtues":"Humility, Simplicity, Love, Spiritual Childhood","gender":"Female","location":"Lisieux, France","canon":"The Story of a Soul"},
        {"id":76,"name":"Thomas Aquinas","card":"King of Swords","classifier":"Swords - Air - Reason","emojis":"üêÇ, üß†","continent":"Europe","story":"One of the greatest intellectual minds in history. The Summa Theologica is a monument to reason, logic, and intellectual authority.","virtues":"Intellect, Wisdom, Humility, Diligence","gender":"Male","location":"Aquino, Italy","canon":"Summa Theologica"},
        {"id":77,"name":"Thomas Becket","card":"The Hanged Man (XII)","classifier":"Major Arcana","emojis":"ü©∏, ‚õ™","continent":"Europe","story":"The Archbishop who willingly sacrificed everything in opposition to the king. Surrender to a higher principle.","virtues":"Fortitude, Principle, Justice, Martyrdom","gender":"Male","location":"Canterbury, England","canon":"Biographies by Edward Grim"},
        {"id":78,"name":"Vincent de Paul","card":"Three of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"‚ù§Ô∏è‚Äçü©π, ü§ù","continent":"Europe","story":"A master organizer who excelled at teamwork, founding the Vincentians. Success from working together on meaningful projects.","virtues":"Charity, Compassion, Service, Organization","gender":"Male","location":"Pouy, France","canon":"Correspondence, biographies"},
        {"id":79,"name":"Vincent Ferrer","card":"The Tower (XVI)","classifier":"Major Arcana","emojis":"üî•, üó£Ô∏è","continent":"Europe","story":"An apocalyptic preacher whose sermons shattered old assumptions like lightning bolts, bringing dramatic change.","virtues":"Preaching, Repentance, Zeal, Miracles","gender":"Male","location":"Valencia, Spain","canon":"Sermons, biographies"},
        {"id":80,"name":"Wenceslaus of Bohemia","card":"Knight of Pentacles","classifier":"Pentacles - Earth - Physical","emojis":"üëë, ‚ùÑÔ∏è","continent":"Europe","story":"The 'Good King' who undertook a practical journey through snow to bring aid to a poor peasant. Dutiful service and reliability.","virtues":"Piety, Justice, Good Governance, Faith","gender":"Male","location":"Bohemia, Czech Rep.","canon":"Christian's Legend"}
    ];

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // GESTURE ENGINE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    class GestureEngine {
        constructor() {
            // Mouse state
            this.mouseX = 0; this.mouseY = 0;
            this.prevMouseX = 0; this.prevMouseY = 0;
            this.mouseVelX = 0; this.mouseVelY = 0;
            this.mouseSpeed = 0;
            this.mouseAngle = 0;
            this.ndcX = 0; this.ndcY = 0;

            // Velocity history for smoothing
            this.velHistory = [];
            this.maxVelHistory = 8;

            // Scroll state
            this.scrollVelocity = 0;
            this.scrollAccum = 0;
            this.lastScrollTime = 0;
            this.scrollDecay = 0.92;

            // Gesture detection
            this.gestureState = 'idle';
            this.swipeStartX = 0; this.swipeStartY = 0;
            this.swipeStartTime = 0;
            this.isPointerDown = false;

            // Touch state
            this.touches = [];
            this.pinchDist = 0;
            this.lastPinchDist = 0;
            this.pinchDelta = 0;

            // Direction
            this.direction = '‚Äî';
            this.directionVector = { x: 0, y: 0 };

            // Raycast world position
            this.worldPos = new THREE.Vector3();
            this.hasWorldPos = false;

            // Trail particles
            this.trailPoints = [];
            this.maxTrail = 40;

            // Flick detection
            this.flickThreshold = 800; // px/sec
            this.flickCooldown = 0;

            this._bindEvents();
        }

        _bindEvents() {
            const el = renderer.domElement;

            // Mouse
            el.addEventListener('mousemove', (e) => this._onMouseMove(e));
            el.addEventListener('mousedown', (e) => this._onPointerDown(e.clientX, e.clientY));
            el.addEventListener('mouseup', (e) => this._onPointerUp(e.clientX, e.clientY));
            el.addEventListener('mouseleave', () => this._onPointerCancel());
            el.addEventListener('wheel', (e) => this._onWheel(e), { passive: false });

            // Touch
            el.addEventListener('touchstart', (e) => this._onTouchStart(e), { passive: false });
            el.addEventListener('touchmove', (e) => this._onTouchMove(e), { passive: false });
            el.addEventListener('touchend', (e) => this._onTouchEnd(e));
            el.addEventListener('touchcancel', () => this._onPointerCancel());
        }

        _onMouseMove(e) {
            this.prevMouseX = this.mouseX;
            this.prevMouseY = this.mouseY;
            this.mouseX = e.clientX;
            this.mouseY = e.clientY;
            this.ndcX = (e.clientX / window.innerWidth) * 2 - 1;
            this.ndcY = -(e.clientY / window.innerHeight) * 2 + 1;

            const dx = this.mouseX - this.prevMouseX;
            const dy = this.mouseY - this.prevMouseY;
            this.mouseVelX = dx; this.mouseVelY = dy;

            const speed = Math.sqrt(dx * dx + dy * dy);
            this.velHistory.push(speed);
            if (this.velHistory.length > this.maxVelHistory) this.velHistory.shift();
            this.mouseSpeed = this.velHistory.reduce((a, b) => a + b, 0) / this.velHistory.length;

            if (speed > 0.5) {
                this.mouseAngle = Math.atan2(dy, dx);
                this._updateDirection(dx, dy);
            }

            // Trail
            if (cursorOrbEnabled) {
                this.trailPoints.push({ x: this.ndcX, y: this.ndcY, t: Date.now(), speed });
                if (this.trailPoints.length > this.maxTrail) this.trailPoints.shift();
            }

            // Detect gesture
            if (this.isPointerDown && this.mouseSpeed > 5) {
                this.gestureState = 'dragging';
            }
        }

        _onPointerDown(x, y) {
            this.isPointerDown = true;
            this.swipeStartX = x;
            this.swipeStartY = y;
            this.swipeStartTime = Date.now();
            this.gestureState = 'pressing';
        }

        _onPointerUp(x, y) {
            if (this.isPointerDown) {
                const dx = x - this.swipeStartX;
                const dy = y - this.swipeStartY;
                const dist = Math.sqrt(dx * dx + dy * dy);
                const elapsed = Date.now() - this.swipeStartTime;
                const velocity = dist / (elapsed / 1000);

                if (dist > 50 && velocity > this.flickThreshold && this.flickCooldown <= 0) {
                    // FLICK detected!
                    this.gestureState = 'flick';
                    this._updateDirection(dx, dy);
                    this._onFlick(dx, dy, velocity);
                    this.flickCooldown = 500;
                } else if (dist < 10 && elapsed < 300) {
                    this.gestureState = 'tap';
                } else {
                    this.gestureState = 'idle';
                }
            }
            this.isPointerDown = false;
        }

        _onPointerCancel() {
            this.isPointerDown = false;
            this.gestureState = 'idle';
        }

        _onWheel(e) {
            e.preventDefault();
            const now = Date.now();
            const dt = now - this.lastScrollTime;
            this.lastScrollTime = now;

            // Accumulate for velocity sensing
            this.scrollAccum += Math.abs(e.deltaY);
            this.scrollVelocity = Math.abs(e.deltaY) / Math.max(dt, 1) * 100;

            // Fast scroll = flick gesture
            if (this.scrollVelocity > 200 && this.flickCooldown <= 0) {
                this.gestureState = 'scroll-flick';
                this._onScrollFlick(e.deltaY);
                this.flickCooldown = 600;
            } else if (!isFocused) {
                // Normal zoom
                const zoomSpeed = 0.08;
                const dir = camera.position.clone().sub(cameraTarget).normalize();
                camera.position.addScaledVector(dir, e.deltaY * zoomSpeed);
            }
        }

        _onTouchStart(e) {
            e.preventDefault();
            this.touches = [...e.touches];
            if (e.touches.length === 1) {
                const t = e.touches[0];
                this._onPointerDown(t.clientX, t.clientY);
                this.mouseX = t.clientX; this.mouseY = t.clientY;
                this.ndcX = (t.clientX / window.innerWidth) * 2 - 1;
                this.ndcY = -(t.clientY / window.innerHeight) * 2 + 1;
            } else if (e.touches.length === 2) {
                this.pinchDist = this._touchDist(e.touches[0], e.touches[1]);
                this.lastPinchDist = this.pinchDist;
            }
        }

        _onTouchMove(e) {
            e.preventDefault();
            if (e.touches.length === 1) {
                const t = e.touches[0];
                this.prevMouseX = this.mouseX;
                this.prevMouseY = this.mouseY;
                this.mouseX = t.clientX; this.mouseY = t.clientY;
                this.ndcX = (t.clientX / window.innerWidth) * 2 - 1;
                this.ndcY = -(t.clientY / window.innerHeight) * 2 + 1;

                const dx = this.mouseX - this.prevMouseX;
                const dy = this.mouseY - this.prevMouseY;
                this.mouseVelX = dx; this.mouseVelY = dy;
                this.mouseSpeed = Math.sqrt(dx * dx + dy * dy);

                if (this.mouseSpeed > 0.5) {
                    this.mouseAngle = Math.atan2(dy, dx);
                    this._updateDirection(dx, dy);
                }

                // Trail for touch too
                if (cursorOrbEnabled) {
                    this.trailPoints.push({ x: this.ndcX, y: this.ndcY, t: Date.now(), speed: this.mouseSpeed });
                    if (this.trailPoints.length > this.maxTrail) this.trailPoints.shift();
                }

                this.gestureState = 'dragging';

                // Scene rotation (touch drag)
                if (!isFocused) {
                    cameraRotationY -= dx * 0.005;
                    cameraRotationX -= dy * 0.005;
                    cameraRotationX = Math.max(-Math.PI / 3, Math.min(Math.PI / 3, cameraRotationX));
                }
            } else if (e.touches.length === 2) {
                // Pinch zoom
                const dist = this._touchDist(e.touches[0], e.touches[1]);
                this.pinchDelta = dist - this.lastPinchDist;
                this.lastPinchDist = dist;

                if (!isFocused) {
                    const dir = camera.position.clone().sub(cameraTarget).normalize();
                    camera.position.addScaledVector(dir, -this.pinchDelta * 0.05);
                }
                this.gestureState = 'pinching';
            }
        }

        _onTouchEnd(e) {
            if (e.changedTouches.length > 0) {
                const t = e.changedTouches[0];
                this._onPointerUp(t.clientX, t.clientY);
            }
            this.touches = [...e.touches];
        }

        _touchDist(t1, t2) {
            const dx = t1.clientX - t2.clientX;
            const dy = t1.clientY - t2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }

        _updateDirection(dx, dy) {
            const angle = Math.atan2(dy, dx) * (180 / Math.PI);
            this.directionVector = { x: dx, y: dy };
            if (angle > -22.5 && angle <= 22.5) this.direction = '‚Üí';
            else if (angle > 22.5 && angle <= 67.5) this.direction = '‚Üò';
            else if (angle > 67.5 && angle <= 112.5) this.direction = '‚Üì';
            else if (angle > 112.5 && angle <= 157.5) this.direction = '‚Üô';
            else if (angle > 157.5 || angle <= -157.5) this.direction = '‚Üê';
            else if (angle > -157.5 && angle <= -112.5) this.direction = '‚Üñ';
            else if (angle > -112.5 && angle <= -67.5) this.direction = '‚Üë';
            else if (angle > -67.5 && angle <= -22.5) this.direction = '‚Üó';
        }

        _onFlick(dx, dy, velocity) {
            const norm = Math.sqrt(dx * dx + dy * dy);
            const dirX = dx / norm;

            showGestureFeedback(dirX > 0 ? '‚ö° FLICK ‚Üí' : '‚ö° ‚Üê FLICK');

            // Flick sideways = shuffle / draw new cards
            if (Math.abs(dirX) > 0.6) {
                drawCards();
            } else {
                // Vertical flick = camera spin
                const spinAmount = Math.sign(dy) * 0.5;
                cameraRotationX += spinAmount;
                cameraRotationX = Math.max(-Math.PI / 2, Math.min(Math.PI / 3, cameraRotationX));
            }
        }

        _onScrollFlick(deltaY) {
            showGestureFeedback(deltaY > 0 ? 'üåÄ SCROLL BURST ‚Üì' : 'üåÄ SCROLL BURST ‚Üë');
            drawCards();
        }

        update(dt) {
            // Decay
            this.mouseSpeed *= 0.9;
            this.scrollVelocity *= this.scrollDecay;
            this.scrollAccum *= 0.95;
            if (this.flickCooldown > 0) this.flickCooldown -= dt;

            // Raycast to ground plane
            if (camera && raycaster) {
                raycaster.setFromCamera(new THREE.Vector2(this.ndcX, this.ndcY), camera);
                const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);
                const intersection = new THREE.Vector3();
                if (raycaster.ray.intersectPlane(plane, intersection)) {
                    this.worldPos.copy(intersection);
                    this.hasWorldPos = true;
                }
            }

            // Clean old trail points
            const now = Date.now();
            this.trailPoints = this.trailPoints.filter(p => now - p.t < 600);

            // Auto-reset gesture state
            if (!this.isPointerDown && this.gestureState !== 'idle' && this.mouseSpeed < 0.5) {
                this.gestureState = 'idle';
            }
        }
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // 3D CURSOR ORB + TRAIL SYSTEM
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let cursorOrb, cursorOrbEnabled = true, trailsEnabled = true;
    let cursorTrailMesh, cursorTrailGeometry;
    let cursorRing;

    function createCursorOrb() {
        // Main orb
        const orbGeo = new THREE.SphereGeometry(0.15, 16, 16);
        const orbMat = new THREE.MeshBasicMaterial({
            color: 0xffd700, transparent: true, opacity: 0.8
        });
        cursorOrb = new THREE.Mesh(orbGeo, orbMat);
        cursorOrb.renderOrder = 999;
        scene.add(cursorOrb);

        // Outer ring
        const ringGeo = new THREE.RingGeometry(0.25, 0.35, 32);
        const ringMat = new THREE.MeshBasicMaterial({
            color: 0xffd700, transparent: true, opacity: 0.4,
            side: THREE.DoubleSide
        });
        cursorRing = new THREE.Mesh(ringGeo, ringMat);
        cursorRing.renderOrder = 999;
        scene.add(cursorRing);

        // Point light on cursor
        const cursorLight = new THREE.PointLight(0xffd700, 0.6, 4);
        cursorOrb.add(cursorLight);

        // Trail particles (using Points)
        const maxPoints = 60;
        cursorTrailGeometry = new THREE.BufferGeometry();
        const positions = new Float32Array(maxPoints * 3);
        const sizes = new Float32Array(maxPoints);
        const colors = new Float32Array(maxPoints * 3);
        cursorTrailGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        cursorTrailGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
        cursorTrailGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

        const trailMat = new THREE.PointsMaterial({
            size: 0.15, transparent: true, opacity: 0.7,
            vertexColors: true, sizeAttenuation: true,
            blending: THREE.AdditiveBlending, depthWrite: false
        });
        cursorTrailMesh = new THREE.Points(cursorTrailGeometry, trailMat);
        cursorTrailMesh.renderOrder = 998;
        scene.add(cursorTrailMesh);
    }

    function updateCursorOrb(gesture) {
        if (!cursorOrb) return;

        cursorOrb.visible = cursorOrbEnabled;
        cursorRing.visible = cursorOrbEnabled;
        cursorTrailMesh.visible = cursorOrbEnabled && trailsEnabled;

        if (!cursorOrbEnabled) return;

        if (gesture.hasWorldPos) {
            // Smooth follow
            cursorOrb.position.lerp(gesture.worldPos, 0.3);
            cursorOrb.position.y = 0.15;

            cursorRing.position.copy(cursorOrb.position);
            cursorRing.position.y = 0.02;
            cursorRing.rotation.x = -Math.PI / 2;

            // Scale ring based on speed
            const speedScale = 1 + gesture.mouseSpeed * 0.02;
            cursorRing.scale.setScalar(speedScale);
            cursorRing.material.opacity = 0.2 + Math.min(gesture.mouseSpeed * 0.02, 0.5);

            // Rotate ring based on direction
            cursorRing.rotation.z += gesture.mouseSpeed * 0.01;

            // Color shift based on speed
            const speed01 = Math.min(gesture.mouseSpeed / 30, 1);
            const r = 1;
            const g = 0.84 - speed01 * 0.6;
            const b = speed01 * 0.8;
            cursorOrb.material.color.setRGB(r, g, b);
            cursorOrb.children[0].color.setRGB(r, g, b); // light

            // Orb size pulse
            const pulse = 1 + Math.sin(Date.now() * 0.005) * 0.1 + speed01 * 0.3;
            cursorOrb.scale.setScalar(pulse);
        }

        // Update trail
        if (trailsEnabled) {
            const positions = cursorTrailGeometry.attributes.position.array;
            const sizes = cursorTrailGeometry.attributes.size.array;
            const colors = cursorTrailGeometry.attributes.color.array;
            const points = gesture.trailPoints;
            const maxPoints = 60;

            for (let i = 0; i < maxPoints; i++) {
                if (i < points.length) {
                    const p = points[points.length - 1 - i];
                    // Convert NDC back to world approx
                    raycaster.setFromCamera(new THREE.Vector2(p.x, p.y), camera);
                    const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);
                    const inter = new THREE.Vector3();
                    if (raycaster.ray.intersectPlane(plane, inter)) {
                        positions[i * 3] = inter.x;
                        positions[i * 3 + 1] = 0.1;
                        positions[i * 3 + 2] = inter.z;
                    }
                    const age = (Date.now() - p.t) / 600;
                    sizes[i] = Math.max(0, (1 - age) * (0.1 + p.speed * 0.005));
                    const s01 = Math.min(p.speed / 20, 1);
                    colors[i * 3] = 1;
                    colors[i * 3 + 1] = 0.84 - s01 * 0.5;
                    colors[i * 3 + 2] = s01 * 0.9;
                } else {
                    sizes[i] = 0;
                }
            }
            cursorTrailGeometry.attributes.position.needsUpdate = true;
            cursorTrailGeometry.attributes.size.needsUpdate = true;
            cursorTrailGeometry.attributes.color.needsUpdate = true;
        }
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // THREE.JS SETUP
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let scene, camera, renderer;
    let cards = [];
    let viewMode = 'reading';
    let autoPlayEnabled = false;
    let idleTimer = null, countdownInterval = null, countdownValue = 30;
    let currentReading = [];
    let raycaster, mouse;
    let gestureEngine;

    let cameraTarget = new THREE.Vector3(0, 0, 0);
    let cameraPosition = new THREE.Vector3(0, 8, 15);
    let cameraRotationX = 0, cameraRotationY = 0;
    let keys = {};

    let focusedCard = null;
    let originalCameraPosition = new THREE.Vector3();
    let originalCameraTarget = new THREE.Vector3();
    let originalCameraRotationX = 0, originalCameraRotationY = 0;
    let isFocused = false;

    function init() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0015);
        scene.fog = new THREE.Fog(0x0a0015, 25, 60);

        camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.copy(cameraPosition);
        camera.lookAt(cameraTarget);

        renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.getElementById('container').appendChild(renderer.domElement);

        raycaster = new THREE.Raycaster();
        mouse = new THREE.Vector2();

        // Lighting
        scene.add(new THREE.AmbientLight(0x404070, 0.4));

        const frontSpot = new THREE.SpotLight(0xffd700, 1.2);
        frontSpot.position.set(0, 12, 12);
        frontSpot.angle = Math.PI / 6; frontSpot.penumbra = 0.3;
        frontSpot.castShadow = true;
        frontSpot.shadow.mapSize.set(2048, 2048);
        scene.add(frontSpot); scene.add(frontSpot.target);

        const leftSpot = new THREE.SpotLight(0x9966ff, 0.8);
        leftSpot.position.set(-10, 8, 5);
        leftSpot.angle = Math.PI / 5; leftSpot.penumbra = 0.4;
        leftSpot.castShadow = true;
        scene.add(leftSpot); scene.add(leftSpot.target);

        const rightSpot = new THREE.SpotLight(0x00ddff, 0.8);
        rightSpot.position.set(10, 8, 5);
        rightSpot.angle = Math.PI / 5; rightSpot.penumbra = 0.4;
        rightSpot.castShadow = true;
        scene.add(rightSpot); scene.add(rightSpot.target);

        scene.add(new THREE.DirectionalLight(0xffffff, 0.4).translateZ(-15).translateY(5));

        createStarfield();

        // Ground
        const ground = new THREE.Mesh(
            new THREE.CircleGeometry(40, 64),
            new THREE.MeshStandardMaterial({ color: 0x1a0033, roughness: 0.9, metalness: 0.1 })
        );
        ground.rotation.x = -Math.PI / 2; ground.position.y = -4;
        ground.receiveShadow = true;
        scene.add(ground);

        // Sacred circle on ground
        createSacredCircle();

        // Create cursor orb
        createCursorOrb();

        // Init gesture engine (after renderer exists)
        gestureEngine = new GestureEngine();

        // Keyboard
        window.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            if (e.key === ' ') { e.preventDefault(); drawCards(); }
        });
        window.addEventListener('keyup', (e) => { keys[e.key.toLowerCase()] = false; });

        // Mouse drag for rotation (non-gesture)
        let isDragging = false, prevMouse = { x: 0, y: 0 };
        renderer.domElement.addEventListener('mousedown', (e) => {
            isDragging = true;
            prevMouse = { x: e.clientX, y: e.clientY };
        });
        renderer.domElement.addEventListener('mousemove', (e) => {
            if (isDragging && !isFocused) {
                const dx = e.clientX - prevMouse.x;
                const dy = e.clientY - prevMouse.y;
                cameraRotationY -= dx * 0.005;
                cameraRotationX -= dy * 0.005;
                cameraRotationX = Math.max(-Math.PI / 3, Math.min(Math.PI / 3, cameraRotationX));
                prevMouse = { x: e.clientX, y: e.clientY };
            }
        });
        renderer.domElement.addEventListener('mouseup', () => { isDragging = false; });
        renderer.domElement.addEventListener('mouseleave', () => { isDragging = false; });

        // Card click (raycast)
        renderer.domElement.addEventListener('click', onCardClick);

        // Resize
        window.addEventListener('resize', onWindowResize);

        // Idle timer
        resetIdleTimer();
        ['mousemove', 'keydown', 'click', 'touchstart'].forEach(ev => 
            window.addEventListener(ev, resetIdleTimer)
        );

        // Button bindings
        document.getElementById('btn-draw').addEventListener('click', drawCards);
        document.getElementById('btn-view').addEventListener('click', toggleViewMode);
        document.getElementById('btn-auto').addEventListener('click', toggleAutoPlay);
        document.getElementById('btn-reset').addEventListener('click', resetReading);
        document.getElementById('btn-front').addEventListener('click', () => setCameraView('front'));
        document.getElementById('btn-iso').addEventListener('click', () => setCameraView('isometric'));
        document.getElementById('btn-top').addEventListener('click', () => setCameraView('top'));
        document.getElementById('btn-back').addEventListener('click', () => setCameraView('back'));
        document.getElementById('btn-cursor-toggle').addEventListener('click', () => {
            cursorOrbEnabled = !cursorOrbEnabled;
            document.getElementById('btn-cursor-toggle').textContent = cursorOrbEnabled ? 'üëÅÔ∏è Cursor Orb: ON' : 'üëÅÔ∏è Cursor Orb: OFF';
        });
        document.getElementById('btn-trails-toggle').addEventListener('click', () => {
            trailsEnabled = !trailsEnabled;
            document.getElementById('btn-trails-toggle').textContent = trailsEnabled ? '‚ú® Trails: ON' : '‚ú® Trails: OFF';
        });

        animate();
    }

    function createStarfield() {
        const geo = new THREE.BufferGeometry();
        const verts = [];
        for (let i = 0; i < 2000; i++) {
            verts.push((Math.random() - 0.5) * 150, (Math.random() - 0.5) * 150, (Math.random() - 0.5) * 150);
        }
        geo.setAttribute('position', new THREE.Float32BufferAttribute(verts, 3));
        scene.add(new THREE.Points(geo, new THREE.PointsMaterial({
            color: 0xffffff, size: 0.15, transparent: true, opacity: 0.8, sizeAttenuation: true
        })));
    }

    function createSacredCircle() {
        // Glowing circle on ground
        const circleGeo = new THREE.RingGeometry(6, 6.15, 64);
        const circleMat = new THREE.MeshBasicMaterial({
            color: 0xffd700, transparent: true, opacity: 0.15, side: THREE.DoubleSide
        });
        const circle = new THREE.Mesh(circleGeo, circleMat);
        circle.rotation.x = -Math.PI / 2;
        circle.position.y = -3.98;
        scene.add(circle);

        // Inner circle
        const innerGeo = new THREE.RingGeometry(3, 3.1, 64);
        const inner = new THREE.Mesh(innerGeo, circleMat.clone());
        inner.rotation.x = -Math.PI / 2;
        inner.position.y = -3.98;
        scene.add(inner);
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // CARD CREATION (same approach, cleaned up)
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
        const words = text.split(' ');
        let line = '', lines = [];
        for (let n = 0; n < words.length; n++) {
            const test = line + words[n] + ' ';
            if (ctx.measureText(test).width > maxWidth && n > 0) {
                lines.push(line); line = words[n] + ' ';
            } else { line = test; }
        }
        lines.push(line);
        lines.forEach((l, k) => ctx.fillText(l, x, y + k * lineHeight));
        return lines.length * lineHeight;
    }

    function createCard(saintData, position) {
        const group = new THREE.Group();
        const w = 3.5, h = 5.5, d = 0.05;

        const cardMesh = new THREE.Mesh(
            new THREE.BoxGeometry(w, h, d),
            new THREE.MeshStandardMaterial({ color: 0x1a1a2e, roughness: 0.2, metalness: 0.8 })
        );
        cardMesh.castShadow = true; cardMesh.receiveShadow = true;
        group.add(cardMesh);

        const lightColor = getSuitColor(saintData);
        const cardLight = new THREE.PointLight(lightColor, 0.8, 5);
        group.add(cardLight);

        // Front face
        const canvas = document.createElement('canvas');
        canvas.width = 1024; canvas.height = 1536;
        const ctx = canvas.getContext('2d');

        const grad = ctx.createLinearGradient(0, 0, 0, canvas.height);
        grad.addColorStop(0, '#2a0050'); grad.addColorStop(0.5, '#4a0080'); grad.addColorStop(1, '#2a0050');
        ctx.fillStyle = grad; ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.strokeStyle = '#ffd700'; ctx.lineWidth = 12;
        ctx.strokeRect(20, 20, canvas.width - 40, canvas.height - 40);
        ctx.strokeStyle = '#ffed4e'; ctx.lineWidth = 3;
        ctx.strokeRect(35, 35, canvas.width - 70, canvas.height - 70);

        let cy = 90;
        const emojis = saintData.emojis.split(',').map(e => e.trim());
        ctx.font = '60px Arial'; ctx.textAlign = 'left'; ctx.fillText(emojis[0] || '‚ú®', 80, cy);
        ctx.fillStyle = '#ffffff'; ctx.font = 'bold 48px Georgia'; ctx.textAlign = 'center';
        ctx.fillText(saintData.name, canvas.width / 2, cy);
        ctx.font = '60px Arial'; ctx.textAlign = 'right'; ctx.fillText(emojis[1] || '‚ú®', canvas.width - 80, cy);

        cy += 75;
        ctx.fillStyle = '#ffd700'; ctx.font = 'italic 58px Georgia';
        const isMajor = saintData.classifier.includes('Major Arcana');
        ctx.textAlign = isMajor ? 'center' : 'right';
        ctx.fillText(saintData.card, isMajor ? canvas.width / 2 : canvas.width - 80, cy);

        cy += 70;
        ctx.fillStyle = '#ffed4e'; ctx.font = '40px Georgia';
        ctx.fillText(saintData.classifier, isMajor ? canvas.width / 2 : canvas.width - 80, cy);

        cy += 85;
        ctx.fillStyle = '#e0e0ff'; ctx.font = 'bold 50px Georgia'; ctx.textAlign = 'left';
        const storyH = wrapText(ctx, saintData.story, 60, cy, canvas.width - 120, 62);
        cy += storyH + 40;

        ctx.fillStyle = '#aaccff'; ctx.font = 'bold 36px Georgia'; ctx.textAlign = 'center';
        ctx.fillText('‚ú® ' + saintData.virtues, canvas.width / 2, canvas.height - 100);
        ctx.fillStyle = '#8899ff'; ctx.font = '32px Georgia';
        ctx.fillText(saintData.continent, canvas.width / 2, canvas.height - 50);

        const faceGeo = new THREE.PlaneGeometry(w - 0.02, h - 0.02);
        const faceMesh = new THREE.Mesh(faceGeo, new THREE.MeshStandardMaterial({
            map: new THREE.CanvasTexture(canvas), roughness: 0.3, metalness: 0.4
        }));
        faceMesh.position.z = d / 2 + 0.001;
        group.add(faceMesh);

        // Back face
        const bc = document.createElement('canvas');
        bc.width = 1024; bc.height = 1536;
        drawCardBack(bc.getContext('2d'), bc.width, bc.height);
        const backMesh = new THREE.Mesh(faceGeo, new THREE.MeshStandardMaterial({
            map: new THREE.CanvasTexture(bc), roughness: 0.3, metalness: 0.4
        }));
        backMesh.position.z = -d / 2 - 0.001;
        backMesh.rotation.y = Math.PI;
        group.add(backMesh);

        // Glow
        const glow = new THREE.Mesh(
            new THREE.PlaneGeometry(w + 0.3, h + 0.3),
            new THREE.MeshBasicMaterial({ color: 0xffd700, transparent: true, opacity: 0, side: THREE.DoubleSide })
        );
        glow.position.z = d / 2 + 0.002;
        group.add(glow);

        group.position.copy(position);
        group.userData = {
            saintData, revealed: true, glow, cardLight,
            lightAngle: Math.random() * Math.PI * 2, baseY: position.y
        };
        return group;
    }

    function getSuitColor(s) {
        if (s.classifier.includes('Wands')) return 0xff6600;
        if (s.classifier.includes('Cups')) return 0x6699ff;
        if (s.classifier.includes('Swords')) return 0xccccff;
        if (s.classifier.includes('Pentacles')) return 0xffcc00;
        return 0xffd700;
    }

    function drawCardBack(ctx, w, h) {
        const grad = ctx.createRadialGradient(w / 2, h / 2, 0, w / 2, h / 2, w / 2);
        grad.addColorStop(0, '#4a0080'); grad.addColorStop(1, '#1a0033');
        ctx.fillStyle = grad; ctx.fillRect(0, 0, w, h);
        ctx.strokeStyle = '#ffd700'; ctx.lineWidth = 12;
        ctx.strokeRect(20, 20, w - 40, h - 40);
        ctx.save(); ctx.translate(w / 2, h / 2);
        for (let i = 0; i < 12; i++) {
            ctx.save(); ctx.rotate((i * Math.PI * 2) / 12);
            ctx.strokeStyle = 'rgba(255, 215, 0, 0.4)'; ctx.lineWidth = 3;
            ctx.beginPath(); ctx.moveTo(0, 0); ctx.lineTo(0, -h / 3); ctx.stroke();
            ctx.beginPath(); ctx.arc(0, -h / 3, 30, 0, Math.PI * 2); ctx.stroke();
            ctx.restore();
        }
        ctx.restore();
        ctx.fillStyle = '#ffd700'; ctx.font = 'bold 120px Georgia';
        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        ctx.fillText('‚≠ê', w / 2, h / 2);
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // CARD MANAGEMENT
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function drawCards() {
        clearCards();
        if (viewMode === 'reading') {
            const shuffled = [...saints_data].sort(() => Math.random() - 0.5).slice(0, 3);
            const positions = [new THREE.Vector3(-5.5, 0, 0), new THREE.Vector3(0, 0, 0), new THREE.Vector3(5.5, 0, 0)];
            shuffled.forEach((saint, i) => {
                const card = createCard(saint, positions[i]);
                cards.push(card); currentReading.push(saint); scene.add(card);
                card.position.y = 12; card.rotation.x = Math.PI * 2;
                animateCardEntrance(card, positions[i], i * 250);
            });
        } else {
            const cols = 8, spacing = 4.2;
            const rows = Math.ceil(saints_data.length / cols);
            const ox = -(cols - 1) * spacing / 2, oz = -(rows - 1) * spacing / 2;
            saints_data.forEach((saint, idx) => {
                const pos = new THREE.Vector3(ox + (idx % cols) * spacing, 0, oz + Math.floor(idx / cols) * spacing);
                const card = createCard(saint, pos);
                cards.push(card); scene.add(card);
                card.position.y = 18; card.rotation.x = Math.PI * 3;
                animateCardEntrance(card, pos, idx * 30);
            });
        }
    }

    function animateCardEntrance(card, targetPos, delay) {
        setTimeout(() => {
            const startY = card.position.y, startRX = card.rotation.x;
            const start = Date.now(), dur = 1200;
            (function anim() {
                const p = Math.min((Date.now() - start) / dur, 1);
                const e = 1 - Math.pow(1 - p, 3);
                card.position.y = startY + (targetPos.y - startY) * e;
                card.rotation.x = startRX * (1 - e);
                if (p < 1) requestAnimationFrame(anim);
                else card.userData.baseY = targetPos.y;
            })();
        }, delay);
    }

    function clearCards() {
        cards.forEach(c => scene.remove(c)); cards = []; currentReading = [];
        if (isFocused) { isFocused = false; focusedCard = null; }
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // INTERACTION
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function onCardClick(event) {
        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        raycaster.setFromCamera(mouse, camera);
        const hits = raycaster.intersectObjects(cards, true);

        if (hits.length > 0) {
            const card = hits[0].object.parent;
            if (isFocused && focusedCard === card) unfocusCard();
            else if (isFocused) { unfocusCard(); setTimeout(() => focusOnCard(card), 600); }
            else focusOnCard(card);
        } else if (isFocused) unfocusCard();
    }

    function focusOnCard(card) {
        focusedCard = card; isFocused = true;
        originalCameraPosition.copy(cameraPosition);
        originalCameraTarget.copy(cameraTarget);
        originalCameraRotationX = cameraRotationX;
        originalCameraRotationY = cameraRotationY;

        const wp = new THREE.Vector3(); card.getWorldPosition(wp);
        animateCameraTo(new THREE.Vector3(wp.x, wp.y, wp.z + 9), wp, 800);
        highlightCard(card);
    }

    function unfocusCard() {
        if (!isFocused) return;
        animateCameraTo(originalCameraPosition, originalCameraTarget, 800, true);
        focusedCard = null; isFocused = false;
    }

    function animateCameraTo(targetPos, targetLook, dur, restore = false) {
        const sp = camera.position.clone(), sl = cameraTarget.clone();
        const srx = cameraRotationX, sry = cameraRotationY;
        const start = Date.now();
        (function anim() {
            const p = Math.min((Date.now() - start) / dur, 1);
            const e = p < 0.5 ? 2 * p * p : 1 - Math.pow(-2 * p + 2, 2) / 2;
            camera.position.lerpVectors(sp, targetPos, e);
            cameraTarget.lerpVectors(sl, targetLook, e);
            if (restore) {
                cameraRotationX = srx + (originalCameraRotationX - srx) * e;
                cameraRotationY = sry + (originalCameraRotationY - sry) * e;
            } else if (isFocused) {
                cameraRotationX = srx * (1 - e);
                cameraRotationY = sry * (1 - e);
            }
            cameraPosition.copy(targetPos);
            camera.lookAt(cameraTarget);
            if (p < 1) requestAnimationFrame(anim);
        })();
    }

    function highlightCard(card) {
        const start = Date.now(), dur = 400;
        (function anim() {
            const p = Math.min((Date.now() - start) / dur, 1);
            const s = p < 0.5 ? 1 + 0.15 * (p * 2) : 1.15 - 0.15 * ((p - 0.5) * 2);
            card.scale.setScalar(s);
            if (p < 1) requestAnimationFrame(anim); else card.scale.setScalar(1);
        })();
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // UI FUNCTIONS
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function toggleViewMode() {
        viewMode = viewMode === 'reading' ? 'gallery' : 'reading';
        document.getElementById('mode-indicator').textContent = viewMode === 'reading' ? 'üé¥ 3-Card Reading' : 'üìö Full Gallery (80 Saints)';
        document.getElementById('btn-view').textContent = viewMode === 'reading' ? 'üìö Switch to Gallery' : 'üé¥ Switch to Reading';
        if (viewMode === 'gallery') {
            cameraPosition.set(0, 35, 40); cameraRotationX = -0.4; cameraRotationY = 0;
        } else {
            cameraPosition.set(0, 8, 15); cameraRotationX = 0; cameraRotationY = 0;
        }
        drawCards();
    }

    function toggleAutoPlay() {
        autoPlayEnabled = !autoPlayEnabled;
        document.getElementById('btn-auto').textContent = autoPlayEnabled ? '‚è±Ô∏è Auto-Play: ON' : '‚è±Ô∏è Auto-Play: OFF';
        if (!autoPlayEnabled) stopCountdown(); else resetIdleTimer();
    }

    function resetReading() { clearCards(); stopCountdown(); }

    function resetIdleTimer() {
        if (!autoPlayEnabled) return;
        stopCountdown();
        idleTimer = setTimeout(startCountdown, 30000);
    }

    function startCountdown() {
        countdownValue = 30;
        const el = document.getElementById('countdown-timer');
        el.textContent = countdownValue; el.classList.add('active');
        countdownInterval = setInterval(() => {
            countdownValue--;
            el.textContent = countdownValue;
            if (countdownValue <= 0) { stopCountdown(); el.classList.remove('active'); drawCards(); resetIdleTimer(); }
        }, 1000);
    }

    function stopCountdown() {
        if (idleTimer) { clearTimeout(idleTimer); idleTimer = null; }
        if (countdownInterval) { clearInterval(countdownInterval); countdownInterval = null; }
        document.getElementById('countdown-timer').classList.remove('active');
    }

    function showGestureFeedback(text) {
        const el = document.getElementById('gesture-feedback');
        el.textContent = text; el.style.opacity = 1;
        setTimeout(() => { el.style.opacity = 0; }, 800);
    }

    function setCameraView(type) {
        const tp = new THREE.Vector3();
        let trx = 0, try_ = 0;
        const isGallery = viewMode === 'gallery';
        switch (type) {
            case 'front': tp.set(0, isGallery ? 20 : 8, isGallery ? 40 : 15); break;
            case 'isometric': tp.set(isGallery ? 25 : 12, isGallery ? 25 : 12, isGallery ? 25 : 12); trx = -0.3; try_ = -Math.PI / 4; break;
            case 'top': tp.set(0, isGallery ? 45 : 20, 0.1); trx = -Math.PI / 2 + 0.1; break;
            case 'back': tp.set(0, isGallery ? 20 : 8, isGallery ? -40 : -15); try_ = Math.PI; break;
        }
        const sp = cameraPosition.clone(), srx = cameraRotationX, sry = cameraRotationY;
        const start = Date.now(), dur = 1000;
        (function anim() {
            const p = Math.min((Date.now() - start) / dur, 1);
            const e = p < 0.5 ? 2 * p * p : 1 - Math.pow(-2 * p + 2, 2) / 2;
            cameraPosition.lerpVectors(sp, tp, e);
            cameraRotationX = srx + (trx - srx) * e;
            cameraRotationY = sry + (try_ - sry) * e;
            if (p < 1) requestAnimationFrame(anim);
        })();
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // CAMERA & KEYBOARD
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function updateCameraPosition() {
        if (isFocused) { camera.lookAt(cameraTarget); return; }
        const rp = new THREE.Vector3();
        rp.x = cameraPosition.x * Math.cos(cameraRotationY) - cameraPosition.z * Math.sin(cameraRotationY);
        rp.z = cameraPosition.x * Math.sin(cameraRotationY) + cameraPosition.z * Math.cos(cameraRotationY);
        rp.y = cameraPosition.y;
        const dist = Math.sqrt(rp.x * rp.x + rp.z * rp.z);
        rp.y = dist * Math.tan(cameraRotationX) + cameraPosition.y;
        camera.position.copy(rp);
        camera.lookAt(cameraTarget);
    }

    function handleKeyboard() {
        if (keys['escape'] && isFocused) { unfocusCard(); keys['escape'] = false; return; }
        if (isFocused) return;
        const spd = keys['shift'] ? 0.5 : keys['alt'] ? 0.1 : 0.25;
        if (keys['w']) camera.position.addScaledVector(camera.position.clone().sub(cameraTarget).normalize(), -spd);
        if (keys['s']) camera.position.addScaledVector(camera.position.clone().sub(cameraTarget).normalize(), spd);
        if (keys['a']) cameraRotationY += 0.02 * (keys['shift'] ? 2 : 1);
        if (keys['d']) cameraRotationY -= 0.02 * (keys['shift'] ? 2 : 1);
        if (keys['q']) cameraRotationX += 0.02 * (keys['shift'] ? 2 : 1);
        if (keys['e']) cameraRotationX -= 0.02 * (keys['shift'] ? 2 : 1);
        if (keys['z']) { cameraPosition.set(0, 8, 15); cameraRotationX = 0; cameraRotationY = 0; }
        if (keys['x']) { cameraPosition.set(15, 8, 0); cameraRotationX = 0; cameraRotationY = -Math.PI / 2; }
        if (keys['c']) { cameraPosition.set(0, 15, 0); cameraRotationX = -Math.PI / 3; cameraRotationY = 0; }
        cameraRotationX = Math.max(-Math.PI / 2, Math.min(Math.PI / 3, cameraRotationX));
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // HUD UPDATE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function updateHUD(gesture) {
        document.getElementById('hud-velocity').textContent = Math.round(gesture.mouseSpeed);
        document.getElementById('hud-scroll').textContent = Math.round(gesture.scrollVelocity);
        document.getElementById('hud-direction').textContent = gesture.direction;
        document.getElementById('hud-gesture').textContent = gesture.gestureState;
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // HOVER GLOW
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function updateHoverGlow() {
        raycaster.setFromCamera(new THREE.Vector2(gestureEngine.ndcX, gestureEngine.ndcY), camera);
        const hits = raycaster.intersectObjects(cards, true);
        cards.forEach(c => { if (c.userData.glow) c.userData.glow.material.opacity = 0; });
        if (hits.length > 0) {
            const card = hits[0].object.parent;
            if (card.userData.glow) card.userData.glow.material.opacity = 0.4;
            document.body.style.cursor = 'pointer';
        } else {
            document.body.style.cursor = 'default';
        }
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // MAIN LOOP
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let lastTime = Date.now();
    function animate() {
        requestAnimationFrame(animate);
        const now = Date.now();
        const dt = now - lastTime;
        lastTime = now;

        handleKeyboard();
        updateCameraPosition();

        // Gesture engine update
        gestureEngine.update(dt);

        // Cursor orb
        updateCursorOrb(gestureEngine);

        // Hover glow
        updateHoverGlow();

        // Card animations
        const time = now * 0.001;
        cards.forEach((card, i) => {
            if (card.userData.cardLight) {
                card.userData.lightAngle += 0.005;
                const r = 1.5;
                card.userData.cardLight.position.set(
                    Math.cos(card.userData.lightAngle) * r,
                    Math.sin(card.userData.lightAngle * 1.3) * 0.5,
                    Math.sin(card.userData.lightAngle) * r
                );
            }
            const by = card.userData.baseY || 0;
            card.position.y = by + Math.sin(time * 0.5 + i * 0.3) * 0.08;
        });

        // HUD (throttled)
        if (now % 3 < 2) updateHUD(gestureEngine);

        renderer.render(scene, camera);
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    }

    // GO
    init();
    </script>
</body>
</html>
