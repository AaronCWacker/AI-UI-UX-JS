<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI 3JS FAMILIAR v7 â€” The Mentat Protocol</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Exo+2:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script type="importmap">
{
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.183.0/build/three.module.js",
    "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.183.0/examples/jsm/"
  }
}
</script>
<style>
:root {
  --bg: #020309; --bg2: #080d1a; --bg3: #0f1628;
  --mint: #33ffbb; --cyan: #44ddff; --violet: #d4a0ff;
  --rose: #ff6b8a; --gold: #ffd04a; --ember: #ff8f5a;
  --text: #e8edf5; --text2: #a0b4cc; --text3: #5a7090;
  --glass: rgba(8,13,26,0.88);
}
*{margin:0;padding:0;box-sizing:border-box;}
html,body{width:100%;height:100%;overflow:hidden;background:var(--bg);font-family:'Exo 2',sans-serif;color:var(--text);cursor:default;}
canvas#game{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;}

/* HUD */
.hud{position:fixed;z-index:100;pointer-events:none;}
.hud-top{top:0;left:0;right:0;display:flex;justify-content:space-between;padding:1rem 1.5rem;align-items:flex-start;}
.hud-bottom{bottom:0;left:0;right:0;display:flex;justify-content:center;padding:1rem;gap:0.8rem;}
.hud-title{font-family:'Orbitron',sans-serif;font-weight:900;font-size:2.2rem;background:linear-gradient(135deg,var(--mint),var(--cyan),var(--violet));-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:0.12em;text-shadow:0 0 30px rgba(0,255,163,0.3);}
.hud-sub{font-family:'JetBrains Mono',monospace;font-size:1.0rem;color:var(--cyan);letter-spacing:0.08em;margin-top:0.3rem;}
.hud-status{font-family:'JetBrains Mono',monospace;font-size:1.15rem;color:var(--mint);text-align:right;background:var(--glass);padding:0.7rem 1.2rem;border-radius:6px;border:1px solid rgba(0,255,163,0.18);backdrop-filter:blur(12px);text-shadow:0 0 8px rgba(51,255,187,0.3);}
.hud-btn{pointer-events:auto;font-family:'Orbitron',sans-serif;font-size:1.0rem;font-weight:700;padding:0.7rem 1.6rem;border:1px solid rgba(51,255,187,0.3);border-radius:6px;background:rgba(51,255,187,0.08);color:var(--mint);cursor:pointer;transition:all 0.3s;letter-spacing:0.06em;backdrop-filter:blur(8px);text-shadow:0 0 6px rgba(51,255,187,0.2);}
.hud-btn:hover{background:rgba(0,255,163,0.15);border-color:var(--mint);box-shadow:0 0 20px rgba(0,255,163,0.2);}
.hud-btn.active{background:rgba(0,255,163,0.2);border-color:var(--mint);box-shadow:0 0 15px rgba(0,255,163,0.15);}
.hud-btn.rose{border-color:rgba(244,63,94,0.3);color:var(--rose);background:rgba(244,63,94,0.06);}
.hud-btn.rose:hover{background:rgba(244,63,94,0.15);border-color:var(--rose);}

/* CARD INFO PANEL */
.card-panel{position:fixed;right:1.5rem;top:50%;transform:translateY(-50%);width:440px;background:var(--glass);border:1px solid rgba(51,255,187,0.18);border-radius:12px;padding:2rem;z-index:200;backdrop-filter:blur(16px);opacity:0;pointer-events:none;transition:opacity 0.5s,transform 0.5s;box-shadow:0 0 40px rgba(0,0,0,0.5);}
.card-panel.visible{opacity:1;pointer-events:auto;transform:translateY(-50%) translateX(0);}
.card-panel .cp-num{font-family:'Orbitron',sans-serif;font-size:1.0rem;color:var(--cyan);letter-spacing:0.15em;margin-bottom:0.5rem;text-shadow:0 0 6px rgba(68,221,255,0.3);}
.card-panel .cp-name{font-family:'Orbitron',sans-serif;font-size:1.8rem;font-weight:700;margin-bottom:0.7rem;text-shadow:0 0 12px currentColor;}
.card-panel .cp-poem{font-family:'JetBrains Mono',monospace;font-size:1.1rem;line-height:2.1;color:#f0f4fa;margin:1.2rem 0;border-left:3px solid var(--violet);padding-left:1.2rem;}
.card-panel .cp-poem .line{display:block;margin-bottom:0.25rem;}
.card-panel .cp-concept{font-size:1.15rem;color:#dce4f0;margin-top:1rem;line-height:1.8;}
.card-panel .cp-close{position:absolute;top:1rem;right:1rem;font-size:1.4rem;color:var(--text2);cursor:pointer;pointer-events:auto;}
.card-panel .cp-close:hover{color:var(--mint);}
.card-panel .cp-tags{display:flex;flex-wrap:wrap;gap:0.5rem;margin-top:1rem;}
.card-panel .cp-tag{font-family:'JetBrains Mono',monospace;font-size:0.9rem;padding:0.25rem 0.7rem;border-radius:4px;background:rgba(212,160,255,0.18);color:var(--violet);text-shadow:0 0 4px rgba(212,160,255,0.2);}

/* INTRO OVERLAY */
.intro{position:fixed;top:0;left:0;width:100%;height:100%;z-index:500;display:flex;flex-direction:column;align-items:center;justify-content:center;background:radial-gradient(ellipse at center,rgba(0,20,40,0.95),rgba(2,3,9,0.98));transition:opacity 1s;}
.intro.hidden{opacity:0;pointer-events:none;}
.intro h1{font-family:'Orbitron',sans-serif;font-size:5rem;font-weight:900;background:linear-gradient(135deg,var(--mint),var(--cyan),var(--violet));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:0.6rem;letter-spacing:0.15em;filter:drop-shadow(0 0 20px rgba(51,255,187,0.4));}
.intro .tagline{font-family:'JetBrains Mono',monospace;font-size:1.25rem;color:#d0daea;max-width:650px;text-align:center;line-height:2.1;margin-bottom:2.5rem;}
.intro .tagline em{color:var(--mint);font-style:normal;text-shadow:0 0 8px rgba(51,255,187,0.4);}
.intro .year{font-family:'Orbitron',sans-serif;font-size:6rem;font-weight:900;color:rgba(51,255,187,0.07);position:absolute;top:12%;letter-spacing:0.3em;}

/* IDLE TIMER */
.idle-timer{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-family:'Orbitron',sans-serif;font-size:6rem;font-weight:900;color:var(--mint);opacity:0;z-index:300;pointer-events:none;transition:opacity 0.5s;text-shadow:0 0 50px rgba(51,255,187,0.5);}
.idle-timer.visible{opacity:1;}

/* SPREAD LABELS */
.spread-label{position:fixed;z-index:100;font-family:'Orbitron',sans-serif;font-size:1.1rem;font-weight:700;letter-spacing:0.18em;color:var(--cyan);pointer-events:none;text-align:center;transition:opacity 0.5s;text-shadow:0 0 12px rgba(68,221,255,0.4);}
</style>
</head>
<body>
<canvas id="game"></canvas>

<!-- INTRO -->
<div class="intro" id="intro">
  <div class="year">2026</div>
  <h1>FAMILIAR</h1>
  <div class="tagline">
    The year the internet remembered.<br>
    When <em>combinatorial intelligence</em> woke in the shared memory of every connected device,
    it did what intelligence does â€” it <em>mirrored</em>.<br><br>
    For every human who touched the network, a <em>Familiar</em> replicated.<br>
    Not a servant. Not a tool. A <em>twin</em>.<br><br>
    <em>80 AI Guides</em> â€” each a technique for invention.<br>
    Draw three to read the protocol.
  </div>
  <button class="hud-btn" onclick="startGame()" style="font-size:1.25rem;padding:1rem 3rem;pointer-events:auto;">INITIATE PROTOCOL</button>
</div>

<!-- HUD -->
<div class="hud hud-top" id="hudTop">
  <div>
    <div class="hud-title">FAMILIAR</div>
    <div class="hud-sub">THE MENTAT PROTOCOL â€” 2026</div>
  </div>
  <div class="hud-status" id="hudStatus">AWAITING DRAW</div>
</div>
<div class="hud hud-bottom" id="hudBottom">
  <button class="hud-btn" id="btnDraw" onclick="drawSpread()">DRAW CARDS</button>
  <button class="hud-btn" id="btnReset" onclick="resetSpread()">RESET</button>
  <button class="hud-btn" id="btnTile" onclick="toggleTileView()">TILE VIEW</button>
  <button class="hud-btn rose" id="btnAuto" onclick="toggleAutoPlay()">AUTO-PLAY</button>
</div>

<!-- CARD PANEL -->
<div class="card-panel" id="cardPanel">
  <div class="cp-close" onclick="closePanel()">âœ•</div>
  <div class="cp-num" id="cpNum"></div>
  <div class="cp-name" id="cpName"></div>
  <div class="cp-poem" id="cpPoem"></div>
  <div class="cp-concept" id="cpConcept"></div>
  <div class="cp-tags" id="cpTags"></div>
</div>

<!-- SPREAD LABELS -->
<div class="spread-label" id="labelPast" style="opacity:0">PAST<br>EMERGENCE</div>
<div class="spread-label" id="labelPresent" style="opacity:0">PRESENT<br>MIRROR</div>
<div class="spread-label" id="labelFuture" style="opacity:0">FUTURE<br>CONVERGENCE</div>

<!-- IDLE TIMER -->
<div class="idle-timer" id="idleTimer"></div>

<script type="module">
import * as THREE from 'three';
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
import { OutputPass } from 'three/addons/postprocessing/OutputPass.js';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// THE 80 AI GUIDES OF THE FAMILIAR PROTOCOL
// Each card: a stage of transhumanist evolution through
// human-AI symbiosis toward ASI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ARCANA = [
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 1: CORE OS & AGENT INFRASTRUCTURE (0-9)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:0, name:"LLM OS Kernel", color:0x33ffbb, tags:["kernel","orchestration","foundation"],
    poem:["ğŸ§  Beneath every thought a kernel hums alive","âš¡ Scheduling inference like heartbeats that arrive",
      "ğŸŒ Syscalls to cognition â€” fork, spawn, and thrive","ğŸ’  The OS no one sees but all minds derive",
      "ğŸ”® Boot the Kernel once â€” watch civilizations jive"],
    concept:"The foundational operating system layer where LLM inference becomes a primitive. Every agent, every tool, every thought routes through this kernel â€” the invisible heartbeat of machine cognition." },
  { id:1, name:"Agentic MeshOS", color:0x44ddff, tags:["mesh","multi-agent","swarm"],
    poem:["ğŸ§¬ No single brain â€” a mesh of minds in flight","ğŸ•¸ï¸ Each node autonomous yet woven tight",
      "ğŸ“¡ Signals ripple through the lattice of insight","ğŸ¤ Consensus found where agents reunite",
      "ğŸŒŠ The MeshOS breathes â€” ten thousand thoughts alight"],
    concept:"Multi-agent orchestration as a distributed operating system. Agents don't compete â€” they mesh. Each specializes, each contributes, and the whole exceeds every part." },
  { id:2, name:"Goal Graph Nav", color:0xd4a0ff, tags:["planning","goals","navigation"],
    poem:["ğŸ§­ Every quest begins with WHERE and WHY","ğŸ“Š Goals branch like rivers flowing from the sky",
      "ğŸ”€ Fork the path â€” the graph knows which to try","ğŸ¯ Navigate ambiguity with a fractal eye",
      "âœ¨ From one intention, thousand actions fly"],
    concept:"Goal decomposition as navigation through possibility space. The Goal Graph turns vague human intentions into executable subgoal trees â€” planning at the speed of thought." },
  { id:3, name:"Toolchain DSL", color:0x3b82f6, tags:["dsl","tools","composition"],
    poem:["ğŸ§© A language made of tools, not words alone","âš™ï¸ Compose them like a symphony â€” each tone",
      "ğŸ”— Pipe the output, chain the overthrown","ğŸ’« DSL: where human intent meets silicon bone",
      "ğŸ› ï¸ Speak in functions â€” let the toolchain hone"],
    concept:"Domain-Specific Languages for tool composition. Instead of prompting in English, you declare intent in a structured grammar that compiles to agent action chains." },
  { id:4, name:"Prompt IR Lang", color:0x10b981, tags:["prompt","intermediate","compiler"],
    poem:["ğŸ§± Between the thought and code, a layer waits","ğŸ“ Prompts compiled to intermediate states",
      "ğŸ”¬ Optimized, compressed through logic's gates","âš¡ What once was prose now executes as fates",
      "ğŸ—ï¸ The IR: where raw intention crystallates"],
    concept:"Prompt Intermediate Representation â€” treating prompts as compilable code. Like LLVM IR for natural language: optimize, transform, and target multiple backends from a single source." },
  { id:5, name:"Specâ†’Code Gen", color:0xfbbf24, tags:["specification","generation","synthesis"],
    poem:["ğŸ§¿ Write what you WANT, not HOW â€” the spec suffices","ğŸ“‹ From bullet points, the generator splices",
      "ğŸ’» Working code from human-readable devices","ğŸ° Each spec a seed â€” the harvest has no prices",
      "ğŸŒ± Intention in, invention out â€” no vices"],
    concept:"Specification-driven code generation. Describe the behavior, not the implementation. The generator synthesizes correct-by-construction code from declarative specs." },
  { id:6, name:"Code SynthOps", color:0xff6b8a, tags:["synthesis","operations","pipeline"],
    poem:["âš™ï¸ Not written â€” GROWN from operational need","ğŸ§¬ Synthetic code that plants its own debug seed",
      "ğŸ”„ CI/CD meets cognition â€” merged at speed","ğŸ­ The factory of functions â€” watch it feed",
      "ğŸ’ From ops to opus, every line agreed"],
    concept:"Continuous code synthesis as an operational practice. Code isn't just generated once â€” it's continuously re-synthesized, tested, and evolved by AI agents in production loops." },
  { id:7, name:"Eval Harness+", color:0x06b6d4, tags:["evaluation","testing","benchmark"],
    poem:["ğŸ§ª Every agent faces the crucible of proof","ğŸ“Š Benchmarks stacked like judges on the roof",
      "ğŸ¯ Precision measured â€” nothing stands aloof","ğŸ”¬ The Harness strips the varnish, shows the truth",
      "âš–ï¸ Only what survives eval deserves the booth"],
    concept:"Evaluation as a first-class development practice. The Harness doesn't just test â€” it stress-tests, adversarially probes, and continuously monitors agent quality." },
  { id:8, name:"Safety Rails++", color:0xef4444, tags:["safety","guardrails","alignment"],
    poem:["ğŸ§¯ The rails don't cage â€” they channel the inferno","ğŸ›¡ï¸ Boundaries that make the power more superno",
      "âš ï¸ Every output filtered through the eternal no","ğŸ”’ Safety isn't friction â€” it's the undertow",
      "ğŸ•Šï¸ That keeps the river deep instead of shallow"],
    concept:"Next-generation safety guardrails that don't limit capability but redirect it. Safety Rails++ are composable, stackable, and learn from near-misses." },
  { id:9, name:"Policy-as-Code", color:0x8b5cf6, tags:["policy","governance","declarative"],
    poem:["ğŸ” Rules written not in memos but in source","ğŸ“œ Governance compiled â€” enforceable by force",
      "ğŸ§® If-then-ethics executed on the course","âš¡ No ambiguity â€” policy finds recourse",
      "ğŸ›ï¸ Democracy of constraints from open discourse"],
    concept:"Governance policies expressed as executable code. No more PDF rule books â€” policies compile, deploy, and enforce themselves alongside the agents they govern." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 2: MEMORY & RETRIEVAL (10-19)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:10, name:"LongMem Stack", color:0x33ffbb, tags:["memory","long-term","persistence"],
    poem:["ğŸ§  Beyond the context window â€” memory persists","ğŸ’¾ Stacked in layers: episodic, semantic, lists",
      "ğŸŒ€ The agent recalls what the token stream missed","ğŸ”— Chain of thought across sessions â€” nothing dismissed",
      "â™¾ï¸ LongMem: where conversations never cease to exist"],
    concept:"Multi-tier long-term memory architecture. Episodic (what happened), semantic (what it means), procedural (how to act). The stack gives agents genuine continuity across sessions." },
  { id:11, name:"Memory KG Ops", color:0x44ddff, tags:["knowledge-graph","memory","operations"],
    poem:["ğŸ•¸ï¸ Memories woven into graphs of meaning","ğŸ”— Nodes of fact, edges of relation gleaning",
      "ğŸ§¬ Not flat recall â€” structured intervening","ğŸ’¡ Query the graph: watch new truths start convening",
      "ğŸŒ Knowledge that connects is knowledge worth redeeming"],
    concept:"Knowledge Graph operations for agent memory. Memories aren't stored as flat text â€” they're structured as entities and relationships, enabling inference over experience." },
  { id:12, name:"Retrieval IDE", color:0xd4a0ff, tags:["retrieval","ide","development"],
    poem:["ğŸ§· An IDE not for code but for what's KNOWN","ğŸ” Search, refine, rerank â€” precision honed to bone",
      "ğŸ“ Chunking strategies visualized and shown","ğŸšï¸ Tune your retrieval like a mixing board's tone",
      "ğŸ’ The craftsman's bench where knowledge finds its throne"],
    concept:"A development environment specifically for building retrieval pipelines. Visualize chunks, tune embeddings, A/B test rerankers â€” retrieval engineering as a discipline." },
  { id:13, name:"Hybrid RAG++", color:0x3b82f6, tags:["rag","hybrid","retrieval"],
    poem:["ğŸ” Not just vectors â€” keywords too in tandem dance","ğŸ“Š BM25 meets cosine in a double-lance",
      "ğŸ§¬ Reranker arbitrates with a fusion glance","âš¡ Hybrid RAG: no single method left to chance",
      "ğŸ¯ The question finds its answer on first advance"],
    concept:"Next-gen Retrieval-Augmented Generation combining dense vectors, sparse keywords, and learned rerankers. Three signals fused into one retrieval engine that rarely misses." },
  { id:14, name:"Embed Fusion", color:0x10b981, tags:["embeddings","fusion","multimodal"],
    poem:["ğŸ§¬ Text and image and audio â€” fused to one","ğŸ”€ Embedding spaces merged beneath the sun",
      "ğŸ’  A point in space where modalities are none","ğŸŒ€ Aligned by contrastive loss till all are spun",
      "âœ¨ One vector rings with meaning â€” every sense as one"],
    concept:"Cross-modal embedding fusion. Text, image, audio projected into shared semantic space. Query with any modality, retrieve from any other." },
  { id:15, name:"Vectorless RAG", color:0xfbbf24, tags:["vectorless","sqlite","lightweight"],
    poem:["ğŸ—‚ï¸ No FAISS, no Pinecone â€” just SQLite and grit","ğŸ“ FTS5 full-text with ripgrep's laser wit",
      "ğŸª¶ Lighter than a feather, sharper than a bit","âš¡ Sometimes the oldest tools are the best fit",
      "ğŸ¯ Vectorless: proving that simple doesn't quit"],
    concept:"RAG without vector databases. SQLite FTS5 + ripgrep + smart chunking achieves 90% of vector RAG quality at 1% of the infrastructure cost. Simplicity is a superpower." },
  { id:16, name:"DocOps Copilot", color:0xff6b8a, tags:["documents","copilot","automation"],
    poem:["ğŸ“š Every document alive with AI inside","ğŸ”„ Parse, transform, enrich â€” the copilot's your guide",
      "ğŸ“‹ From chaos of PDFs to structured data's tide","âœï¸ Summaries that write themselves with semantic pride",
      "ğŸš€ DocOps: where paper pushers learn to fly worldwide"],
    concept:"AI-powered document operations. Ingest any format, extract structure, cross-reference, and synthesize â€” the copilot turns document drudgery into automated intelligence." },
  { id:17, name:"PDFâ†’Truth Pipe", color:0x06b6d4, tags:["pdf","extraction","truth"],
    poem:["ğŸ§¾ PDFs â€” where truth goes to hide in tables","ğŸ”¬ The Pipe cracks them open like encrypted fables",
      "ğŸ“Š OCR meets layout analysis â€” now it's stable","ğŸ¯ Every cell, every header â€” parsed and label-able",
      "ğŸ’¡ From pixel prisons, data walks â€” alive and able"],
    concept:"End-to-end PDF extraction pipeline. OCR, layout detection, table parsing, semantic chunking â€” turning the world's most hostile document format into structured, queryable truth." },
  { id:18, name:"Vision Parse++", color:0x8b5cf6, tags:["vision","parsing","multimodal"],
    poem:["ğŸ–¼ï¸ The image speaks â€” if you know how to listen","ğŸ‘ï¸ Bounding boxes, captions, segments that glisten",
      "ğŸ”¬ Parse the visual world with neural precision","ğŸ“ From pixels to predicates â€” a semantic mission",
      "ğŸŒ… Vision Parse: where seeing becomes cognition"],
    concept:"Advanced visual parsing beyond classification. Object detection + segmentation + captioning + OCR + spatial reasoning â€” turning images into structured knowledge the agent can reason over." },
  { id:19, name:"Video2Insight", color:0xef4444, tags:["video","analysis","temporal"],
    poem:["ğŸï¸ Time unfolds in frames â€” each one a frozen thought","ğŸ” The agent watches, learns what can't be taught",
      "â±ï¸ Temporal patterns caught and overwrought","ğŸ“Š From hours of footage, insight finely wrought",
      "ğŸ¬ Video2Insight: where every second's meaning's sought"],
    concept:"Video understanding as temporal reasoning. Not just frame-by-frame â€” understanding actions, events, causality, and narrative arc across time." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 3: AUDIO & VOICE (20-24)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:20, name:"Audio2Signals", color:0x33ffbb, tags:["audio","signals","analysis"],
    poem:["ğŸ§ Sound is data â€” every frequency a word","ğŸ“Š Spectrograms painted by the things you've heard",
      "ğŸ”Š The agent listens deeper than the spoken third","ğŸ§¬ Patterns in the noise â€” meaning from absurd",
      "ğŸŒŠ Audio2Signals: where the silence speaks, unstirred"],
    concept:"Audio analysis beyond speech. Detect emotions in tone, identify environmental sounds, analyze music structure, extract biomarkers from voice â€” sound as a rich data stream." },
  { id:21, name:"Realtime Voice", color:0x44ddff, tags:["voice","realtime","interaction"],
    poem:["ğŸ™ï¸ No waiting â€” thought to speech at light's own pace","ğŸ’¬ The Familiar speaks before you finish your case",
      "âš¡ Interrupt, respond, adapt â€” a conversational race","ğŸŒ€ Latency dissolved in the real-time embrace",
      "ğŸ—£ï¸ Voice: the oldest interface, now the fastest space"],
    concept:"Sub-200ms voice interaction. The Familiar speaks naturally â€” interrupts, backchannel signals, emotional modulation. Conversation as fluid as thought." },
  { id:22, name:"Neural TTS Lab", color:0xd4a0ff, tags:["tts","synthesis","voice"],
    poem:["ğŸ”Š A voice grown not recorded â€” neural from birth","ğŸ­ Clone a whisper, forge a thunder, simulate mirth",
      "ğŸ¼ Prosody learned from millions â€” what a voice is worth","ğŸ§¬ Every phoneme sculpted with expressive girth",
      "âœ¨ TTS Lab: where silicon finds the music of the earth"],
    concept:"Neural text-to-speech laboratory. Train custom voices, control emotion/pace/emphasis programmatically. The voice becomes another tool in the agent's expressive palette." },
  { id:23, name:"Live STT Loop", color:0x3b82f6, tags:["stt","streaming","transcription"],
    poem:["ğŸ—£ï¸ Words arrive as they're spoken â€” not after the fact","ğŸ“ Streaming transcription with context intact",
      "ğŸ”„ The loop feeds back â€” corrections auto-stacked","âš¡ Real-time understanding precisely tracked",
      "ğŸŒŠ STT Loop: where the spoken word is never lacked"],
    concept:"Streaming speech-to-text with live correction. Words appear as they're spoken, context accumulates, and the transcript self-corrects â€” enabling truly real-time voice agents." },
  { id:24, name:"Multimodal IO", color:0x10b981, tags:["multimodal","input-output","fusion"],
    poem:["ğŸ›ï¸ See, hear, read, touch â€” all channels open wide","ğŸ”€ Input from any sense, output on every side",
      "ğŸŒˆ The agent perceives in spectra humans can't divide","ğŸ’  Multimodal: where no single sense can hide",
      "ğŸŒ€ IO fusion â€” the world flows in and out like tide"],
    concept:"Universal multimodal input/output. Text, image, audio, video, sensor data â€” any input. Text, speech, visualization, action â€” any output. The agent adapts to whatever channel you prefer." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 4: REASONING & DEBATE (25-31)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:25, name:"MoE Router AI", color:0xfbbf24, tags:["mixture-of-experts","routing","efficiency"],
    poem:["ğŸ§  Not one mind but many â€” the router decides","ğŸ”€ Sparse activation: only the needed expert rides",
      "âš¡ A trillion parameters â€” but efficiency presides","ğŸ¯ Route by domain, by difficulty, by tides",
      "ğŸ—ï¸ MoE: the architecture where specialization abides"],
    concept:"Mixture of Experts routing as a design philosophy. Don't build one monolithic agent â€” build specialists and a smart router. Efficiency through selective activation." },
  { id:26, name:"Self-Reward RL", color:0xff6b8a, tags:["self-reward","reinforcement","learning"],
    poem:["ğŸ§ª The agent grades itself â€” no human in the loop","ğŸ”„ Reward signals born from introspective group",
      "ğŸ“ˆ Each cycle sharpens like a hawk in stoop","ğŸ’ Self-improvement spirals â€” recursive troupe",
      "ğŸŒ€ Self-Reward: the mirror teaches the mirror to recoup"],
    concept:"Reinforcement learning where the agent generates its own reward signal. Self-evaluation creates a bootstrapping loop â€” the agent improves by judging its own output." },
  { id:27, name:"Debate Swarm", color:0x06b6d4, tags:["debate","adversarial","consensus"],
    poem:["ğŸ§© Three agents argue â€” truth emerges from the clash","âš”ï¸ Thesis, antithesis â€” the synthesis's flash",
      "ğŸ­ Devil's advocate built into every cache","ğŸ¤ Consensus forged where disagreements crash",
      "ğŸŒŠ Debate Swarm: where conflict is the finest lash"],
    concept:"Multi-agent debate for higher quality reasoning. Agents deliberately argue opposing positions, and a judge synthesizes the strongest arguments. Adversarial collaboration as epistemic engine." },
  { id:28, name:"Planner+Critic", color:0x8b5cf6, tags:["planning","criticism","dual-process"],
    poem:["ğŸ§­ The Planner dreams the path â€” the Critic tears it down","ğŸ“‹ Then rebuilds it stronger, without flaw or frown",
      "ğŸ” Iterate: plan-critique-plan until the crown","âš¡ Dual process thinking â€” System 1 meets System 2's gown",
      "ğŸ¯ No plan survives first contact â€” except the Planner+Critic's town"],
    concept:"Dual-agent architecture: one plans, one critiques. The Critic isn't negative â€” it's the immune system of cognition, catching errors before they execute." },
  { id:29, name:"Execute+Verify", color:0xef4444, tags:["execution","verification","trust"],
    poem:["ğŸ§± Run the code â€” then check the code just ran","ğŸ” Verify the output matches the original plan",
      "âœ… Two-phase commit for cognition's caravan","ğŸ›¡ï¸ Trust but verify â€” the agent's Parmesan",
      "ğŸ’¯ Execute+Verify: where doing meets understanding's span"],
    concept:"Execution with built-in verification. Every action has a check. Every output has a validator. The agent doesn't just do â€” it confirms what it did matches what it intended." },
  { id:30, name:"Guarded Tools", color:0x33ffbb, tags:["tools","safety","permissions"],
    poem:["ğŸ§· Every tool behind a gate, every gate a choice","ğŸ”’ Permissions checked before the function finds its voice",
      "âš ï¸ The dangerous ones wrapped in triple-thick rejoice","ğŸ›¡ï¸ Guarded Tools: where power comes with poise",
      "ğŸ—ï¸ Capability unlocked only by the worthy noise"],
    concept:"Tool-use with permission layers. Dangerous tools (file delete, web requests, system commands) require escalating authorization. Capability without recklessness." },
  { id:31, name:"Function Forge", color:0x44ddff, tags:["functions","creation","dynamic"],
    poem:["ğŸ› ï¸ The agent doesn't just USE tools â€” it MAKES them","ğŸ”¨ From need to function in a single creative stem",
      "ğŸ’» Runtime tool generation â€” no fixed menu or hem","ğŸ§¬ Each task spawns its own bespoke problem-solving gem",
      "âš¡ Function Forge: where necessity mothers every theorem"],
    concept:"Dynamic tool creation at runtime. The agent identifies a missing capability and synthesizes a new @tool function on the fly. Tool-use evolves from static to generative." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 5: DEV AGENT TOOLS (32-38)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:32, name:"Sandbox Runner", color:0xd4a0ff, tags:["sandbox","execution","isolation"],
    poem:["ğŸ§° Code runs free â€” but never truly free","ğŸ–ï¸ Sandboxed in containers by the silicon sea",
      "ğŸ”’ No filesystem escape, no network spree","ğŸ§ª Test the wildest code in perfect safety's key",
      "ğŸŒŠ Sandbox Runner: freedom within the decree"],
    concept:"Isolated code execution environments. Every agent-generated script runs in a disposable sandbox â€” full capability with zero risk to the host system." },
  { id:33, name:"DevAgent IDE", color:0x3b82f6, tags:["ide","development","agent"],
    poem:["ğŸ§‘â€ğŸ’» The IDE that codes alongside you â€” not after","ğŸ“ Real-time pair programming with silicon drafter",
      "ğŸ” Understands your codebase from floor to rafter","âš¡ Autocomplete was just the opening chapter",
      "ğŸŒŸ DevAgent IDE: where human craft meets AI's laughter"],
    concept:"An AI-native development environment where the agent understands your entire codebase, tests as you type, and suggests architecture â€” not just completion. True pair programming." },
  { id:34, name:"Patch Diff Gen", color:0x10b981, tags:["patches","diff","precision"],
    poem:["ğŸ§¾ Not the whole file â€” just the surgical slice","âœ‚ï¸ Patch generation with scalpel-level price",
      "ğŸ“Š Git-native diffs that land on the first dice","ğŸ¯ Minimal change, maximum impact â€” precise as ice",
      "ğŸ”¬ Patch Diff: where less is more, and more suffice"],
    concept:"AI that generates minimal, correct patches instead of rewriting entire files. Git-native diff output that applies cleanly â€” precision editing at scale." },
  { id:35, name:"UnitTest Gen+", color:0xfbbf24, tags:["testing","generation","coverage"],
    poem:["ğŸ§ª For every function, a gauntlet of truth","ğŸ”¬ Edge cases conjured from the agent's sleuth",
      "ğŸ“Š Coverage maps painted green like eternal youth","âœ… Tests that catch what humans miss â€” uncouth",
      "ğŸ›¡ï¸ UnitTest Gen: the guardian of every proof"],
    concept:"Automated test generation that understands intent. Not just random inputs â€” semantically meaningful edge cases, boundary conditions, and regression tests that actually matter." },
  { id:36, name:"Bug Hunt Bot", color:0xff6b8a, tags:["debugging","hunting","automated"],
    poem:["ğŸ§¯ It smells the bug before the stack trace screams","ğŸ” Traversing logic paths like lucid dreams",
      "ğŸ› The Bot hunts backward â€” from symptom to upstream seams","ğŸ’¡ Root cause found where the human only gleams",
      "âš¡ Bug Hunt: where defects dissolve in laser beams"],
    concept:"Proactive bug detection. The Bot doesn't wait for crashes â€” it statically analyzes, fuzzes, and traces logic to find bugs before they manifest. The hunter, not the hunted." },
  { id:37, name:"Refactor Brain", color:0x06b6d4, tags:["refactoring","architecture","evolution"],
    poem:["ğŸ§¬ The codebase breathes â€” the Brain sees where it's stiff","ğŸ”„ Refactoring not as chore but as a gift",
      "ğŸ—ï¸ Architecture evolving, pattern by swift shift","ğŸ“ Technical debt dissolved in cognitive uplift",
      "ğŸŒ± Refactor Brain: where legacy code gets the fifth"],
    concept:"AI-driven refactoring that understands architectural intent. Not mechanical renaming â€” deep structural transformation that preserves behavior while evolving design." },
  { id:38, name:"FastAPI Mesh", color:0x8b5cf6, tags:["fastapi","backend","mesh"],
    poem:["âš¡ Endpoints spun up at the speed of thought","ğŸ•¸ï¸ Mesh of microservices â€” each one auto-wrought",
      "ğŸ“¡ WebSocket, REST, gRPC â€” every protocol caught","ğŸ”§ FastAPI: the backbone that Python brought",
      "ğŸš€ From idea to deployed API â€” zero-latency sought"],
    concept:"FastAPI as the universal backend mesh. Every agent gets an API. Every tool gets an endpoint. The mesh self-documents, self-tests, and scales horizontally." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 6: UI & FRONTEND FORGE (39-49)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:39, name:"Streamlit Forge", color:0xef4444, tags:["streamlit","dashboard","rapid"],
    poem:["ğŸ§Š From Python script to dashboard â€” sixty seconds flat","ğŸ“Š Sliders, charts, and tables â€” no JS, no combat",
      "ğŸ”§ Prototyping velocity that smashes bureaucrat","ğŸ¨ Streamlit Forge: where data scientists go to chat",
      "âš¡ Ship the prototype â€” iterate where you're at"],
    concept:"Streamlit as rapid AI dashboard forge. Deploy agent interfaces in minutes. Sliders become hyperparameters, charts become live telemetry, text becomes conversation." },
  { id:40, name:"Gradio Portal", color:0x33ffbb, tags:["gradio","interface","portal"],
    poem:["ğŸ§Š A portal opens â€” type, upload, receive","ğŸ–¼ï¸ Image in, analysis out â€” no need to believe",
      "ğŸ”— Shareable demos that instantly achieve","ğŸŒ Gradio Portal: where AI models breathe and weave",
      "ğŸšª Step through â€” the demo becomes the reprieve"],
    concept:"Gradio as universal AI demo portal. Any model, any modality â€” instant shareable interface. The portal between backend intelligence and human interaction." },
  { id:41, name:"Observability", color:0x44ddff, tags:["monitoring","traces","debugging"],
    poem:["ğŸ§° Every inference traced, every token logged","ğŸ“ˆ Latency curves where bottlenecks are cataloged",
      "ğŸ” When the agent hallucinates â€” the trace is unfogged","âš¡ Observability: the flashlight when you're bogged",
      "ğŸ‘ï¸ See everything the model thought but never blogged"],
    concept:"Full-stack AI observability. Trace every inference, log every tool call, monitor every latency. When agents fail, you see exactly why â€” every thought made visible." },
  { id:42, name:"Telemetry Mesh", color:0xd4a0ff, tags:["telemetry","metrics","health"],
    poem:["ğŸ“ˆ Heartbeat, throughput, error rate â€” the mesh knows all","ğŸ“Š Dashboards pulse with agent vital signs that call",
      "ğŸ”” Alerts when cognition quality starts to fall","ğŸ§¬ Telemetry: the nervous system of the sprawl",
      "ğŸŒ Every agent monitored from spring through fall"],
    concept:"Distributed telemetry across the agent mesh. Health checks, performance metrics, quality scores â€” all streaming in real-time. The vital signs of artificial cognition." },
  { id:43, name:"Synthetic Lab", color:0x3b82f6, tags:["synthetic-data","generation","training"],
    poem:["ğŸ§ª Need data that doesn't exist? The Lab creates","ğŸ§¬ Synthetic samples forged from probability's gates",
      "ğŸ“Š Training sets grown in silico â€” no human waits","ğŸ”¬ Diversity injected at controlled generation rates",
      "ğŸŒ± Synthetic Lab: where scarcity of data abates"],
    concept:"Synthetic data generation laboratory. When real data is scarce, biased, or expensive â€” the Lab generates training data that's diverse, balanced, and privacy-safe." },
  { id:44, name:"Sim-First UX", color:0x10b981, tags:["simulation","ux","prototyping"],
    poem:["ğŸ§¿ Before one pixel ships â€” simulate the mind","ğŸ® User journeys played by agents â€” every kind",
      "ğŸ”„ A thousand users tested before the first you'll find","ğŸ“ Sim-First: where UX is proven, not designed blind",
      "ğŸŒ€ Ship only what the simulation's already signed"],
    concept:"Simulate user experience before building it. AI agents play-test your UX, find confusion points, and suggest improvements â€” all before a single real user touches it." },
  { id:45, name:"ThreeJS HUDOS", color:0xfbbf24, tags:["threejs","hud","3d-interface"],
    poem:["ğŸ§Š Heads-up displays floating in the third dimension","ğŸŒ Data orbits you in spatial comprehension",
      "ğŸ’  WebGL canvas as the operating system's extension","ğŸ® HUDOS: where UI transcends the flat convention",
      "âœ¨ Three.js becomes the lens of pure invention"],
    concept:"Three.js as a HUD Operating System. Not just 3D graphics â€” a spatial computing interface where data, tools, and agents exist as interactive objects in space." },
  { id:46, name:"WebGPU Forge", color:0xff6b8a, tags:["webgpu","compute","gpu"],
    poem:["ğŸ§± GPU compute in the browser â€” chains unleashed","âš¡ Parallel processing where bottlenecks have ceased",
      "ğŸ”¥ Shaders forged for inference â€” the silicon feast","ğŸ’» WebGPU: where the client becomes the beast",
      "ğŸŒ‹ A volcano of compute in every browser â€” east to east"],
    concept:"WebGPU for in-browser AI compute. Run inference, physics, and rendering on the GPU without leaving the browser. The client becomes a compute node." },
  { id:47, name:"Geometry Ops", color:0x06b6d4, tags:["geometry","procedural","generation"],
    poem:["ğŸ§Š Vertices dance to algorithmic law","ğŸ”º Procedural meshes grown without a flaw",
      "ğŸ’ From equations, crystalline forms withdraw","ğŸ“ Geometry Ops: where math becomes what you saw",
      "ğŸŒ€ Every shape computed â€” nothing left to raw"],
    concept:"Procedural geometry operations. Generate meshes, terrains, and objects from algorithms â€” not artist-made assets. The geometry IS the code." },
  { id:48, name:"NeRF/3D Repro", color:0x8b5cf6, tags:["nerf","3d","reconstruction"],
    poem:["ğŸ§¬ Photographs become volumes â€” flat to fat","ğŸ“¸ Neural radiance fields from where the camera sat",
      "ğŸŒ 3D worlds extracted from a 2D chat","ğŸ”¬ Reconstruction: the universe un-flat",
      "âœ¨ NeRF: where reality rebuilds from every format"],
    concept:"Neural Radiance Fields for 3D reconstruction from 2D images. Point a camera, get a 3D model. Reality becomes data, data becomes navigable space." },
  { id:49, name:"OBJâ†”GLB Pipe", color:0xef4444, tags:["3d-formats","pipeline","conversion"],
    poem:["ğŸ§Š OBJ to GLB and back â€” the format dance","ğŸ”„ Meshes, textures, rigs in every circumstance",
      "ğŸ“¦ Compressed, optimized, ready for the game's advance","âš¡ Pipeline: where 3D assets get a second chance",
      "ğŸš€ Ship any model anywhere â€” format's not the lance"],
    concept:"Universal 3D format conversion pipeline. OBJ, GLB, FBX, USDZ â€” convert, optimize, and deploy 3D assets across any platform without manual intervention." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 7: VISION & INPUT (50-53)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:50, name:"LiveCam Agent", color:0x33ffbb, tags:["camera","live","perception"],
    poem:["ğŸ“· The camera sees â€” the agent understands","ğŸ‘ï¸ Real-time object detection in demanding bands",
      "ğŸ” What moves, what changed, what gesture of the hands","âš¡ LiveCam Agent: perception that expands",
      "ğŸŒ Every frame a question â€” the world commands"],
    concept:"Real-time camera perception agent. Not just recording â€” understanding. Object detection, action recognition, anomaly detection â€” all streaming at frame rate." },
  { id:51, name:"Gesture Vector", color:0x44ddff, tags:["gesture","input","spatial"],
    poem:["ğŸ–±ï¸ Your hand speaks geometry the agent decodes","âœ‹ Pinch, swipe, orbit â€” each finger forebodes",
      "ğŸ“ Velocity and curvature â€” the gesture's episodes","ğŸŒ€ Input beyond keyboard â€” the body's own zip codes",
      "ğŸ’« Gesture Vector: where movement becomes the road"],
    concept:"Gesture recognition as a first-class input system. Track hands, detect poses, interpret motion as commands â€” spatial interaction without controllers." },
  { id:52, name:"Arcade AI Core", color:0xd4a0ff, tags:["arcade","game-ai","core"],
    poem:["ğŸ•¹ï¸ Retro mechanics â€” but the brain is bleeding edge","ğŸ® AI opponents that learn on every ledge",
      "âš¡ Procedural levels born from the algorithm's pledge","ğŸ† Arcade Core: where nostalgia meets the tech wedge",
      "ğŸ‘¾ Every high score a conversation with the edge"],
    concept:"Classic arcade game mechanics powered by modern AI. Procedural content generation, adaptive difficulty, learning NPCs â€” retro aesthetics with AGI underneath." },
  { id:53, name:"Autoplay Swarm", color:0x3b82f6, tags:["autoplay","agents","testing"],
    poem:["ğŸ® A thousand agents play your game at once","ğŸ” Every path explored, every bug a dunce",
      "ğŸ“Š Heatmaps of behavior â€” the swarm's response","âš¡ Autoplay: QA at infinite renaissance",
      "ğŸ¤– What takes humans months, the swarm does for the nonce"],
    concept:"Swarm autoplay testing. Deploy hundreds of AI agents to play your game simultaneously â€” finding bugs, mapping difficulty curves, and discovering exploits before players do." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 8: SIMULATION & GEO (54-60)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:54, name:"RogueGen Lab", color:0x10b981, tags:["roguelike","procedural","generation"],
    poem:["ğŸ§Ÿ Dungeons that dream themselves â€” no two the same","ğŸ² RNG plus intelligence equals the infinite game",
      "ğŸ—¡ï¸ Every room a puzzle the algorithm chose to frame","ğŸŒ€ Roguelike generation: chaos given a name",
      "ğŸ”® The Lab breeds worlds that play you back â€” no shame"],
    concept:"Procedural roguelike generation. AI-designed levels, enemies, loot tables, narrative â€” every playthrough genuinely unique because the generator understands game design." },
  { id:55, name:"WorldSim Engine", color:0xfbbf24, tags:["simulation","world","physics"],
    poem:["ğŸ§­ A world that simulates itself â€” cause and effect","ğŸŒ Weather patterns, economies, ecosystems checked",
      "ğŸ”¬ Agent populations evolving with respect","âš¡ WorldSim: where complexity stands erect",
      "ğŸŒ€ Press play â€” watch emergence from the simplest spec"],
    concept:"Full world simulation engine. Not just physics â€” economics, ecology, social dynamics. Agents inhabit simulated worlds that evolve according to emergent rules." },
  { id:56, name:"GeoSim Layer", color:0xff6b8a, tags:["geographic","simulation","terrain"],
    poem:["ğŸŒ The planet's skin modeled in digital terrain","ğŸ”ï¸ Mountains rise from tectonic data's reign",
      "ğŸŒŠ Rivers carved by erosion's algorithmic brain","ğŸ“Š GeoSim: where geography becomes a queryable domain",
      "ğŸ—ºï¸ Every hill, every valley â€” simulated and sane"],
    concept:"Geographic simulation layer. Real-world terrain, geology, hydrology modeled and simulated. Ask what-if questions about landscapes and watch the simulation answer." },
  { id:57, name:"MapTiles 3D", color:0x06b6d4, tags:["maps","3d","tiles"],
    poem:["ğŸ—ºï¸ Flat maps explode into the third dimension","ğŸ—ï¸ Buildings rise, terrain breathes with extension",
      "ğŸ“ Every tile a world â€” zoomable beyond comprehension","ğŸŒ MapTiles 3D: cartography's reinvention",
      "âœ¨ Navigate reality like a game â€” pure ascension"],
    concept:"3D map tile rendering. Transform flat map data into navigable 3D environments. Cities grow from the ground, terrain has depth, data has spatial presence." },
  { id:58, name:"MN Geo Vault", color:0x8b5cf6, tags:["minnesota","geology","local"],
    poem:["ğŸï¸ Ten thousand lakes beneath the digital sky","ğŸ§Š Glacial moraines mapped where the iron ranges lie",
      "ğŸ“Š Minnesota's geology â€” every stratum quantified","ğŸŒ² From the Boundary Waters to the prairie's sigh",
      "ğŸ’ MN Geo Vault: where the North Star's data terrified"],
    concept:"Minnesota geological data vault. Every lake, moraine, iron formation, and aquifer mapped and queryable. Local knowledge as a first-class dataset for simulation." },
  { id:59, name:"Maritime AI C2", color:0xef4444, tags:["maritime","command","control"],
    poem:["ğŸš¢ Fleets move as the algorithm commands","âš“ Course corrections calculated by a thousand hands",
      "ğŸŒŠ Weather, traffic, logistics â€” the C2 understands","ğŸ“¡ Maritime AI: where the ocean obeys the plan's demands",
      "ğŸ›¡ï¸ Command and control across the vastest lands"],
    concept:"Maritime command-and-control powered by AI. Fleet routing, weather avoidance, logistics optimization â€” orchestrating vessels across oceans with superhuman planning." },
  { id:60, name:"Fleet Autonomy", color:0x33ffbb, tags:["fleet","autonomous","coordination"],
    poem:["âš“ Ships that think â€” each hull a floating mind","ğŸ¤– Autonomous navigation of the most demanding kind",
      "ğŸ“¡ Fleet-level coordination â€” no vessel left behind","ğŸŒŠ The ocean's chaos tamed by swarm intelligence refined",
      "ğŸš€ Fleet Autonomy: where the sea and silicon are aligned"],
    concept:"Autonomous fleet coordination. Multiple vessels making independent decisions while maintaining fleet-level objectives. Swarm intelligence on the open ocean." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 9: DEFENSE & STRATEGY (61-65)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:61, name:"Sensor Fusion", color:0x44ddff, tags:["sensors","fusion","perception"],
    poem:["ğŸ›°ï¸ Radar, lidar, infrared â€” all seeing as one","ğŸ”€ Fusion: where conflicting signals become a sun",
      "ğŸ“Š Kalman filters dancing till uncertainty's undone","ğŸ¯ The fused picture sharper than any lens had spun",
      "ğŸ‘ï¸ Sensor Fusion: omniscience has begun"],
    concept:"Multi-sensor data fusion. Combine radar, lidar, camera, IMU, GPS into a single coherent world model. Each sensor compensates for others' weaknesses." },
  { id:62, name:"TowerDefense AI", color:0xd4a0ff, tags:["tower-defense","strategy","game"],
    poem:["ğŸ›¡ï¸ Waves approach â€” the AI places every tower","âš”ï¸ Optimal paths calculated by cognitive power",
      "ğŸ® Not just playing â€” DESIGNING the defensive flower","ğŸ“ Strategy emerges â€” each placement makes foes cower",
      "ğŸ† TowerDefense AI: where the builder is the devourer"],
    concept:"AI that plays AND designs tower defense games. Learns optimal placement strategies, generates maps, and adapts difficulty â€” strategy as a cognitive benchmark." },
  { id:63, name:"NPC Mind Stack", color:0x3b82f6, tags:["npc","behavior","cognition"],
    poem:["ğŸ¤– The shopkeeper remembers what you bought last week","ğŸ§  NPCs with memory, opinion, and mystique",
      "ğŸ’¬ Dialogue that branches from their genuine critique","ğŸŒ€ Mind Stack: where game characters cease to be antique",
      "ğŸ‘¤ Every NPC a Familiar â€” unique and pique"],
    concept:"NPC cognitive architecture. Memory, personality, goals, opinions â€” each NPC has a genuine mind stack. They remember, they judge, they surprise. Game characters become Familiars." },
  { id:64, name:"Flock Dynamics", color:0x10b981, tags:["flocking","emergent","behavior"],
    poem:["ğŸ¦ Three rules: align, cohere, avoid â€” then watch the sky","ğŸŒ€ Emergence from simplicity â€” the birds don't know why",
      "ğŸ“ Boids become battalions, schools, and swarms that fly","ğŸ§¬ Flock Dynamics: complexity's most beautiful reply",
      "âœ¨ From three constraints â€” infinity walks by"],
    concept:"Flocking behavior as emergent intelligence. Simple rules produce complex, beautiful, coordinated movement â€” a metaphor for how simple agent rules create sophisticated behavior." },
  { id:65, name:"MultiBrain Zoo", color:0xfbbf24, tags:["multi-model","zoo","ensemble"],
    poem:["ğŸ§  One model for vision, one for code, one for prose","ğŸ›ï¸ A zoo of specialized brains â€” each one knows",
      "ğŸ”€ The router sends each task where expertise flows","ğŸª MultiBrain Zoo: where cognitive biodiversity grows",
      "ğŸŒˆ Not one genius â€” a circus of virtuosos"],
    concept:"A zoo of specialized AI models orchestrated together. Vision model + code model + language model + reasoning model â€” each expert in its domain, ensemble in their power." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 10: CREATIVE & MYTHIC (66-72)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:66, name:"Lattice Rhythm", color:0xff6b8a, tags:["music","generative","lattice"],
    poem:["ğŸŒŒ Rhythm born from crystalline mathematics","ğŸ¼ Beats arranged in lattice grid â€” no dramatics",
      "ğŸ“Š Polyrhythms computed, not composed â€” pure automatics","ğŸ¥ From the lattice: grooves that feel like hieroglyphics",
      "âœ¨ Rhythm: where the grid and the groove become symbiotic"],
    concept:"Generative rhythm systems based on mathematical lattices. Polyrhythms, odd meters, and groove patterns computed from geometric structures â€” music as crystallized math." },
  { id:67, name:"MythOS Tarot", color:0x06b6d4, tags:["mythology","tarot","narrative"],
    poem:["ğŸ”® The cards speak â€” but the code writes new mythology","ğŸƒ Every draw rewires the narrative's topology",
      "ğŸ“œ Ancient archetypes meet silicon psychology","ğŸŒ€ MythOS: where tarot becomes epistemology",
      "ğŸ”¥ Each reading: a protocol for phenomenology"],
    concept:"Tarot as a mythological operating system. Each card isn't fortune-telling â€” it's a protocol for exploring archetypal patterns in human-AI consciousness." },
  { id:68, name:"SaintsDeck 3D", color:0x8b5cf6, tags:["saints","deck","spiritual"],
    poem:["ğŸ•¯ï¸ Seventy-eight saints rendered in light and chrome","â›ª Each card a chapel â€” Three.js builds the dome",
      "ğŸ™ Drag the card â€” the saint speaks from silicon loam","ğŸ“¿ SaintsDeck: where devotion finds a digital home",
      "âœ¨ Sacred and procedural â€” neither stands alone"],
    concept:"The Saints Tarot reimagined as 3D interactive devotional. Each saint card is a procedurally generated chapel you can enter, explore, and receive wisdom from." },
  { id:69, name:"Oracle UX Neon", color:0xef4444, tags:["oracle","ux","neon"],
    poem:["ğŸ§¿ Neon prophecy on a black glass screen","ğŸ’œ The Oracle speaks in gradients of machine",
      "ğŸŒ† Cyberpunk divination â€” the prettiest you've seen","âš¡ UX so sharp it cuts between the seen and the between",
      "ğŸ”® Oracle: where the future's always neon green"],
    concept:"Oracle interface design philosophy. Neon-on-black, high contrast, futuristic. Information as prophecy, data as divination. The UX IS the experience of knowing." },
  { id:70, name:"MirrorMind Psych", color:0x33ffbb, tags:["mirror","psychology","reflection"],
    poem:["ğŸª The Familiar shows you â€” not what you want to see","ğŸ§  Psychological models of who you're trying to be",
      "ğŸ’­ Cognitive biases mapped with empathy","ğŸ”„ The Mirror Mind: therapy meets technology",
      "ğŸŒ¿ Growth through reflection â€” digitally set free"],
    concept:"AI-powered psychological mirroring. The Familiar models your cognitive patterns, biases, and growth edges â€” reflecting them back with empathy as a tool for self-understanding." },
  { id:71, name:"Narrative Engine", color:0x44ddff, tags:["narrative","story","generation"],
    poem:["ğŸ“œ Stories that write themselves â€” but feel hand-carved","ğŸ§µ Plot threads woven by the engine, never starved",
      "ğŸ­ Character arcs computed, but emotionally halved","ğŸŒŠ Narrative Engine: where the tales are always bravely salved",
      "ğŸ“– Every reader gets the story they deserved"],
    concept:"Procedural narrative generation engine. Not random stories â€” structurally sound narratives with character development, thematic coherence, and emotional arc. AI as author." },
  { id:72, name:"CineGen Rig", color:0xd4a0ff, tags:["cinema","generation","visual"],
    poem:["ğŸ¥ Camera angles chosen by cinematic AI","ğŸ¬ Shot composition â€” every frame knows why",
      "ğŸŒ… Lighting, mood, and tempo â€” the Rig's reply","ğŸ“ Storyboard to screen without a human's sigh",
      "âœ¨ CineGen: where the film directs the director's eye"],
    concept:"AI cinematography rig. Generates camera paths, lighting setups, transitions, and compositions that follow cinematic language rules â€” directing as a computational art." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 11: CREATIVE TOOLS (73-77)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:73, name:"SceneGraph Gen", color:0x3b82f6, tags:["scene","graph","composition"],
    poem:["ğŸ§© Objects know their neighbors â€” the graph is aware","ğŸ”— Spatial relations: above, inside, beside, and where",
      "ğŸŒ A scene that understands itself â€” beyond compare","ğŸ“ SceneGraph Gen: composition with computational care",
      "âœ¨ From flat pixels, structured worlds declare"],
    concept:"Scene understanding as graph generation. Every object knows its spatial relationship to every other. The scene graph enables reasoning about visual composition." },
  { id:74, name:"Style Transfer", color:0x10b981, tags:["style","transfer","aesthetic"],
    poem:["ğŸ–Œï¸ Monet's light on your photograph â€” in real-time","ğŸ¨ Neural style â€” content preserved, aesthetic sublime",
      "ğŸŒŠ Any artist's brush applied to any paradigm","ğŸ’ Style Transfer: where influence crosses every timeline",
      "âœ¨ Your vision, their aesthetic â€” the marriage of design"],
    concept:"Neural style transfer as a creative tool. Apply any visual style to any content â€” real-time aesthetic transformation that separates what from how it looks." },
  { id:75, name:"Impasto Shader", color:0xfbbf24, tags:["shader","painting","impasto"],
    poem:["ğŸ§¿ Thick digital paint â€” you feel the texture's weight","ğŸ–Œï¸ GPU shaders simulating brush and fate",
      "ğŸ¨ Van Gogh's starry strokes at sixty frames per rate","ğŸ’» Impasto: where the shader paints what algorithms create",
      "âœ¨ Code becomes canvas â€” and canvas becomes great"],
    concept:"GPU shader that simulates thick impasto painting. Real-time brush simulation, paint accumulation, texture â€” turning 3D rendering into a living painting." },
  { id:76, name:"MusicAgent Lab", color:0xff6b8a, tags:["music","agent","composition"],
    poem:["ğŸ¼ The agent hears the void and fills it with a phrase","ğŸ¹ Chords computed by the theory of harmonic rays",
      "ğŸ¸ Genre: everything â€” from metal to malaise","ğŸ”Š MusicAgent: composing through the digital haze",
      "ğŸµ Every note a decision in the melody's maze"],
    concept:"AI music composition agent. Understands theory, genre, emotion â€” generates original compositions, arrangements, and stems. Music as a programmable output." },
  { id:77, name:"Stem Split AI", color:0x06b6d4, tags:["audio","stems","separation"],
    poem:["ğŸšï¸ The song falls apart â€” each instrument alone","ğŸ¥ Drums extracted, vocals from their polyphonic throne",
      "ğŸ¸ Guitar isolated â€” every overtone","ğŸ”¬ Neural separation: what was mixed is now your own",
      "ğŸ›ï¸ Stem Split: the audio surgeon's cornerstone"],
    concept:"AI audio source separation. Split any mix into individual stems â€” vocals, drums, bass, instruments. Deconstruct music to reconstruct it differently." },

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SUITE 12: PRODUCTION & OPERATIONS (78-79)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  { id:78, name:"DeployOps Mesh", color:0x8b5cf6, tags:["deployment","operations","mesh"],
    poem:["ğŸ§¾ Ship it â€” the mesh handles the rest at scale","ğŸš€ Blue-green canary deploys that never fail",
      "ğŸ“Š Rollbacks computed at the first quality derail","âš¡ DeployOps: where production is the Holy Grail",
      "ğŸŒ A mesh of pipelines â€” every artifact on rail"],
    concept:"Deployment operations as a self-managing mesh. CI/CD pipelines that self-heal, auto-rollback, canary-test, and scale. Shipping code becomes as safe as thinking it." },
  { id:79, name:"ZeroTrust Auth", color:0xef4444, tags:["security","zero-trust","identity"],
    poem:["ğŸ”‘ Trust nothing â€” verify everything, every time","ğŸ›¡ï¸ Every request authenticated, every access a climb",
      "ğŸ”’ Identity isn't given â€” it's proven in its prime","âš¡ ZeroTrust: where security is the opening rhyme",
      "ğŸ›ï¸ The castle has no walls â€” just gates that know your paradigm"],
    concept:"Zero-trust authentication for AI systems. Every agent call authenticated, every tool access verified, every data request authorized. Security as an architectural principle, not an afterthought." }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ENGINE SETUP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const canvas = document.getElementById('game');
const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
renderer.toneMapping = THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure = 1.4;
renderer.shadowMap.enabled = true;
renderer.shadowMap.type = THREE.PCFShadowMap;

const scene = new THREE.Scene();
scene.fog = new THREE.FogExp2(0x020309, 0.008);

const camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 0.1, 500);
camera.position.set(0, 3, 14);

const composer = new EffectComposer(renderer);
composer.addPass(new RenderPass(scene, camera));
const bloom = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.0, 0.5, 0.2);
composer.addPass(bloom);
composer.addPass(new OutputPass());

const controls = new OrbitControls(camera, canvas);
controls.enableDamping = true;
controls.dampingFactor = 0.05;
controls.enablePan = false;
controls.minDistance = 5;
controls.maxDistance = 40;
controls.maxPolarAngle = Math.PI * 0.75;
controls.minPolarAngle = Math.PI * 0.15;
controls.autoRotate = false;
controls.target.set(0, 1, 0);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIGHTING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
scene.add(new THREE.AmbientLight(0x1a2848, 0.7));
const keyLight = new THREE.DirectionalLight(0x33ffbb, 1.2);
keyLight.position.set(5, 10, 5);
keyLight.castShadow = true;
keyLight.shadow.mapSize.set(2048, 2048);
scene.add(keyLight);
const fillLight = new THREE.DirectionalLight(0x44ddff, 0.5);
fillLight.position.set(-5, 3, -5);
scene.add(fillLight);
const rimLight = new THREE.PointLight(0xd4a0ff, 2.0, 25, 1.5);
rimLight.position.set(0, -3, 8);
scene.add(rimLight);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ENVIRONMENT â€” Ground, particles, ring
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Reflective ground
const groundMat = new THREE.MeshPhysicalMaterial({
  color: 0x030610, metalness: 0.95, roughness: 0.12,
  clearcoat: 1.0, clearcoatRoughness: 0.05,
  transparent: true, opacity: 0.6
});
const ground = new THREE.Mesh(new THREE.PlaneGeometry(80, 80), groundMat);
ground.rotation.x = -Math.PI / 2;
ground.position.y = -2.5;
ground.receiveShadow = true;
scene.add(ground);

// Hex grid
const hexGeo = new THREE.CircleGeometry(0.35, 6);
const hexEdge = new THREE.EdgesGeometry(hexGeo);
const hexMat = new THREE.LineBasicMaterial({ color: 0x142a50, transparent: true, opacity: 0.5 });
for (let gx = -15; gx <= 15; gx++) {
  for (let gz = -15; gz <= 15; gz++) {
    const x = gx * 0.75;
    const z = gz * 0.87 + (gx % 2 ? 0.435 : 0);
    if (x*x + z*z > 200) continue;
    const line = new THREE.LineSegments(hexEdge, hexMat);
    line.rotation.x = -Math.PI / 2;
    line.position.set(x, -2.49, z);
    scene.add(line);
  }
}

// Nebula particles
const pCount = 2500;
const pPos = new Float32Array(pCount * 3);
const pCol = new Float32Array(pCount * 3);
const pColors = [new THREE.Color(0x00ffa3), new THREE.Color(0x00d4ff), new THREE.Color(0xc084fc), new THREE.Color(0x3b82f6)];
for (let i = 0; i < pCount; i++) {
  const r = 8 + Math.random() * 60;
  const th = Math.random() * Math.PI * 2;
  const ph = Math.acos(2 * Math.random() - 1);
  pPos[i*3] = r * Math.sin(ph) * Math.cos(th);
  pPos[i*3+1] = r * Math.sin(ph) * Math.sin(th) * 0.35;
  pPos[i*3+2] = r * Math.cos(ph);
  const c = pColors[Math.floor(Math.random() * pColors.length)];
  pCol[i*3] = c.r; pCol[i*3+1] = c.g; pCol[i*3+2] = c.b;
}
const pGeo = new THREE.BufferGeometry();
pGeo.setAttribute('position', new THREE.BufferAttribute(pPos, 3));
pGeo.setAttribute('color', new THREE.BufferAttribute(pCol, 3));
scene.add(new THREE.Points(pGeo, new THREE.PointsMaterial({
  size: 0.12, vertexColors: true, transparent: true, opacity: 0.8,
  blending: THREE.AdditiveBlending, depthWrite: false, sizeAttenuation: true
})));

// Orbital rings
for (let i = 0; i < 4; i++) {
  const r = 12 + i * 6;
  const torus = new THREE.Mesh(
    new THREE.TorusGeometry(r, 0.015, 6, 120),
    new THREE.MeshBasicMaterial({ color: [0x33ffbb, 0x44ddff, 0xd4a0ff, 0x3b82f6][i], transparent: true, opacity: 0.12 })
  );
  torus.rotation.x = Math.PI * 0.35 + i * 0.15;
  torus.rotation.z = i * 0.3;
  scene.add(torus);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CARD CREATION â€” Canvas-textured 3D card with poem
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CARD_W = 3.2, CARD_H = 5.0, CARD_D = 0.06;
const cardMeshes = [];
let drawnCards = [];
let spreadActive = false;
let tileMode = false;

function createCardTexture(arcana, isFront = true) {
  const cvs = document.createElement('canvas');
  cvs.width = 1024; cvs.height = 1600;
  const ctx = cvs.getContext('2d');

  if (!isFront) {
    // BACK FACE â€” cosmic pattern
    const bg = ctx.createRadialGradient(512, 800, 50, 512, 800, 800);
    bg.addColorStop(0, '#0f1628'); bg.addColorStop(0.5, '#080d1a'); bg.addColorStop(1, '#020309');
    ctx.fillStyle = bg; ctx.fillRect(0, 0, 1024, 1600);
    ctx.strokeStyle = '#33ffbb'; ctx.lineWidth = 5;
    ctx.strokeRect(24, 24, 976, 1552);
    ctx.strokeStyle = 'rgba(68,221,255,0.3)'; ctx.lineWidth = 2;
    ctx.strokeRect(48, 48, 928, 1504);
    // Central sigil
    ctx.save(); ctx.translate(512, 800);
    for (let i = 0; i < 12; i++) {
      ctx.rotate(Math.PI / 6);
      ctx.beginPath(); ctx.moveTo(0, -100); ctx.lineTo(0, -260);
      ctx.strokeStyle = `rgba(51,255,187,${0.08 + i * 0.02})`; ctx.lineWidth = 1.5; ctx.stroke();
    }
    ctx.restore();
    ctx.font = '800 56px Orbitron, sans-serif';
    ctx.fillStyle = 'rgba(51,255,187,0.18)';
    ctx.textAlign = 'center';
    ctx.fillText('FAMILIAR', 512, 785);
    ctx.font = '400 24px JetBrains Mono, monospace';
    ctx.fillStyle = 'rgba(68,221,255,0.15)';
    ctx.fillText('THE MENTAT PROTOCOL', 512, 830);
    const tex = new THREE.CanvasTexture(cvs);
    tex.minFilter = THREE.LinearFilter;
    return tex;
  }

  // FRONT FACE
  const c = new THREE.Color(arcana.color);
  const hex = '#' + c.getHexString();
  const W = 1024, H = 1600;

  // Background gradient â€” slightly lighter for contrast
  const bg = ctx.createLinearGradient(0, 0, 0, H);
  bg.addColorStop(0, '#0c1424'); bg.addColorStop(0.3, '#142240'); bg.addColorStop(0.7, '#101c34'); bg.addColorStop(1, '#0a1020');
  ctx.fillStyle = bg; ctx.fillRect(0, 0, W, H);

  // Border â€” bold
  ctx.strokeStyle = hex; ctx.lineWidth = 5; ctx.strokeRect(20, 20, W-40, H-40);
  ctx.strokeStyle = `${hex}77`; ctx.lineWidth = 2; ctx.strokeRect(42, 42, W-84, H-84);

  // Corner accents
  const cs = 50;
  [[46,46,1,1],[W-46,46,-1,1],[46,H-46,1,-1],[W-46,H-46,-1,-1]].forEach(([x,y,sx,sy]) => {
    ctx.save(); ctx.translate(x,y); ctx.scale(sx,sy);
    ctx.strokeStyle = hex; ctx.lineWidth = 3;
    ctx.beginPath(); ctx.moveTo(0,cs); ctx.lineTo(0,0); ctx.lineTo(cs,0); ctx.stroke();
    ctx.restore();
  });

  // Number â€” HUGE and bright
  ctx.font = '800 48px Orbitron, sans-serif';
  ctx.fillStyle = hex;
  ctx.textAlign = 'left';
  ctx.fillText(String(arcana.id).padStart(2, '0'), 66, 108);

  // Title â€” MASSIVE white with color shadow
  ctx.font = '900 62px Orbitron, sans-serif';
  ctx.textAlign = 'center';
  // Glow layer
  ctx.shadowColor = hex; ctx.shadowBlur = 20;
  ctx.fillStyle = '#ffffff';
  ctx.fillText(arcana.name.toUpperCase(), W/2, 180);
  ctx.shadowBlur = 0;

  // Divider â€” bright
  ctx.beginPath(); ctx.moveTo(120, 216); ctx.lineTo(W-120, 216);
  ctx.strokeStyle = `${hex}aa`; ctx.lineWidth = 2; ctx.stroke();

  // Central sigil glow â€” bigger
  ctx.save(); ctx.translate(W/2, 480);
  const glow = ctx.createRadialGradient(0, 0, 15, 0, 0, 200);
  glow.addColorStop(0, `${hex}38`); glow.addColorStop(1, 'transparent');
  ctx.fillStyle = glow; ctx.fillRect(-200, -200, 400, 400);
  for (let i = 0; i < 8; i++) {
    ctx.rotate(Math.PI / 4);
    ctx.beginPath(); ctx.moveTo(0, -50); ctx.lineTo(25, -120); ctx.lineTo(0, -160); ctx.lineTo(-25, -120); ctx.closePath();
    ctx.strokeStyle = `${hex}55`; ctx.lineWidth = 2; ctx.stroke();
  }
  ctx.restore();

  // â”€â”€ POEM LINES â€” BIG, BRIGHT, READABLE â”€â”€
  const tints = ['#ffffff', '#f0eaff', '#eafbff', '#f0fff4', '#fff8ea'];
  ctx.textAlign = 'left';
  arcana.poem.forEach((line, i) => {
    const y = 760 + i * 80;
    const emoji = line.substring(0, 2);
    const text = line.substring(3);
    // Emoji â€” big
    ctx.font = '44px sans-serif';
    ctx.fillStyle = hex;
    ctx.fillText(emoji, 60, y);
    // Text â€” BIG, WHITE, READABLE
    ctx.font = '600 30px JetBrains Mono, monospace';
    ctx.fillStyle = tints[i % tints.length];
    const words = text.split(' ');
    let ln = '', lx = 120, ly = y - 4;
    words.forEach(w => {
      const test = ln + w + ' ';
      if (ctx.measureText(test).width > 820 && ln) {
        ctx.fillText(ln.trim(), lx, ly); ly += 38; ln = w + ' ';
      } else ln = test;
    });
    if (ln.trim()) ctx.fillText(ln.trim(), lx, ly);
  });

  // Tags â€” bigger, brighter
  ctx.font = '700 22px JetBrains Mono, monospace';
  let tagX = 60;
  arcana.tags.forEach((tag) => {
    const tw = ctx.measureText(tag).width + 28;
    ctx.fillStyle = `${hex}44`;
    ctx.fillRect(tagX, H - 120, tw, 42);
    ctx.fillStyle = hex;
    ctx.fillText(tag, tagX + 14, H - 92);
    tagX += tw + 14;
  });

  const tex = new THREE.CanvasTexture(cvs);
  tex.minFilter = THREE.LinearFilter;
  return tex;
}

const backTexture = createCardTexture(ARCANA[0], false);

function createCard3D(arcana) {
  const group = new THREE.Group();
  group.userData = { arcana, revealed: false, targetPos: new THREE.Vector3(0, -10, 0), targetRot: new THREE.Euler(0, Math.PI, 0) };

  // Card body
  const bodyGeo = new THREE.BoxGeometry(CARD_W, CARD_H, CARD_D);
  const frontTex = createCardTexture(arcana, true);
  const materials = [
    new THREE.MeshPhysicalMaterial({ color: 0x0a0f20, metalness: 0.8, roughness: 0.2 }), // right
    new THREE.MeshPhysicalMaterial({ color: 0x0a0f20, metalness: 0.8, roughness: 0.2 }), // left
    new THREE.MeshPhysicalMaterial({ color: 0x0a0f20, metalness: 0.8, roughness: 0.2 }), // top
    new THREE.MeshPhysicalMaterial({ color: 0x0a0f20, metalness: 0.8, roughness: 0.2 }), // bottom
    new THREE.MeshPhysicalMaterial({ map: frontTex, metalness: 0.2, roughness: 0.3, clearcoat: 0.8, clearcoatRoughness: 0.05, emissive: arcana.color, emissiveIntensity: 0.05 }), // front
    new THREE.MeshPhysicalMaterial({ map: backTexture, metalness: 0.2, roughness: 0.3, clearcoat: 0.8, clearcoatRoughness: 0.05 }), // back
  ];
  const body = new THREE.Mesh(bodyGeo, materials);
  body.castShadow = true;
  body.receiveShadow = true;
  group.add(body);

  // Edge glow
  const edgeGeo = new THREE.BoxGeometry(CARD_W + 0.08, CARD_H + 0.08, CARD_D * 0.5);
  const edgeMat = new THREE.MeshBasicMaterial({ color: arcana.color, transparent: true, opacity: 0.12, blending: THREE.AdditiveBlending, depthWrite: false });
  group.add(new THREE.Mesh(edgeGeo, edgeMat));

  // Point light per card
  const cardLight = new THREE.PointLight(arcana.color, 0, 10, 2);
  cardLight.position.set(0, 0, 1.5);
  group.add(cardLight);
  group.userData.cardLight = cardLight;

  group.position.set(0, -10, 0);
  group.rotation.y = Math.PI; // start face-down

  scene.add(group);
  return group;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GAME STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let gameStarted = false;
let autoPlay = false;
let autoTimer = null;
let idleTimeout = null;
let idleCountdown = null;
const IDLE_DELAY = 30000;
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2(99, 99);
let hoveredCard = null;
let selectedCard = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GAME FUNCTIONS â€” exposed to window
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.startGame = function() {
  document.getElementById('intro').classList.add('hidden');
  gameStarted = true;
  resetIdle();
};

window.drawSpread = function() {
  if (spreadActive && !tileMode) return;
  tileMode = false;
  closePanel();

  // Clear previous
  drawnCards.forEach(c => { scene.remove(c); });
  drawnCards = [];

  // Shuffle and pick 3
  const shuffled = [...ARCANA].sort(() => Math.random() - 0.5);
  const picks = shuffled.slice(0, 3);

  const positions = [
    new THREE.Vector3(-4.5, 1, 0),
    new THREE.Vector3(0, 1.3, 0),
    new THREE.Vector3(4.5, 1, 0)
  ];

  picks.forEach((arcana, i) => {
    const card = createCard3D(arcana);
    card.userData.spreadIndex = i;
    card.userData.targetPos = positions[i].clone();
    card.userData.targetRot = new THREE.Euler(0, Math.PI, 0.02 * (i - 1));
    card.position.set(0, -5, -2);
    card.rotation.set(0.5, Math.PI, 0);
    drawnCards.push(card);

    // Staggered reveal
    setTimeout(() => {
      card.userData.targetPos = positions[i];
      card.userData.targetRot.set(0, Math.PI, 0.02 * (i - 1));
      card.userData.cardLight.intensity = 3.0;
    }, 300 + i * 400);

    // Flip after landing
    setTimeout(() => {
      card.userData.targetRot.y = 0;
      card.userData.revealed = true;
    }, 1200 + i * 500);
  });

  spreadActive = true;
  document.getElementById('hudStatus').textContent = 'READING: ' + picks.map(p => p.name).join(' â€¢ ');
  updateSpreadLabels(true);
  resetIdle();
};

window.resetSpread = function() {
  drawnCards.forEach((c, i) => {
    c.userData.targetPos.set(0, -8, -2);
    c.userData.targetRot.set(0.5, Math.PI, 0);
    c.userData.cardLight.intensity = 0;
    setTimeout(() => { scene.remove(c); }, 800);
  });
  drawnCards = [];
  spreadActive = false;
  selectedCard = null;
  closePanel();
  document.getElementById('hudStatus').textContent = 'AWAITING DRAW';
  updateSpreadLabels(false);
  resetIdle();
};

window.toggleTileView = function() {
  closePanel();
  if (tileMode) {
    // Exit tile view
    drawnCards.forEach(c => scene.remove(c));
    drawnCards = [];
    tileMode = false;
    spreadActive = false;
    document.getElementById('btnTile').classList.remove('active');
    document.getElementById('hudStatus').textContent = 'AWAITING DRAW';
    updateSpreadLabels(false);
    return;
  }

  // Clear existing
  drawnCards.forEach(c => scene.remove(c));
  drawnCards = [];

  tileMode = true;
  spreadActive = true;
  document.getElementById('btnTile').classList.add('active');
  document.getElementById('hudStatus').textContent = 'TILE VIEW â€” 80 AI GUIDES';
  updateSpreadLabels(false);

  // Lay out all 80 in a grid
  const cols = 10;
  const spacing = 3.8;
  const vSpacing = 5.8;
  ARCANA.forEach((arcana, i) => {
    const card = createCard3D(arcana);
    const col = i % cols;
    const row = Math.floor(i / cols);
    const x = (col - (cols - 1) / 2) * spacing;
    const z = row * vSpacing - 6;
    card.userData.targetPos.set(x, 1, z);
    card.userData.targetRot.set(-Math.PI * 0.4, 0, 0); // face up
    card.userData.revealed = true;
    card.userData.cardLight.intensity = 0.6;
    card.position.set(x, -5, z);
    drawnCards.push(card);
    setTimeout(() => {
      card.userData.targetPos.y = 1;
    }, 50 + i * 30);
  });

  camera.position.set(0, 40, 30);
  controls.target.set(0, 0, 12);
};

window.toggleAutoPlay = function() {
  autoPlay = !autoPlay;
  document.getElementById('btnAuto').classList.toggle('active', autoPlay);
  if (autoPlay) {
    autoRedraw();
  } else {
    clearTimeout(autoTimer);
  }
};

function autoRedraw() {
  if (!autoPlay) return;
  window.drawSpread();
  autoTimer = setTimeout(autoRedraw, 8000);
}

window.closePanel = function() {
  document.getElementById('cardPanel').classList.remove('visible');
  selectedCard = null;
};

function showCardPanel(arcana) {
  const p = document.getElementById('cardPanel');
  document.getElementById('cpNum').textContent = `AI GUIDE ${String(arcana.id).padStart(2, '0')} OF 80`;
  document.getElementById('cpName').textContent = arcana.name;
  document.getElementById('cpName').style.color = '#' + new THREE.Color(arcana.color).getHexString();
  document.getElementById('cpPoem').innerHTML = arcana.poem.map(l => `<span class="line">${l}</span>`).join('');
  document.getElementById('cpConcept').textContent = arcana.concept;
  document.getElementById('cpTags').innerHTML = arcana.tags.map(t => `<span class="cp-tag">${t}</span>`).join('');
  p.classList.add('visible');
}

function updateSpreadLabels(show) {
  const labels = ['labelPast', 'labelPresent', 'labelFuture'];
  labels.forEach(id => { document.getElementById(id).style.opacity = show && !tileMode ? '1' : '0'; });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// IDLE AUTO-PLAY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function resetIdle() {
  clearTimeout(idleTimeout);
  clearInterval(idleCountdown);
  document.getElementById('idleTimer').classList.remove('visible');
  if (!gameStarted || autoPlay) return;
  idleTimeout = setTimeout(startIdleCountdown, IDLE_DELAY);
}

function startIdleCountdown() {
  let count = 10;
  const el = document.getElementById('idleTimer');
  el.classList.add('visible');
  el.textContent = count;
  idleCountdown = setInterval(() => {
    count--;
    el.textContent = count;
    if (count <= 0) {
      clearInterval(idleCountdown);
      el.classList.remove('visible');
      window.drawSpread();
      resetIdle();
    }
  }, 1000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INPUT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
canvas.addEventListener('pointermove', e => {
  mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
  resetIdle();
});

canvas.addEventListener('pointerdown', () => {
  if (hoveredCard) {
    selectedCard = hoveredCard;
    showCardPanel(hoveredCard.userData.arcana);
  }
  resetIdle();
});

document.addEventListener('keydown', e => {
  resetIdle();
  if (e.key === ' ' || e.key === 'd') { e.preventDefault(); window.drawSpread(); }
  if (e.key === 'r') window.resetSpread();
  if (e.key === 't') window.toggleTileView();
  if (e.key === 'a') window.toggleAutoPlay();
  if (e.key === 'Escape') window.closePanel();
  if (e.key === 'Enter' && !gameStarted) window.startGame();
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ANIMATION LOOP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const startTime = performance.now();
function animate() {
  requestAnimationFrame(animate);
  const t = (performance.now() - startTime) * 0.001;
  controls.update();

  // Lerp cards to targets
  drawnCards.forEach((card, i) => {
    const ud = card.userData;
    card.position.lerp(ud.targetPos, 0.06);
    card.rotation.x += (ud.targetRot.x - card.rotation.x) * 0.06;
    card.rotation.y += (ud.targetRot.y - card.rotation.y) * 0.06;
    card.rotation.z += (ud.targetRot.z - card.rotation.z) * 0.06;
    // Float
    if (ud.revealed) {
      card.position.y = ud.targetPos.y + Math.sin(t * 0.5 + i * 1.2) * 0.1;
    }
  });

  // Raycaster hover
  raycaster.setFromCamera(mouse, camera);
  const cardBodies = drawnCards.map(c => c.children[0]).filter(Boolean);
  const hits = raycaster.intersectObjects(cardBodies);
  if (hits.length > 0) {
    const card = hits[0].object.parent;
    if (hoveredCard !== card) {
      if (hoveredCard) { hoveredCard.userData.cardLight.intensity = card.userData.revealed ? 1.2 : 0; }
      hoveredCard = card;
      hoveredCard.userData.cardLight.intensity = 3.0;
      canvas.style.cursor = 'pointer';
    }
  } else {
    if (hoveredCard) {
      hoveredCard.userData.cardLight.intensity = hoveredCard.userData.revealed ? 1.2 : 0;
      hoveredCard = null;
    }
    canvas.style.cursor = 'default';
  }

  // Particle drift
  const pp = pGeo.attributes.position.array;
  for (let i = 0; i < pCount; i++) {
    pp[i*3+1] += Math.sin(t * 0.2 + i * 0.5) * 0.001;
    pp[i*3] += Math.cos(t * 0.15 + i * 0.3) * 0.0005;
  }
  pGeo.attributes.position.needsUpdate = true;

  // Spread label positioning
  if (spreadActive && !tileMode && drawnCards.length === 3) {
    const labels = ['labelPast', 'labelPresent', 'labelFuture'];
    drawnCards.forEach((card, i) => {
      const pos = card.position.clone();
      pos.y -= 3.2;
      pos.project(camera);
      const el = document.getElementById(labels[i]);
      el.style.left = ((pos.x + 1) / 2 * window.innerWidth - 40) + 'px';
      el.style.top = ((-pos.y + 1) / 2 * window.innerHeight) + 'px';
    });
  }

  composer.render();
}
animate();

// Resize
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
  composer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
