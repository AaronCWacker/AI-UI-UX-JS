<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS Satellite Map with ZIP Code Search</title>
    <!-- Leaflet CSS: The stylesheet for the mapping library -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for a cleaner look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Orbitron:wght@400;700&family=Roboto+Mono:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
    <!-- Custom CSS: To style the map and search input, and the tarot game -->
    <style>
        /* Map and Main Layout Styles */
        html, body, #map {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }
        #map p {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: #555;
        }
        #search-container {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #zip-input {
            padding: 8px;
            font-size: 1rem;
            width: 250px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .control-button {
            background-color: #3b82f6;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .control-button:hover {
            background-color: #2563eb;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        #timer-display {
            font-size: 1rem;
            font-weight: bold;
            color: #333;
            min-width: 80px;
            text-align: center;
        }
        
        /* --- Game-Specific Styles for Overlay --- */
        #game-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 999; /* Below the search container but above the map */
            background-color: rgba(0, 0, 0, 0.4); /* Semi-transparent overlay */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
            color: white;
            transition: opacity 0.5s ease-in-out;
            opacity: 1;
        }
        
        #game-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        #game-content {
            background-color: rgba(26, 26, 46, 0.7); /* Deep midnight blue, semi-transparent */
            backdrop-filter: blur(5px);
            padding: 2rem;
            border-radius: 15px;
            border: 2px solid rgba(0, 170, 255, 0.4);
            box-shadow: 0 0 30px rgba(0, 170, 255, 0.3);
            max-width: 90%;
            overflow-y: auto;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            color: #00aaff;
            text-shadow: 0 0 10px rgba(0, 170, 255, 0.2), 0 0 20px rgba(0, 170, 255, 0.2);
            margin-bottom: 1rem;
            font-size: 2.5rem;
            letter-spacing: 2px;
        }
        
        p#instructions {
            max-width: 600px;
            margin-bottom: 2rem;
            font-style: italic;
            opacity: 0.9;
            font-size: 1.1rem;
            line-height: 1.6;
            color: #f0f0f0;
        }

        /* --- Main Layout --- */
        #table {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            width: 100%;
        }

        #controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .game-button {
            font-family: 'Orbitron', sans-serif;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            border: 2px solid #00aaff;
            background-color: transparent;
            color: #00aaff;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(0, 170, 255, 0.2);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .game-button:hover, .game-button:focus {
            background-color: #00aaff;
            color: #1a1a2e;
            box-shadow: 0 0 25px rgba(0, 170, 255, 0.5);
            transform: translateY(-2px);
        }

        /* --- Card Slots and Reading Area --- */
        #card-slots {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1.5rem;
            perspective: 1200px;
            width: 100%;
            min-height: 450px;
        }

        .card-slot {
            width: 300px;
            height: 450px;
            position: relative;
        }
        
        .card-slot .placeholder {
            width: 100%;
            height: 100%;
            border: 2px dashed rgba(0, 170, 255, 0.4);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-style: italic;
            opacity: 0.7;
            color: #00aaff;
            background-color: rgba(0, 170, 255, 0.05);
        }
        
        .placeholder span {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* --- Card Styling & Flip Animation --- */
        .card {
            width: 100%;
            height: 100%;
            position: absolute;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }

        .card.is-flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .card-back {
            background: linear-gradient(145deg, #2c3e50, #1a2a3a);
            border: 3px solid #00aaff;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .card-back-design {
            width: 80%;
            height: 90%;
            border: 2px solid #00aaff;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 5rem;
            color: #00aaff;
            opacity: 0.8;
            font-family: 'Orbitron', sans-serif;
            text-shadow: 0 0 10px rgba(0, 170, 255, 0.2);
        }

        .card-front {
            background-color: #e0e0e0;
            color: #1a1a2e;
            transform: rotateY(180deg);
            padding: 1rem;
            text-align: left;
            overflow-y: auto;
        }

        /* --- Card Content Styling --- */
        .card-header {
            text-align: center;
            border-bottom: 2px solid #a9a9a9;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }

        .card-header h2 {
            margin: 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            color: #005a8d;
        }

        .card-header .tarot-title {
            font-style: italic;
            font-size: 1rem;
            color: #555;
            margin-top: 0.25rem;
        }

        .card-body {
            font-size: 0.90rem;
            line-height: 1.5;
        }
        
        .card-body p {
            margin: 0 0 0.75rem 0;
        }

        .card-body strong {
            color: #005a8d;
            font-weight: bold;
        }
        
        .story, .quote {
            font-style: italic;
            background-color: rgba(44, 62, 80, 0.1);
            padding: 0.5rem;
            border-radius: 8px;
            border-left: 3px solid #00aaff;
        }
        
        .quote {
            margin-top: 1rem;
            border-left-color: #d35400;
            font-weight: bold;
        }
        
        #toggle-game-button {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1001; /* Above the game overlay */
            background-color: #00aaff;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Search input and button container -->
    <div id="search-container">
        <input id="zip-input" type="text" placeholder="Enter ZIP code prefix (e.g., 55)">
        <button id="current-location-button" class="control-button">Show Current Location</button>
        <button id="gps-timer-button" class="control-button">Start GPS Timer</button>
        <div id="timer-display"></div>
    </div>
    <button id="toggle-game-button">Show Game</button>
    <!-- Map container -->
    <div id="map">
        <p>Attempting to locate you...</p>
    </div>
    <!-- Game Overlay -->
    <div id="game-overlay" class="hidden">
        <div id="game-content">
            <h1>A Legacy in Metal</h1>
            <p id="instructions">A tarot reading forged from a history of steel, engineering, and innovation. This spread explores the forces of Past, Present, and Future through the lens of your family's legacy. Click "Draw Cards" to begin, then click each card to reveal its meaning.</p>
            <div id="controls">
                <button id="draw-button" class="game-button">Draw Cards</button>
                <button id="reset-button" class="game-button">Reset</button>
            </div>
            <div id="table">
                <div id="card-slots">
                    <!-- Card slots will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    <!-- Leaflet JavaScript: The core mapping library -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <!-- Esri Leaflet JavaScript: Plugin for satellite basemaps -->
    <script src="https://unpkg.com/esri-leaflet@3.0.10/dist/esri-leaflet.js"></script>
    <!-- Main application logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mapContainer = document.getElementById('map');
            const zipInput = document.getElementById('zip-input');
            const currentLocationButton = document.getElementById('current-location-button');
            const gpsTimerButton = document.getElementById('gps-timer-button');
            const timerDisplay = document.getElementById('timer-display');
            const toggleGameButton = document.getElementById('toggle-game-button');
            const gameOverlay = document.getElementById('game-overlay');

            let map, userMarker, searchTimeout, timerInterval;
            let timerRunning = false;

            // This function creates and returns a new map instance.
            function initializeMap(lat, lng, zoomLevel = 10) {
                // Remove the initial "locating..." message
                mapContainer.innerHTML = "";
                // Create the map instance and set the view
                const newMap = L.map('map').setView([lat, lng], zoomLevel);
                // Add the satellite and label layers
                L.esri.basemapLayer('Imagery').addTo(newMap);
                L.esri.basemapLayer('ImageryLabels').addTo(newMap);
                return newMap;
            }

            // Always initialize the map first with a default view (center of the US)
            map = initializeMap(39.8283, -98.5795);

            // Geolocation handling
            function locateUser(zoomLevel) {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => onSuccess(position, zoomLevel), 
                        onError, {
                            enableHighAccuracy: true,
                            timeout: 10000,
                            maximumAge: 0
                        }
                    );
                } else {
                    L.popup()
                        .setLatLng(map.getCenter())
                        .setContent('<p>Sorry, Geolocation is not supported by your browser.</p>')
                        .openOn(map);
                }
            }

            function onSuccess(position, zoomLevel) {
                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;
                // Store the coordinates for the timer functionality
                const locationData = { latitude, longitude };
                localStorage.setItem('lastLocation', JSON.stringify(locationData));

                // Clear any previous markers
                if (userMarker) {
                    map.removeLayer(userMarker);
                }

                map.setView([latitude, longitude], zoomLevel);
                userMarker = L.marker([latitude, longitude]).addTo(map);
                userMarker.bindPopup(`<b>You are here!</b><br>Your approximate location.<br>Lat: ${latitude.toFixed(4)}, Lng: ${longitude.toFixed(4)}`).openPopup();
            }

            function onError(err) {
                let errorMessage = 'An unknown error occurred.';
                switch (err.code) {
                    case err.PERMISSION_DENIED:
                        errorMessage = 'Location access denied. Please enable it or use ZIP code search.';
                        break;
                    case err.POSITION_UNAVAILABLE:
                        errorMessage = 'Location information is unavailable.';
                        break;
                    case err.TIMEOUT:
                        errorMessage = 'Location request timed out.';
                        break;
                }
                // Display the error message in a temporary popup
                L.popup()
                    .setLatLng(map.getCenter())
                    .setContent(`<p><strong>Error:</strong> ${errorMessage}</p>`)
                    .openOn(map);
            }

            // ZIP code search functionality with Nominatim API
            zipInput.addEventListener('input', () => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    const query = zipInput.value.trim();
                    if (userMarker) {
                        map.removeLayer(userMarker);
                        userMarker = null;
                    }
                    if (query.length >= 2) {
                        // Use Nominatim API with country and postal code focus
                        const url = `https://nominatim.openstreetmap.org/search?postalcode=${query}&countrycodes=us&format=json&limit=1`;
                        fetch(url)
                            .then(response => response.json())
                            .then(data => {
                                if (data && data.length > 0) {
                                    const result = data[0];
                                    const lat = parseFloat(result.lat);
                                    const lng = parseFloat(result.lon);
                                    map.setView([lat, lng], 12);
                                    userMarker = L.marker([lat, lng]).addTo(map);
                                    userMarker.bindPopup(`<b>Search Result:</b><br>${result.display_name}`).openPopup();
                                    const locationData = { latitude: lat, longitude: lng, isZip: true };
                                    localStorage.setItem('lastLocation', JSON.stringify(locationData));
                                } else {
                                    L.popup()
                                        .setLatLng(map.getCenter())
                                        .setContent(`<p><strong>Error:</strong> No location found for that query. Try a more specific one.</p>`)
                                        .openOn(map);
                                }
                            })
                            .catch(error => {
                                console.error("Geocoding error:", error);
                                L.popup()
                                    .setLatLng(map.getCenter())
                                    .setContent(`<p><strong>Error:</strong> An error occurred while searching.</p>`)
                                    .openOn(map);
                            });
                    }
                }, 300);
            });

            // "Show Current Location" button click handler
            currentLocationButton.addEventListener('click', () => {
                locateUser(16); // Set a higher zoom level for user location
            });

            // "Start GPS Timer" button click handler
            gpsTimerButton.addEventListener('click', () => {
                if (!timerRunning) {
                    startTimer();
                } else {
                    stopTimer();
                }
            });
            
            function startTimer() {
                timerRunning = true;
                gpsTimerButton.textContent = 'Stop GPS Timer';
                updateTimerDisplay(10);
                timerInterval = setInterval(() => {
                    let timeLeft = parseInt(timerDisplay.textContent.split('|')[1].trim(), 10);
                    if (timeLeft > 0) {
                        updateTimerDisplay(timeLeft - 1);
                    } else {
                        locateUser(16);
                        updateTimerDisplay(10);
                    }
                }, 1000);
            }
            
            function stopTimer() {
                timerRunning = false;
                gpsTimerButton.textContent = 'Start GPS Timer';
                clearInterval(timerInterval);
                timerDisplay.textContent = '';
            }

            function updateTimerDisplay(seconds) {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const sec = String(now.getSeconds()).padStart(2, '0');
                timerDisplay.textContent = `${hours}:${minutes}:${sec} | ${seconds}s`;
            }

            // Initial location request on page load
            locateUser(10);

            // --- Wacker Tarot Game Logic ---
            const tarot_data = [
                // Major Arcana
                {"name":"The Black Forest Anvil","card":"0 - The Fool","classifier":"Major Arcana","theme":"German Heritage","emojis":"ðŸŒ², ðŸ”¨","story":"The journey begins with a leap of faith from the old world to the new. It represents the ancestral spirit from the Black Forest, a heritage of metalworking and strength, stepping into the unknown future of America with raw potential and foundational skill.","quote":"From the old forest, a new path is forged."},
                {"name":"Robotic Welding Arm","card":"I - The Magician","classifier":"Major Arcana","theme":"Automation & G-Code","emojis":"ðŸ¤–, âœ¨","story":"The modern master of creation. With the tools of G-code, CNC, and automation, the robotic arm manifests precise parts from raw metal. It represents the power to take a concept and, through skill and technology, make it a reality.","quote":"As above, so below. As in the code, so in the steel."},
                {"name":"The Die Maker's Knowledge","card":"II - The High Priestess","classifier":"Major Arcana","theme":"Intuitive Engineering","emojis":"ðŸ¤«, ðŸ“","story":"The die maker holds the secret knowledge. Their understanding of metal's stress, flow, and memory is intuitive, a deep wisdom that cannot be fully captured in blueprints. This card represents the hidden knowledge and gut feeling essential to true mastery.","quote":"The steel speaks to those who know how to listen."},
                {"name":"Mercury Marine Engines","card":"III - The Empress","classifier":"Major Arcana","theme":"Creation & Nurturing Power","emojis":"ðŸš¤, ðŸŒŠ","story":"The creation of powerful marine engines represents nurturing abundance. These engines, born from stamped metal parts, give life to vessels, enabling exploration and commerce. It is the material manifestation of creative energy, birthing power and motion.","quote":"From the factory's heart, power flows to the water."},
                {"name":"The Wacker Legacy","card":"IV - The Emperor","classifier":"Major Arcana","theme":"Family & Industry","emojis":"ðŸ¢, ðŸ‘‘","story":"The family name itself, a structure of authority and influence in steel manufacturing and civic design (Charles Wacker in Chicago). This card embodies leadership, stability, and the establishment of a lasting industrial dynasty built on solid principles.","quote":"A foundation of steel, a legacy of stone."},
                {"name":"The University of Engineering","card":"V - The Hierophant","classifier":"Major Arcana","theme":"Formal Knowledge","emojis":"ðŸŽ“, ðŸ“š","story":"This represents the tradition and institutions of engineering. It is the formal education, the established principles of physics, metallurgy, and mathematics that are passed down, forming the bedrock upon which innovation is built.","quote":"Learning the rules to know how to break them."},
                {"name":"Magnetic Attraction","card":"VI - The Lovers","classifier":"Major Arcana","theme":"Hidden Forces & Duality","emojis":"ðŸ§², â¤ï¸","story":"The mysterious pull of a magnet on a coin. This represents a fundamental choice and a powerful, unseen connection. It is the duality of technology and nature, the iPhone's magnet and the coin's metal, drawn together in a perfect, surprising alignment.","quote":"Two separate bodies, one undeniable force."},
                {"name":"Caterpillar Assembly Line","card":"VII - The Chariot","classifier":"Major Arcana","theme":"Massive Production","emojis":"ðŸšœ, âž¡ï¸","story":"The unstoppable force of the assembly line. By harnessing immense power and directing it with focused will, countless parts are brought together to create mighty machines. It is the victory of process and determination, moving ever forward.","quote":"Willpower and horsepower, driving progress forward."},
                {"name":"The Two-Handed Sword","card":"VIII - Strength","classifier":"Major Arcana","theme":"Ancestral Power","emojis":"âš”ï¸, ðŸ»","story":"The ancestral strength required to hunt bears and wolves with a two-handed sword in the Black Forest. This is not brute force, but the inner courage, resilience, and mastery over one's own fear and power, passed down through generations.","quote":"True strength is not in the weapon, but in the hands that wield it."},
                {"name":"Deep Water Well Drill","card":"IX - The Hermit","classifier":"Major Arcana","theme":"Singular Invention","emojis":"ðŸ’§, ðŸ’¡","story":"Your father's invention, born of solitary focus and inner wisdom. It represents withdrawing from the conventional to find a deeper truth, drilling past the surface to bring forth life-giving water for those in need. A light of innovation in the darkness.","quote":"To find what is needed, one must look where no one else has."},
                {"name":"The Global Economy","card":"X - Wheel of Fortune","classifier":"Major Arcana","theme":"GDP & Currencies","emojis":"ðŸŒ,  à¤šà¤•à¥à¤°","story":"The ever-turning wheel of global economies and the shifting values of currencies. From the US Dollar to the Japanese Yen, fortunes rise and fall. This card represents the cycles of commerce, destiny, and the macroeconomic forces beyond any single person's control.","quote":"Empires rise, markets fall, the wheel turns for all."},
                {"name":"The Engineering Blueprint","card":"XI - Justice","classifier":"Major Arcana","theme":"Precision & Consequence","emojis":"âš–ï¸, ðŸ“","story":"A blueprint is a contract with reality. Every measurement has a consequence; every tolerance must be respected. This card represents the clear, impartial laws of physics and engineering, where cause and effect are absolute and precision is paramount.","quote":"Measure twice, cut once. The laws of physics are not negotiable."},
                {"name":"Superconductivity","card":"XII - The Hanged Man","classifier":"Major Arcana","theme":"Quantum Perspective","emojis":"â„ï¸, âš›ï¸","story":"A superconductor, by suspending all electrical resistance, offers a new perspective on energy and matter. It represents a willing sacrifice of heat to gain extraordinary ability, a state of suspension that reveals a profound, hidden reality.","quote":"Let go of resistance to achieve perfect flow."},
                {"name":"The Stamping Press Strike","card":"XIII - Death","classifier":"Major Arcana","theme":"Transformation","emojis":"ðŸ’¥, â™»ï¸","story":"The powerful, final strike of a stamping die. It is a moment of irreversible transformation, ending the sheet metal's old form to create something new. This represents the necessary end of one state to allow for the beginning of another.","quote":"What was once whole is now redefined."},
                {"name":"The Chemical Formula","card":"XIV - Temperance","classifier":"Major Arcana","theme":"Metallurgy & Alloys","emojis":"ðŸ§ª, ðŸ”¥","story":"The alchemical process of creating steel alloys. By perfectly blending iron, carbon, and other elements, a new substance with superior qualities is born. This is the card of synthesis, balance, and combining different elements to create a stronger whole.","quote":"The right mix changes everything."},
                {"name":"Planned Obsolescence","card":"XV - The Devil","classifier":"Major Arcana","theme":"Material Traps","emojis":"â›“ï¸, ðŸ“±","story":"The shadow side of manufacturing and technology. The addiction to the new, the chains of consumerism, and the materialist trap of designing products to fail. It represents the powerful allure of technology that can sometimes bind us.","quote":"What you own can end up owning you."},
                {"name":"Catastrophic Failure","card":"XVI - The Tower","classifier":"Major Arcana","theme":"Stress & Breaking Point","emojis":"âš¡, ðŸ—¼","story":"When a part fails under stress, the entire structure can collapse. This represents a sudden, shocking revelation of a hidden flaw. The old structures of assumption are shattered by the undeniable truth of material limits, forcing a complete rebuild.","quote":"A chain is only as strong as its weakest link."},
                {"name":"The Jetson Nano AI","card":"XVII - The Star","classifier":"Major Arcana","theme":"Inspiration & Hope","emojis":"âœ¨, ðŸ§ ","story":"The NVIDIA Jetson Nano, a small device that brings the vast potential of AI into your hands. It is a source of hope and inspiration, a guiding light for future innovations in robotics and automation, promising a connection to a universe of data.","quote":"A universe of possibility in a circuit board."},
                {"name":"The Unseen Magnetic Field","card":"XVIII - The Moon","classifier":"Major Arcana","theme":"Illusion & Hidden Forces","emojis":"ðŸŒ™, ðŸ§²","story":"The invisible magnetic field that permeates space around a magnet. It represents the world of illusion, dreams, and unseen forces. We can see its effects, but not the field itself, navigating by intuition and wrestling with fears of the unknown.","quote":"Not everything that is real can be seen."},
                {"name":"The Finished Corvette Engine","card":"XIX - The Sun","classifier":"Major Arcana","theme":"Triumph & Success","emojis":"â˜€ï¸, ðŸŽï¸","story":"The final, assembled engine, gleaming and powerful. It is the culmination of all the parts, processes, and hard work. This card represents success, vitality, and the pure joy of seeing a complex project come to brilliant, powerful life.","quote":"The brilliant result of a thousand small successes."},
                {"name":"The Patent","card":"XX - Judgment","classifier":"Major Arcana","theme":"Legacy & Recognition","emojis":"ðŸ“œ, ðŸ“£","story":"A patent represents a final judgment and a resurrection of an idea into a protected, recognized form. It is a calling to account for one's innovation, leading to absolution and a permanent place in the annals of invention.","quote":"An idea, judged worthy of eternity."},
                {"name":"The Integrated System","card":"XXI - The World","classifier":"Major Arcana","theme":"Completion & Synthesis","emojis":"ðŸŒ, âš™ï¸","story":"The successful integration of all systems: mechanical, electrical, software, and human. From the global supply chain to the finished robot, the cycle is complete. It represents wholeness, accomplishment, and the mastery of one's world.","quote":"Every part in its place, the whole greater than the sum."},
                // Pentacles (The Material World: Coins, Metals, Products)
                {"name":"A Ferromagnetic Coin","card":"Ace of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Tangible Discovery","emojis":"ðŸª™, ðŸ§²","story":"The moment a coin unexpectedly sticks to your phone. A new, tangible opportunity for inquiry and understanding presents itself. It's the seed of a new project, grounded in the physical properties of the world.","quote":"A small discovery can lead to a great enterprise."},
                {"name":"Juggling Currencies","card":"Two of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"International Business","emojis":"ðŸ’´, ðŸ’·","story":"Managing resources across different countries and currencies, like the Scottish Pound and Japanese Yen. It's a constant balancing act, adapting to the fluctuations of the material world with skill and flexibility.","quote":"Adaptability is the currency of success."},
                {"name":"Chevrolet Corvette Parts","card":"Three of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Collaborative Craftsmanship","emojis":"ðŸŽï¸, ðŸ¤","story":"The teamwork required to produce high-quality engine parts for a world-class customer like Chevrolet. It represents the mastery of a craft and the collaboration needed to achieve a shared material goal.","quote":"Excellence is a team sport."},
                {"name":"The Bank Vault","card":"Four of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Asset Hoarding","emojis":"ðŸ”’, ðŸ’°","story":"Controlling resources and holding onto wealth and assets. This card represents the stability that comes from material security, but also the danger of becoming too possessive or resistant to change.","quote":"Security is important, but growth requires investment."},
                {"name":"Supply Chain Disruption","card":"Five of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Material Hardship","emojis":"ðŸ“‰, ðŸ“¦","story":"A break in the supply chain, a lack of raw materials. This represents a period of material hardship and feeling left out in the cold, highlighting a vulnerability in the physical process of creation.","quote":"A missing part can halt the entire line."},
                {"name": "The Consultant's Fee", "card": "Six of Pentacles", "classifier": "Pentacles - Earth - Physical", "theme": "Sharing Expertise", "emojis": "ðŸŽ, ðŸ’¡", "story": "Being paid for your expertise or paying for a specialist's knowledge. It represents a flow of resources, where one person's abundance of knowledge is given to another, creating a cycle of prosperity.", "quote": "Knowledge shared is knowledge squared." },
                {"name":"A Long-Term Investment","card":"Seven of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Patient Growth","emojis":"â³, ðŸŒ±","story":"Investing in new machinery or a long R&D project. It requires patience and a period of waiting, assessing the progress of the investment before it yields its full material return.","quote":"The seeds of today's work are tomorrow's harvest."},
                {"name":"Kitamura CNC Machining","card":"Eight of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Diligent Work","emojis":"âš™ï¸, ðŸ‘¨â€ðŸ”§","story":"The repetitive, diligent work of a CNC machine, perfecting one part after another. It represents apprenticeship, dedication to a craft, and the pursuit of mastery through focused, continuous effort.","quote":"Quality is the result of a thousand perfect repetitions."},
                {"name":"The Finished Product","card":"Nine of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Self-Sufficiency","emojis":"ðŸ†, âœ…","story":"A finished, high-quality product, ready for market. It represents the culmination of hard work, resulting in material independence, discipline, and the satisfaction of a job well done.","quote":"Confidence in the quality of one's own work."},
                {"name":"Wacker Steel Manufacturing Co.","card":"Ten of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Enduring Legacy","emojis":"ðŸ­, ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦","story":"The family business as a lasting material legacy. It represents the wealth, infrastructure, and reputation passed down through generations, providing a stable foundation for the future.","quote":"A legacy forged not just in steel, but in family."},
                {"name":"The Intern","card":"Page of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Eager Student","emojis":"ðŸ§‘â€ðŸŽ“, ðŸ”¬","story":"A young engineer, eager to learn the tangible skills of the trade. They are a student of the material world, focused on a new opportunity to manifest their ideas into physical reality.","quote":"An open mind is the first tool to pick up."},
                {"name":"The Quality Control Inspector","card":"Knight of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Methodical Progress","emojis":"ðŸ§, ðŸ“‹","story":"The inspector who works diligently, methodically, and reliably to ensure every part meets the standard. They are not fast, but their steady, dependable work is the bedrock of quality.","quote":"Slow and steady wins the race to perfection."},
                {"name":"The Plant Manager","card":"Queen of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Nurturing Resources","emojis":"ðŸ‘‘, ðŸ“ˆ","story":"The manager who nurtures the resources of the factoryâ€”the people, the materials, the financesâ€”to create a productive and stable environment. They are practical, resourceful, and focused on tangible results.","quote":"A well-run plant is a garden of productivity."},
                {"name":"The CEO","card":"King of Pentacles","classifier":"Pentacles - Earth - Physical","theme":"Master of Industry","emojis":"ðŸ‘‘, ðŸ’¼","story":"The master of the industrial empire. They are a master of the material world, using their wealth and experience to build, acquire, and provide security. Their success is tangible and their influence is far-reaching.","quote":"The true measure of a king is the prosperity of his domain."},
                // Swords (The Mind: Logic, G-Code, Challenges)
                {"name":"The Design Insight","card":"Ace of Swords","classifier":"Swords - Air - Reason","theme":"Breakthrough Idea","emojis":"ðŸ’¡, ðŸ—¡ï¸","story":"A moment of pure intellectual breakthrough. The core idea for a new design or a solution to a complex engineering problem. It cuts through the confusion with sharp, undeniable clarity.","quote":"Clarity. The sharpest tool."},
                {"name":"The Trade-Off","card":"Two of Swords","classifier":"Swords - Air - Reason","theme":"Difficult Decision","emojis":"âš–ï¸, ðŸ¤”","story":"Choosing between two design paths: cost vs. performance, speed vs. durability. It's a stalemate of the mind, where a difficult decision is being blocked, waiting for more data or a leap of faith.","quote":"Every design is a compromise."},
                {"name":"The Rejection Notice","card":"Three of Swords","classifier":"Swords - Air - Reason","theme":"Painful Truth","emojis":"ðŸ’”, ðŸ“„","story":"A design being rejected by a client, or a critical flaw discovered late in the process. It's a painful, piercing truth that brings sorrow but also the necessary clarity to move forward.","quote":"Failure is a painful but effective teacher."},
                {"name":"System Shutdown & Reboot","card":"Four of Swords","classifier":"Swords - Air - Reason","theme":"Mental Rest","emojis":"ðŸ”Œ, ðŸ§˜","story":"A period of mental rest and recovery after a challenging project. It's a strategic retreat to contemplate, analyze data, and prepare the mind for the next intellectual battle.","quote":"Sometimes the best solution is to turn it off and on again."},
                {"name":"A Hostile Takeover","card":"Five of Swords","classifier":"Swords - Air - Reason","theme":"Conflict & Ambition","emojis":"ðŸ˜’, âš”ï¸","story":"A conflict where winning comes at a great cost. A business strategy that alienates partners or a debate won through aggression. It's a hollow victory, where the cost of winning was too high.","quote":"Not all victories are worth the battle."},
                {"name":"Moving to a New Platform","card":"Six of Swords","classifier":"Swords - Air - Reason","theme":"Logical Transition","emojis":"ðŸ’», âž¡ï¸","story":"Transitioning from an old software or hardware platform to a new one. It's a sorrowful but necessary journey away from a difficult past, moving toward a more logical and efficient future.","quote":"Leaving the legacy system behind."},
                {"name":"Reverse Engineering","card":"Seven of Swords","classifier":"Swords - Air - Reason","theme":"Strategy & Deception","emojis":"ðŸ¤«, âš™ï¸","story":"Deconstructing a competitor's product to understand its secrets. It's an act of strategy and cunning, using one's intellect to gain an advantage, often operating alone and in secret.","quote":"To build a better one, first understand theirs."},
                {"name":"Proprietary Software","card":"Eight of Swords","classifier":"Swords - Air - Reason","theme":"Limiting Beliefs","emojis":"â›“ï¸, ðŸ’¾","story":"Being trapped by a proprietary system or a limiting belief about what's possible. It's a self-imposed prison of the mind, where the perceived lack of options is the true barrier.","quote":"The walls are in your mind, not in the code."},
                {"name":"Pre-Launch Anxiety","card":"Nine of Swords","classifier":"Swords - Air - Reason","theme":"Mental Anguish","emojis":"ðŸ˜°, â°","story":"The dark nights of anxiety and worry before a major product launch. The mind races with everything that could go wrong. It's the mental anguish born from high stakes and the fear of failure.","quote":"The thousand little worries that haunt the eve of creation."},
                {"name":"The Critical Bug","card":"Ten of Swords","classifier":"Swords - Air - Reason","theme":"Final Failure","emojis":"ðŸ’€, ðŸ›","story":"The discovery of a fatal flaw just before shipping, leading to project ruin. It's the painful, sudden end of a line of thought, a complete failure that requires starting over from scratch.","quote":"Game over. Insert coin to try again."},
                {"name":"The Tech Blogger","card":"Page of Swords","classifier":"Swords - Air - Reason","theme":"Curiosity & a Sharp Tongue","emojis":"ï¸, âœï¸","story":"Someone new to the scene, full of questions, ideas, and a desire to communicate. They are curious and energetic, wielding words and ideas like a sword to test the world around them.","quote":"'But why?' is the most powerful question."},
                {"name":"The Troubleshooter","card":"Knight of Swords","classifier":"Swords - Air - Reason","theme":"Decisive Action","emojis":"ðŸƒ, âš¡","story":"The engineer who dives headfirst into a crisis, acting with swift, decisive, and focused ambition. They cut through the noise to solve the problem, driven by logic and a need for resolution.","quote":"Analyze, act, resolve. Next problem."},
                {"name":"The Veteran Engineer","card":"Queen of Swords","classifier":"Swords - Air - Reason","theme":"Incisive Wisdom","emojis":"ðŸ‘‘, ðŸ‘“","story":"An experienced engineer who has seen it all. They cut through nonsense with incisive questions and unbiased judgment, communicating complex truths with clarity and authority.","quote":"Experience is recognizing a pattern you've seen before."},
                {"name":"The Patent Attorney","card":"King of Swords","classifier":"Swords - Air - Reason","theme":"Intellectual Authority","emojis":"ðŸ‘‘, âš–ï¸","story":"A master of intellectual property law. They wield the power of logic, rules, and language with absolute authority. Their judgment is final, and their truth is codified in law.","quote":"It is not only what you invent, but what you can defend."},
                // Wands (Passion: Robotics, Innovation, Energy)
                {"name":"The Spark of an Idea","card":"Ace of Wands","classifier":"Wands - Fire - Creativity","theme":"New Inspiration","emojis":"ðŸ’¡, ðŸ”¥","story":"The initial, raw spark of inspiration for a new robot or invention. It's a burst of pure creative energy, a call to action, and the passionate start of a new venture.","quote":"Let there be light... and a motor."},
                {"name":"The Initial Prototype","card":"Two of Wands","classifier":"Wands - Fire - Creativity","theme":"Planning & Potential","emojis":"ðŸ—ºï¸, ðŸ¤–","story":"The first prototype is built. You hold your creation in your hands, contemplating its future potential. It's a moment of bold planning, choosing a path for your passion project.","quote":"The first step from thought to thing."},
                {"name":"Presenting at a Tech Conference","card":"Three of Wands","classifier":"Wands - Fire - Creativity","theme":"Anticipating the Future","emojis":"ðŸš¢, ðŸ”­","story":"Showcasing your work to the world, anticipating the partnerships and opportunities that will come. You are looking to the horizon, waiting for your creative ship to come in.","quote":"Putting your vision out into the world."},
                {"name":"The First Successful Test","card":"Four of Wands","classifier":"Wands - Fire - Creativity","theme":"Celebration & Harmony","emojis":"ðŸŽ‰, âœ…","story":"The moment a project works for the first time. It's a time of celebration, community, and harmony, the joyous establishment of a stable foundation for future development.","quote":"It works! It actually works!"},
                {"name":"Competing Standards","card":"Five of Wands","classifier":"Wands - Fire - Creativity","theme":"Creative Friction","emojis":"ðŸ˜–, ðŸ”Œ","story":"The chaos of competing technologies and standards (e.g., Apple vs. Android). It represents the creative clashes and minor struggles that arise when different passionate ideas compete for dominance.","quote":"The beautiful chaos of innovation."},
                {"name":"A Favorable Review","card":"Six of Wands","classifier":"Wands - Fire - Creativity","theme":"Public Recognition","emojis":"ðŸ†, â­","story":"Receiving public recognition for your work. It's a moment of victory, where your passion and vision are celebrated, boosting your confidence and inspiring you to continue.","quote":"Your work has been noticed."},
                {"name":"Defending Your Design","card":"Seven of Wands","classifier":"Wands - Fire - Creativity","theme":"Standing Your Ground","emojis":"ðŸ›¡ï¸, ðŸ—£ï¸","story":"Defending your innovative design choices against skeptics and critics. You are standing your ground, fighting for your creative principles with courage and conviction.","quote":"This is my vision, and I stand by it."},
                {"name":"Open-Source Code Commit","card":"Eight of Wands","classifier":"Wands - Fire - Creativity","theme":"Rapid Communication","emojis":"ðŸš€, ðŸ’¾","story":"Pushing code to a global repository. It's a message of rapid, energetic progress, collaborating with a community and moving a project forward at high speed.","quote":"Code pushed, world updated."},
                {"name":"Project Burnout","card":"Nine of Wands","classifier":"Wands - Fire - Creativity","theme":"Resilience","emojis":"ðŸ¤•, ðŸ”‹","story":"Feeling weary and battered after a long, difficult project, but not defeated. You gather your last reserves of energy and resilience for one final push.","quote":"Wounded, but not beaten. The final push remains."},
                {"name":"The Burden of Maintenance","card":"Ten of Wands","classifier":"Wands - Fire - Creativity","theme":"Responsibility","emojis":"ðŸ˜«, ðŸ“š","story":"Being burdened with the responsibility of maintaining a successful but demanding project. The passion that started it has become a heavy weight of obligation.","quote":"The creator is forever bound to their creation."},
                {"name":"The Hobbyist Roboticist","card":"Page of Wands","classifier":"Wands - Fire - Creativity","theme":"Exploration","emojis":"ðŸ¤©, ðŸ¤–","story":"Exploring a new passion for robotics, full of energy and excitement. You're ready to start a new adventure, eager to learn and experiment without fear of failure.","quote":"What does this button do?"},
                {"name":"The Entrepreneur","card":"Knight of Wands","classifier":"Wands - Fire - Creativity","theme":"Passionate Pursuit","emojis":"ðŸ§—, ðŸ”¥","story":"The entrepreneur who passionately and impulsively pursues a new venture. They are charming, energetic, and charge ahead, driven by a fiery vision that can be both inspiring and reckless.","quote":"Move fast and build things."},
                {"name":"The Project Lead","card":"Queen of Wands","classifier":"Wands - Fire - Creativity","theme":"Confident Leadership","emojis":"ðŸ‘‘, ðŸ‘©â€ðŸš€","story":"The confident and determined leader of a creative project. They inspire their team with vibrant energy, courage, and an unwavering belief in their shared vision.","quote":"Let's make this happen."},
                {"name":"The Visionary Inventor","card":"King of Wands","classifier":"Wands - Fire - Creativity","theme":"Creative Vision","emojis":"ðŸ‘‘, ðŸ’¡","story":"The master inventor who has a long-term vision and the charisma to lead others towards it. They don't just have ideas; they build entire ecosystems around their creative fire.","quote":"It's not just about one invention; it's about the future we can build."}
            ];

            // --- Game DOM Elements ---
            const drawButton = document.getElementById('draw-button');
            const resetButton = document.getElementById('reset-button');
            const cardSlotsContainer = document.getElementById('card-slots');
            
            let drawnCards = [];

            // --- Game Functions ---
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            function createCardElement(cardData, position) {
                const card = document.createElement('div');
                card.className = 'card';
                
                card.innerHTML = `
                    <div class="card-face card-back">
                        <div class="card-back-design">
                            <span>W</span>
                        </div>
                    </div>
                    <div class="card-face card-front">
                        <div class="card-header">
                            <h2>${cardData.name} ${cardData.emojis}</h2>
                            <p class="tarot-title">${cardData.card}</p>
                        </div>
                        <div class="card-body">
                            <p><strong>Position:</strong> ${position}</p>
                            <p><strong>Theme:</strong> <em>${cardData.theme}</em></p>
                            <p class="story"><strong>Story:</strong> ${cardData.story}</p>
                            <p class="quote"><strong>Quote:</strong> "${cardData.quote}"</p>
                        </div>
                    </div>
                `;
                
                card.addEventListener('click', () => {
                    card.classList.toggle('is-flipped');
                });

                return card;
            }

            function drawReading() {
                if (drawnCards.length > 0) return;
                shuffle(tarot_data);
                drawnCards = tarot_data.slice(0, 3);
                const positions = ['The Past', 'The Present', 'The Future'];
                cardSlotsContainer.innerHTML = '';
                drawnCards.forEach((card, index) => {
                    const slot = document.createElement('div');
                    slot.className = 'card-slot';
                    const cardElement = createCardElement(card, positions[index]);
                    slot.appendChild(cardElement);
                    cardSlotsContainer.appendChild(slot);
                });
            }
            
            function resetReading() {
                drawnCards = [];
                cardSlotsContainer.innerHTML = '';
                setupPlaceholders();
            }
            
            function setupPlaceholders() {
                const positions = ['The Past', 'The Present', 'The Future'];
                cardSlotsContainer.innerHTML = '';
                for (let i = 0; i < 3; i++) {
                    const placeholder = document.createElement('div');
                    placeholder.className = 'card-slot';
                    placeholder.innerHTML = `
                        <div class="placeholder">
                            <span>${positions[i]}</span>
                        </div>
                    `;
                    cardSlotsContainer.appendChild(placeholder);
                }
            }

            // --- Game Event Listeners ---
            drawButton.addEventListener('click', drawReading);
            resetButton.addEventListener('click', resetReading);
            
            toggleGameButton.addEventListener('click', () => {
                gameOverlay.classList.toggle('hidden');
                toggleGameButton.textContent = gameOverlay.classList.contains('hidden') ? 'Show Game' : 'Hide Game';
            });

            // Initial setup for the game
            setupPlaceholders();
        });
    </script>
</body>
</html>
